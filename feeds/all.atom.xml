<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom"><title>On the shoulders of giants</title><link href="https://diegoquintanav.github.io/" rel="alternate"></link><link href="https://diegoquintanav.github.io/feeds/all.atom.xml" rel="self"></link><id>https://diegoquintanav.github.io/</id><updated>2018-12-14T09:03:00-06:00</updated><entry><title>Using psycopg2 for your postgres needs</title><link href="https://diegoquintanav.github.io/dq-de-mission-01-EN.html" rel="alternate"></link><published>2018-12-03T23:00:00+01:00</published><updated>2018-12-03T23:00:00+01:00</updated><author><name>Diego Quintana</name></author><id>tag:diegoquintanav.github.io,2018-12-03:dq-de-mission-01-EN.html</id><summary type="html">&lt;style type="text/css"&gt;/*!
*
* IPython notebook
*
*/
/* CSS font colors for translated ANSI escape sequences */
/* The color values are a mix of
   http://www.xcolors.net/dl/baskerville-ivorylight and
   http://www.xcolors.net/dl/euphrasia */
.ansi-black-fg {
  color: #3E424D;
}
.ansi-black-bg {
  background-color: #3E424D;
}
.ansi-black-intense-fg {
  color: #282C36;
}
.ansi-black-intense-bg {
  background-color: #282C36;
}
.ansi-red-fg {
  color: #E75C58;
}
.ansi-red-bg {
  background-color: #E75C58;
}
.ansi-red-intense-fg {
  color: #B22B31;
}
.ansi-red-intense-bg {
  background-color: #B22B31;
}
.ansi-green-fg {
  color: #00A250;
}
.ansi-green-bg {
  background-color: #00A250;
}
.ansi-green-intense-fg {
  color: #007427;
}
.ansi-green-intense-bg {
  background-color: #007427;
}
.ansi-yellow-fg {
  color: #DDB62B;
}
.ansi-yellow-bg {
  background-color: #DDB62B;
}
.ansi-yellow-intense-fg {
  color: #B27D12;
}
.ansi-yellow-intense-bg {
  background-color: #B27D12;
}
.ansi-blue-fg {
  color: #208FFB;
}
.ansi-blue-bg {
  background-color: #208FFB;
}
.ansi-blue-intense-fg {
  color: #0065CA;
}
.ansi-blue-intense-bg {
  background-color: #0065CA;
}
.ansi-magenta-fg {
  color: #D160C4;
}
.ansi-magenta-bg {
  background-color: #D160C4;
}
.ansi-magenta-intense-fg {
  color: #A03196;
}
.ansi-magenta-intense-bg {
  background-color: #A03196;
}
.ansi-cyan-fg {
  color: #60C6C8;
}
.ansi-cyan-bg {
  background-color: #60C6C8;
}
.ansi-cyan-intense-fg {
  color: #258F8F;
}
.ansi-cyan-intense-bg {
  background-color: #258F8F;
}
.ansi-white-fg {
  color: #C5C1B4;
}
.ansi-white-bg {
  background-color: #C5C1B4;
}
.ansi-white-intense-fg {
  color: #A1A6B2;
}
.ansi-white-intense-bg {
  background-color: #A1A6B2;
}
.ansi-default-inverse-fg {
  color: #FFFFFF;
}
.ansi-default-inverse-bg {
  background-color: #000000;
}
.ansi-bold {
  font-weight: bold;
}
.ansi-underline {
  text-decoration: underline;
}
/* The following styles are deprecated an will be removed in a future version */
.ansibold {
  font-weight: bold;
}
.ansi-inverse {
  outline: 0.5px dotted;
}
/* use dark versions for foreground, to improve visibility */
.ansiblack {
  color: black;
}
.ansired {
  color: darkred;
}
.ansigreen {
  color: darkgreen;
}
.ansiyellow {
  color: #c4a000;
}
.ansiblue {
  color: darkblue;
}
.ansipurple {
  color: darkviolet;
}
.ansicyan {
  color: steelblue;
}
.ansigray {
  color: gray;
}
/* and light for background, for the same reason */
.ansibgblack {
  background-color: black;
}
.ansibgred {
  background-color: red;
}
.ansibggreen {
  background-color: green;
}
.ansibgyellow {
  background-color: yellow;
}
.ansibgblue {
  background-color: blue;
}
.ansibgpurple {
  background-color: magenta;
}
.ansibgcyan {
  background-color: cyan;
}
.ansibggray {
  background-color: gray;
}
div.cell {
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
  border-radius: 2px;
  box-sizing: border-box;
  -moz-box-sizing: border-box;
  -webkit-box-sizing: border-box;
  border-width: 1px;
  border-style: solid;
  border-color: transparent;
  width: 100%;
  padding: 5px;
  /* This acts as a spacer between cells, that is outside the border */
  margin: 0px;
  outline: none;
  position: relative;
  overflow: visible;
}
div.cell:before {
  position: absolute;
  display: block;
  top: -1px;
  left: -1px;
  width: 5px;
  height: calc(100% +  2px);
  content: '';
  background: transparent;
}
div.cell.jupyter-soft-selected {
  border-left-color: #E3F2FD;
  border-left-width: 1px;
  padding-left: 5px;
  border-right-color: #E3F2FD;
  border-right-width: 1px;
  background: #E3F2FD;
}
@media print {
  div.cell.jupyter-soft-selected {
    border-color: transparent;
  }
}
div.cell.selected,
div.cell.selected.jupyter-soft-selected {
  border-color: #ababab;
}
div.cell.selected:before,
div.cell.selected.jupyter-soft-selected:before {
  position: absolute;
  display: block;
  top: -1px;
  left: -1px;
  width: 5px;
  height: calc(100% +  2px);
  content: '';
  background: #42A5F5;
}
@media print {
  div.cell.selected,
  div.cell.selected.jupyter-soft-selected {
    border-color: transparent;
  }
}
.edit_mode div.cell.selected {
  border-color: #66BB6A;
}
.edit_mode div.cell.selected:before {
  position: absolute;
  display: block;
  top: -1px;
  left: -1px;
  width: 5px;
  height: calc(100% +  2px);
  content: '';
  background: #66BB6A;
}
@media print {
  .edit_mode div.cell.selected {
    border-color: transparent;
  }
}
.prompt {
  /* This needs to be wide enough for 3 digit prompt numbers: In[100]: */
  min-width: 14ex;
  /* This padding is tuned to match the padding on the CodeMirror editor. */
  padding: 0.4em;
  margin: 0px;
  font-family: monospace;
  text-align: right;
  /* This has to match that of the the CodeMirror class line-height below */
  line-height: 1.21429em;
  /* Don't highlight prompt number selection */
  -webkit-touch-callout: none;
  -webkit-user-select: none;
  -khtml-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
  /* Use default cursor */
  cursor: default;
}
@media (max-width: 540px) {
  .prompt {
    text-align: left;
  }
}
div.inner_cell {
  min-width: 0;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
  /* Old browsers */
  -webkit-box-flex: 1;
  -moz-box-flex: 1;
  box-flex: 1;
  /* Modern browsers */
  flex: 1;
}
/* input_area and input_prompt must match in top border and margin for alignment */
div.input_area {
  border: 1px solid #cfcfcf;
  border-radius: 2px;
  background: #f7f7f7;
  line-height: 1.21429em;
}
/* This is needed so that empty prompt areas can collapse to zero height when there
   is no content in the output_subarea and the prompt. The main purpose of this is
   to make sure that empty JavaScript output_subareas have no height. */
div.prompt:empty {
  padding-top: 0;
  padding-bottom: 0;
}
div.unrecognized_cell {
  padding: 5px 5px 5px 0px;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
div.unrecognized_cell .inner_cell {
  border-radius: 2px;
  padding: 5px;
  font-weight: bold;
  color: red;
  border: 1px solid #cfcfcf;
  background: #eaeaea;
}
div.unrecognized_cell .inner_cell a {
  color: inherit;
  text-decoration: none;
}
div.unrecognized_cell .inner_cell a:hover {
  color: inherit;
  text-decoration: none;
}
@media (max-width: 540px) {
  div.unrecognized_cell &gt; div.prompt {
    display: none;
  }
}
div.code_cell {
  /* avoid page breaking on code cells when printing */
}
@media print {
  div.code_cell {
    page-break-inside: avoid;
  }
}
/* any special styling for code cells that are currently running goes here */
div.input {
  page-break-inside: avoid;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
@media (max-width: 540px) {
  div.input {
    /* Old browsers */
    display: -webkit-box;
    -webkit-box-orient: vertical;
    -webkit-box-align: stretch;
    display: -moz-box;
    -moz-box-orient: vertical;
    -moz-box-align: stretch;
    display: box;
    box-orient: vertical;
    box-align: stretch;
    /* Modern browsers */
    display: flex;
    flex-direction: column;
    align-items: stretch;
  }
}
/* input_area and input_prompt must match in top border and margin for alignment */
div.input_prompt {
  color: #303F9F;
  border-top: 1px solid transparent;
}
div.input_area &gt; div.highlight {
  margin: 0.4em;
  border: none;
  padding: 0px;
  background-color: transparent;
}
div.input_area &gt; div.highlight &gt; pre {
  margin: 0px;
  border: none;
  padding: 0px;
  background-color: transparent;
}
/* The following gets added to the &lt;head&gt; if it is detected that the user has a
 * monospace font with inconsistent normal/bold/italic height.  See
 * notebookmain.js.  Such fonts will have keywords vertically offset with
 * respect to the rest of the text.  The user should select a better font.
 * See: https://github.com/ipython/ipython/issues/1503
 *
 * .CodeMirror span {
 *      vertical-align: bottom;
 * }
 */
.CodeMirror {
  line-height: 1.21429em;
  /* Changed from 1em to our global default */
  font-size: 14px;
  height: auto;
  /* Changed to auto to autogrow */
  background: none;
  /* Changed from white to allow our bg to show through */
}
.CodeMirror-scroll {
  /*  The CodeMirror docs are a bit fuzzy on if overflow-y should be hidden or visible.*/
  /*  We have found that if it is visible, vertical scrollbars appear with font size changes.*/
  overflow-y: hidden;
  overflow-x: auto;
}
.CodeMirror-lines {
  /* In CM2, this used to be 0.4em, but in CM3 it went to 4px. We need the em value because */
  /* we have set a different line-height and want this to scale with that. */
  /* Note that this should set vertical padding only, since CodeMirror assumes
       that horizontal padding will be set on CodeMirror pre */
  padding: 0.4em 0;
}
.CodeMirror-linenumber {
  padding: 0 8px 0 4px;
}
.CodeMirror-gutters {
  border-bottom-left-radius: 2px;
  border-top-left-radius: 2px;
}
.CodeMirror pre {
  /* In CM3 this went to 4px from 0 in CM2. This sets horizontal padding only,
    use .CodeMirror-lines for vertical */
  padding: 0 0.4em;
  border: 0;
  border-radius: 0;
}
.CodeMirror-cursor {
  border-left: 1.4px solid black;
}
@media screen and (min-width: 2138px) and (max-width: 4319px) {
  .CodeMirror-cursor {
    border-left: 2px solid black;
  }
}
@media screen and (min-width: 4320px) {
  .CodeMirror-cursor {
    border-left: 4px solid black;
  }
}
/*

Original style from softwaremaniacs.org (c) Ivan Sagalaev &lt;Maniac@SoftwareManiacs.Org&gt;
Adapted from GitHub theme

*/
.highlight-base {
  color: #000;
}
.highlight-variable {
  color: #000;
}
.highlight-variable-2 {
  color: #1a1a1a;
}
.highlight-variable-3 {
  color: #333333;
}
.highlight-string {
  color: #BA2121;
}
.highlight-comment {
  color: #408080;
  font-style: italic;
}
.highlight-number {
  color: #080;
}
.highlight-atom {
  color: #88F;
}
.highlight-keyword {
  color: #008000;
  font-weight: bold;
}
.highlight-builtin {
  color: #008000;
}
.highlight-error {
  color: #f00;
}
.highlight-operator {
  color: #AA22FF;
  font-weight: bold;
}
.highlight-meta {
  color: #AA22FF;
}
/* previously not defined, copying from default codemirror */
.highlight-def {
  color: #00f;
}
.highlight-string-2 {
  color: #f50;
}
.highlight-qualifier {
  color: #555;
}
.highlight-bracket {
  color: #997;
}
.highlight-tag {
  color: #170;
}
.highlight-attribute {
  color: #00c;
}
.highlight-header {
  color: blue;
}
.highlight-quote {
  color: #090;
}
.highlight-link {
  color: #00c;
}
/* apply the same style to codemirror */
.cm-s-ipython span.cm-keyword {
  color: #008000;
  font-weight: bold;
}
.cm-s-ipython span.cm-atom {
  color: #88F;
}
.cm-s-ipython span.cm-number {
  color: #080;
}
.cm-s-ipython span.cm-def {
  color: #00f;
}
.cm-s-ipython span.cm-variable {
  color: #000;
}
.cm-s-ipython span.cm-operator {
  color: #AA22FF;
  font-weight: bold;
}
.cm-s-ipython span.cm-variable-2 {
  color: #1a1a1a;
}
.cm-s-ipython span.cm-variable-3 {
  color: #333333;
}
.cm-s-ipython span.cm-comment {
  color: #408080;
  font-style: italic;
}
.cm-s-ipython span.cm-string {
  color: #BA2121;
}
.cm-s-ipython span.cm-string-2 {
  color: #f50;
}
.cm-s-ipython span.cm-meta {
  color: #AA22FF;
}
.cm-s-ipython span.cm-qualifier {
  color: #555;
}
.cm-s-ipython span.cm-builtin {
  color: #008000;
}
.cm-s-ipython span.cm-bracket {
  color: #997;
}
.cm-s-ipython span.cm-tag {
  color: #170;
}
.cm-s-ipython span.cm-attribute {
  color: #00c;
}
.cm-s-ipython span.cm-header {
  color: blue;
}
.cm-s-ipython span.cm-quote {
  color: #090;
}
.cm-s-ipython span.cm-link {
  color: #00c;
}
.cm-s-ipython span.cm-error {
  color: #f00;
}
.cm-s-ipython span.cm-tab {
  background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAMCAYAAAAkuj5RAAAAAXNSR0IArs4c6QAAAGFJREFUSMft1LsRQFAQheHPowAKoACx3IgEKtaEHujDjORSgWTH/ZOdnZOcM/sgk/kFFWY0qV8foQwS4MKBCS3qR6ixBJvElOobYAtivseIE120FaowJPN75GMu8j/LfMwNjh4HUpwg4LUAAAAASUVORK5CYII=);
  background-position: right;
  background-repeat: no-repeat;
}
div.output_wrapper {
  /* this position must be relative to enable descendents to be absolute within it */
  position: relative;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
  z-index: 1;
}
/* class for the output area when it should be height-limited */
div.output_scroll {
  /* ideally, this would be max-height, but FF barfs all over that */
  height: 24em;
  /* FF needs this *and the wrapper* to specify full width, or it will shrinkwrap */
  width: 100%;
  overflow: auto;
  border-radius: 2px;
  -webkit-box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8);
  box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8);
  display: block;
}
/* output div while it is collapsed */
div.output_collapsed {
  margin: 0px;
  padding: 0px;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
}
div.out_prompt_overlay {
  height: 100%;
  padding: 0px 0.4em;
  position: absolute;
  border-radius: 2px;
}
div.out_prompt_overlay:hover {
  /* use inner shadow to get border that is computed the same on WebKit/FF */
  -webkit-box-shadow: inset 0 0 1px #000;
  box-shadow: inset 0 0 1px #000;
  background: rgba(240, 240, 240, 0.5);
}
div.output_prompt {
  color: #D84315;
}
/* This class is the outer container of all output sections. */
div.output_area {
  padding: 0px;
  page-break-inside: avoid;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
div.output_area .MathJax_Display {
  text-align: left !important;
}
div.output_area 
div.output_area 
div.output_area img,
div.output_area svg {
  max-width: 100%;
  height: auto;
}
div.output_area img.unconfined,
div.output_area svg.unconfined {
  max-width: none;
}
div.output_area .mglyph &gt; img {
  max-width: none;
}
/* This is needed to protect the pre formating from global settings such
   as that of bootstrap */
.output {
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
}
@media (max-width: 540px) {
  div.output_area {
    /* Old browsers */
    display: -webkit-box;
    -webkit-box-orient: vertical;
    -webkit-box-align: stretch;
    display: -moz-box;
    -moz-box-orient: vertical;
    -moz-box-align: stretch;
    display: box;
    box-orient: vertical;
    box-align: stretch;
    /* Modern browsers */
    display: flex;
    flex-direction: column;
    align-items: stretch;
  }
}
div.output_area pre {
  margin: 0;
  padding: 1px 0 1px 0;
  border: 0;
  vertical-align: baseline;
  color: black;
  background-color: transparent;
  border-radius: 0;
}
/* This class is for the output subarea inside the output_area and after
   the prompt div. */
div.output_subarea {
  overflow-x: auto;
  padding: 0.4em;
  /* Old browsers */
  -webkit-box-flex: 1;
  -moz-box-flex: 1;
  box-flex: 1;
  /* Modern browsers */
  flex: 1;
  max-width: calc(100% - 14ex);
}
div.output_scroll div.output_subarea {
  overflow-x: visible;
}
/* The rest of the output_* classes are for special styling of the different
   output types */
/* all text output has this class: */
div.output_text {
  text-align: left;
  color: #000;
  /* This has to match that of the the CodeMirror class line-height below */
  line-height: 1.21429em;
}
/* stdout/stderr are 'text' as well as 'stream', but execute_result/error are *not* streams */
div.output_stderr {
  background: #fdd;
  /* very light red background for stderr */
}
div.output_latex {
  text-align: left;
}
/* Empty output_javascript divs should have no height */
div.output_javascript:empty {
  padding: 0;
}
.js-error {
  color: darkred;
}
/* raw_input styles */
div.raw_input_container {
  line-height: 1.21429em;
  padding-top: 5px;
}
pre.raw_input_prompt {
  /* nothing needed here. */
}
input.raw_input {
  font-family: monospace;
  font-size: inherit;
  color: inherit;
  width: auto;
  /* make sure input baseline aligns with prompt */
  vertical-align: baseline;
  /* padding + margin = 0.5em between prompt and cursor */
  padding: 0em 0.25em;
  margin: 0em 0.25em;
}
input.raw_input:focus {
  box-shadow: none;
}
p.p-space {
  margin-bottom: 10px;
}
div.output_unrecognized {
  padding: 5px;
  font-weight: bold;
  color: red;
}
div.output_unrecognized a {
  color: inherit;
  text-decoration: none;
}
div.output_unrecognized a:hover {
  color: inherit;
  text-decoration: none;
}
.rendered_html {
  color: #000;
  /* any extras will just be numbers: */
}



.rendered_html :link {
  text-decoration: underline;
}
.rendered_html :visited {
  text-decoration: underline;
}






.rendered_html h1:first-child {
  margin-top: 0.538em;
}
.rendered_html h2:first-child {
  margin-top: 0.636em;
}
.rendered_html h3:first-child {
  margin-top: 0.777em;
}
.rendered_html h4:first-child {
  margin-top: 1em;
}
.rendered_html h5:first-child {
  margin-top: 1em;
}
.rendered_html h6:first-child {
  margin-top: 1em;
}
.rendered_html ul:not(.list-inline),
.rendered_html ol:not(.list-inline) {
  padding-left: 2em;
}








.rendered_html * + ul {
  margin-top: 1em;
}
.rendered_html * + ol {
  margin-top: 1em;
}





.rendered_html pre,




.rendered_html tr,
.rendered_html th,


.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}
.rendered_html * + table {
  margin-top: 1em;
}

.rendered_html * + p {
  margin-top: 1em;
}

.rendered_html * + img {
  margin-top: 1em;
}
.rendered_html img,

.rendered_html img.unconfined,


.rendered_html * + .alert {
  margin-top: 1em;
}
[dir="rtl"] 
div.text_cell {
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
@media (max-width: 540px) {
  div.text_cell &gt; div.prompt {
    display: none;
  }
}
div.text_cell_render {
  /*font-family: "Helvetica Neue", Arial, Helvetica, Geneva, sans-serif;*/
  outline: none;
  resize: none;
  width: inherit;
  border-style: none;
  padding: 0.5em 0.5em 0.5em 0.4em;
  color: #000;
  box-sizing: border-box;
  -moz-box-sizing: border-box;
  -webkit-box-sizing: border-box;
}
a.anchor-link:link {
  text-decoration: none;
  padding: 0px 20px;
  visibility: hidden;
}
h1:hover .anchor-link,
h2:hover .anchor-link,
h3:hover .anchor-link,
h4:hover .anchor-link,
h5:hover .anchor-link,
h6:hover .anchor-link {
  visibility: visible;
}
.text_cell.rendered .input_area {
  display: none;
}
.text_cell.rendered 
.text_cell.rendered .rendered_html tr,
.text_cell.rendered .rendered_html th,
.text_cell.rendered 
.text_cell.unrendered .text_cell_render {
  display: none;
}
.text_cell .dropzone .input_area {
  border: 2px dashed #bababa;
  margin: -1px;
}
.cm-header-1,
.cm-header-2,
.cm-header-3,
.cm-header-4,
.cm-header-5,
.cm-header-6 {
  font-weight: bold;
  font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
}
.cm-header-1 {
  font-size: 185.7%;
}
.cm-header-2 {
  font-size: 157.1%;
}
.cm-header-3 {
  font-size: 128.6%;
}
.cm-header-4 {
  font-size: 110%;
}
.cm-header-5 {
  font-size: 100%;
  font-style: italic;
}
.cm-header-6 {
  font-size: 100%;
  font-style: italic;
}
&lt;/style&gt;
&lt;style type="text/css"&gt;.highlight .hll { background-color: #ffffcc }
.highlight  { background: #f8f8f8; }
.highlight .c { color: #408080; font-style: italic } /* Comment */
.highlight .err { border: 1px solid #FF0000 } /* Error */
.highlight .k { color: #008000; font-weight: bold } /* Keyword */
.highlight .o { color: #666666 } /* Operator */
.highlight .ch { color: #408080; font-style: italic } /* Comment.Hashbang */
.highlight .cm { color: #408080; font-style: italic } /* Comment.Multiline */
.highlight .cp { color: #BC7A00 } /* Comment.Preproc */
.highlight .cpf { color: #408080; font-style: italic } /* Comment.PreprocFile */
.highlight .c1 { color: #408080; font-style: italic } /* Comment.Single */
.highlight .cs { color: #408080; font-style: italic } /* Comment.Special */
.highlight .gd { color: #A00000 } /* Generic.Deleted */
.highlight .ge { font-style: italic } /* Generic.Emph */
.highlight .gr { color: #FF0000 } /* Generic.Error */
.highlight .gh { color: #000080; font-weight: bold } /* Generic.Heading */
.highlight .gi { color: #00A000 } /* Generic.Inserted */
.highlight .go { color: #888888 } /* Generic.Output */
.highlight .gp { color: #000080; font-weight: bold } /* Generic.Prompt */
.highlight .gs { font-weight: bold } /* Generic.Strong */
.highlight .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.highlight .gt { color: #0044DD } /* Generic.Traceback */
.highlight .kc { color: #008000; font-weight: bold } /* Keyword.Constant */
.highlight .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */
.highlight .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */
.highlight .kp { color: #008000 } /* Keyword.Pseudo */
.highlight .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */
.highlight .kt { color: #B00040 } /* Keyword.Type */
.highlight .m { color: #666666 } /* Literal.Number */
.highlight .s { color: #BA2121 } /* Literal.String */
.highlight .na { color: #7D9029 } /* Name.Attribute */
.highlight .nb { color: #008000 } /* Name.Builtin */
.highlight .nc { color: #0000FF; font-weight: bold } /* Name.Class */
.highlight .no { color: #880000 } /* Name.Constant */
.highlight .nd { color: #AA22FF } /* Name.Decorator */
.highlight .ni { color: #999999; font-weight: bold } /* Name.Entity */
.highlight .ne { color: #D2413A; font-weight: bold } /* Name.Exception */
.highlight .nf { color: #0000FF } /* Name.Function */
.highlight .nl { color: #A0A000 } /* Name.Label */
.highlight .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */
.highlight .nt { color: #008000; font-weight: bold } /* Name.Tag */
.highlight .nv { color: #19177C } /* Name.Variable */
.highlight .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */
.highlight .w { color: #bbbbbb } /* Text.Whitespace */
.highlight .mb { color: #666666 } /* Literal.Number.Bin */
.highlight .mf { color: #666666 } /* Literal.Number.Float */
.highlight .mh { color: #666666 } /* Literal.Number.Hex */
.highlight .mi { color: #666666 } /* Literal.Number.Integer */
.highlight .mo { color: #666666 } /* Literal.Number.Oct */
.highlight .sa { color: #BA2121 } /* Literal.String.Affix */
.highlight .sb { color: #BA2121 } /* Literal.String.Backtick */
.highlight .sc { color: #BA2121 } /* Literal.String.Char */
.highlight .dl { color: #BA2121 } /* Literal.String.Delimiter */
.highlight .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */
.highlight .s2 { color: #BA2121 } /* Literal.String.Double */
.highlight .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */
.highlight .sh { color: #BA2121 } /* Literal.String.Heredoc */
.highlight .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */
.highlight .sx { color: #008000 } /* Literal.String.Other */
.highlight .sr { color: #BB6688 } /* Literal.String.Regex */
.highlight .s1 { color: #BA2121 } /* Literal.String.Single */
.highlight .ss { color: #19177C } /* Literal.String.Symbol */
.highlight .bp { color: #008000 } /* Name.Builtin.Pseudo */
.highlight .fm { color: #0000FF } /* Name.Function.Magic */
.highlight .vc { color: #19177C } /* Name.Variable.Class */
.highlight .vg { color: #19177C } /* Name.Variable.Global */
.highlight .vi { color: #19177C } /* Name.Variable.Instance */
.highlight .vm { color: #19177C } /* Name.Variable.Magic */
.highlight .il { color: #666666 } /* Literal.Number.Integer.Long */&lt;/style&gt;
&lt;style type="text/css"&gt;
/* Temporary definitions which will become obsolete with Notebook release 5.0 */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-bold { font-weight: bold; }
&lt;/style&gt;
&lt;script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.0.3/jquery.min.js"&gt;&lt;/script&gt;


&lt;style type="text/css"&gt;
/* hide input prompt number */
.input_prompt{
  visibility: hidden
}

.output_prompt{
  /* hide output prompt number */
  visibility: hidden
}
&lt;/style&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;&lt;h1&gt;Table of Contents&lt;span class="tocSkip"&gt;&lt;/span&gt;&lt;/h1&gt;&lt;/p&gt;
&lt;div class="toc"&gt;&lt;ul class="toc-item"&gt;&lt;li&gt;&lt;span&gt;&lt;a href="#About" data-toc-modified-id="About-1"&gt;&lt;span class="toc-item-num"&gt;1&amp;nbsp;&amp;nbsp;&lt;/span&gt;About&lt;/a&gt;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&lt;a href="#Postgres-Mission" data-toc-modified-id="Postgres-Mission-2"&gt;&lt;span class="toc-item-num"&gt;2&amp;nbsp;&amp;nbsp;&lt;/span&gt;Postgres Mission&lt;/a&gt;&lt;/span&gt;&lt;ul class="toc-item"&gt;&lt;li&gt;&lt;span&gt;&lt;a href="#Create-the-postgres-instance" data-toc-modified-id="Create-the-postgres-instance-2.1"&gt;&lt;span class="toc-item-num"&gt;2.1&amp;nbsp;&amp;nbsp;&lt;/span&gt;Create the postgres instance&lt;/a&gt;&lt;/span&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&lt;a href="#Create-users-and-roles" data-toc-modified-id="Create-users-and-roles-3"&gt;&lt;span class="toc-item-num"&gt;3&amp;nbsp;&amp;nbsp;&lt;/span&gt;Create users and roles&lt;/a&gt;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&lt;a href="#Preparing-for-data-insertion" data-toc-modified-id="Preparing-for-data-insertion-4"&gt;&lt;span class="toc-item-num"&gt;4&amp;nbsp;&amp;nbsp;&lt;/span&gt;Preparing for data insertion&lt;/a&gt;&lt;/span&gt;&lt;ul class="toc-item"&gt;&lt;li&gt;&lt;span&gt;&lt;a href="#Inspection-of-the-data" data-toc-modified-id="Inspection-of-the-data-4.1"&gt;&lt;span class="toc-item-num"&gt;4.1&amp;nbsp;&amp;nbsp;&lt;/span&gt;Inspection of the data&lt;/a&gt;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&lt;a href="#Shaping-data" data-toc-modified-id="Shaping-data-4.2"&gt;&lt;span class="toc-item-num"&gt;4.2&amp;nbsp;&amp;nbsp;&lt;/span&gt;Shaping data&lt;/a&gt;&lt;/span&gt;&lt;ul class="toc-item"&gt;&lt;li&gt;&lt;span&gt;&lt;a href="#Clean-missing-values" data-toc-modified-id="Clean-missing-values-4.2.1"&gt;&lt;span class="toc-item-num"&gt;4.2.1&amp;nbsp;&amp;nbsp;&lt;/span&gt;Clean missing values&lt;/a&gt;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&lt;a href="#Merge-date-columns-into-a-single-one" data-toc-modified-id="Merge-date-columns-into-a-single-one-4.2.2"&gt;&lt;span class="toc-item-num"&gt;4.2.2&amp;nbsp;&amp;nbsp;&lt;/span&gt;Merge date columns into a single one&lt;/a&gt;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&lt;a href="#Further-optimizations" data-toc-modified-id="Further-optimizations-4.2.3"&gt;&lt;span class="toc-item-num"&gt;4.2.3&amp;nbsp;&amp;nbsp;&lt;/span&gt;Further optimizations&lt;/a&gt;&lt;/span&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&lt;a href="#Creating-the-table-with-SQL" data-toc-modified-id="Creating-the-table-with-SQL-4.3"&gt;&lt;span class="toc-item-num"&gt;4.3&amp;nbsp;&amp;nbsp;&lt;/span&gt;Creating the table with SQL&lt;/a&gt;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&lt;a href="#Insert-the-data-in-the-database" data-toc-modified-id="Insert-the-data-in-the-database-4.4"&gt;&lt;span class="toc-item-num"&gt;4.4&amp;nbsp;&amp;nbsp;&lt;/span&gt;Insert the data in the database&lt;/a&gt;&lt;/span&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&lt;a href="#Grant-specific-privileges-between-users-and-tables" data-toc-modified-id="Grant-specific-privileges-between-users-and-tables-5"&gt;&lt;span class="toc-item-num"&gt;5&amp;nbsp;&amp;nbsp;&lt;/span&gt;Grant specific privileges between users and tables&lt;/a&gt;&lt;/span&gt;&lt;ul class="toc-item"&gt;&lt;li&gt;&lt;span&gt;&lt;a href="#Verify-permissions-and-roles" data-toc-modified-id="Verify-permissions-and-roles-5.1"&gt;&lt;span class="toc-item-num"&gt;5.1&amp;nbsp;&amp;nbsp;&lt;/span&gt;Verify permissions and roles&lt;/a&gt;&lt;/span&gt;&lt;ul class="toc-item"&gt;&lt;li&gt;&lt;span&gt;&lt;a href="#As-postgres-user" data-toc-modified-id="As-postgres-user-5.1.1"&gt;&lt;span class="toc-item-num"&gt;5.1.1&amp;nbsp;&amp;nbsp;&lt;/span&gt;As &lt;code&gt;postgres&lt;/code&gt; user&lt;/a&gt;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&lt;a href="#As-data_prod_user" data-toc-modified-id="As-data_prod_user-5.1.2"&gt;&lt;span class="toc-item-num"&gt;5.1.2&amp;nbsp;&amp;nbsp;&lt;/span&gt;As &lt;code&gt;data_prod_user&lt;/code&gt;&lt;/a&gt;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&lt;a href="#Checking-permissions-as-analyst1" data-toc-modified-id="Checking-permissions-as-analyst1-5.1.3"&gt;&lt;span class="toc-item-num"&gt;5.1.3&amp;nbsp;&amp;nbsp;&lt;/span&gt;Checking permissions as &lt;code&gt;analyst1&lt;/code&gt;&lt;/a&gt;&lt;/span&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&lt;a href="#Final-words" data-toc-modified-id="Final-words-6"&gt;&lt;span class="toc-item-num"&gt;6&amp;nbsp;&amp;nbsp;&lt;/span&gt;Final words&lt;/a&gt;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span&gt;&lt;a href="#Moving-forward" data-toc-modified-id="Moving-forward-7"&gt;&lt;span class="toc-item-num"&gt;7&amp;nbsp;&amp;nbsp;&lt;/span&gt;Moving forward&lt;/a&gt;&lt;/span&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;h1 id="About"&gt;About&lt;a class="anchor-link" href="#About"&gt;&amp;#182;&lt;/a&gt;&lt;/h1&gt;&lt;p&gt;This is the notebook I created to solve the first mission in the &lt;em&gt;data engineering path&lt;/em&gt; in &lt;a href="www.dataquest.io"&gt;dataquest.io&lt;/a&gt;. I am also experimenting with the &lt;a href="https://github.com/danielfrg/pelican-ipynb"&gt;Pelican-Jupyter Notebook&lt;/a&gt; extension, that allows to load jupyter notebooks directly in the blog.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;h1 id="Postgres-Mission"&gt;Postgres Mission&lt;a class="anchor-link" href="#Postgres-Mission"&gt;&amp;#182;&lt;/a&gt;&lt;/h1&gt;&lt;p&gt;The problem goes something like this:&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;Recently, the International Hurricane Watchgroup (IHW) has been asked to update their analysis tools. Because of the increase in public awareness of hurricanes, they are required to be more diligient with the analysis of historical hurricane data they share across the organization. They have asked you, someone with experience in databases, to help work with their team to productionize their services.&lt;/p&gt;
&lt;p&gt;Accepting the job, their team tells you that they have been having trouble sharing data across the teams and keeping it consistent. From what they've told you, it seems that their method of sharing the data with their data anaylsts has been to save a CSV file on their local servers and have every data analyst pull the data down. Then, each analyst uses a local SQLite engine to store the CSV, run their queries, and send their results around.&lt;/p&gt;
&lt;p&gt;From what they have told you, you might be thinking that this is an inefficient way of sharing data. To understand what you will be working on, they have sent you a CSV file. Their CSV file contains the following fields:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;fid - ID for the row
year - Recorded year
month - Recorded month
day - Recorded date
ad_time - Recorded time in UTC
btid - Hurricane ID
name - Name of the hurricane
lat - Latitude of the recorded location
long - Longitude of the recorded location
wind_kts - Wind speed in knots per second
pressure - Atmospheric pressure of the hurricane
cat - Hurricane category
basin - The basin the hurricane is located
shape_leng - Hurricane shape length

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;In this Guided Project, you will be using the local installed version of Postgres you installed from the previous project. This is much different than previous Guided Projects as you will be using your own notebook and your own Python environment instead of Dataquest's. Your job is to show that you can create a database that will accomplish the following requirements:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Database for the IHW to store their tables.&lt;/li&gt;
&lt;li&gt;Table that contains the fields detailed in the CSV file&lt;/li&gt;
&lt;li&gt;User that can update, read, and insert into a table of the data.&lt;/li&gt;
&lt;li&gt;Insert the data into the table.&lt;/li&gt;
&lt;/ol&gt;
&lt;/blockquote&gt;
&lt;p&gt;Let's do this.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;h2 id="Create-the-postgres-instance"&gt;Create the postgres instance&lt;a class="anchor-link" href="#Create-the-postgres-instance"&gt;&amp;#182;&lt;/a&gt;&lt;/h2&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;We'll be using a docker container with a postgres persistent database. The &lt;code&gt;pgadmin&lt;/code&gt; instance is not needed, but we can use it to have a GUI available by default in &lt;code&gt;0.0.0.0:8080&lt;/code&gt;. Note this is a toy configuration, and it should not be used to store sensitive information.&lt;/p&gt;
&lt;p&gt;We won't be dealing with what this file means. Here we use docker to have a disposable database quickly. You could have a local postgres instance and that would work as well.&lt;/p&gt;
&lt;p&gt;You can get more information about postgres in docker in the &lt;a href="https://store.docker.com/_/postgres"&gt;docker store&lt;/a&gt;&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In&amp;nbsp;[21]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="o"&gt;!&lt;/span&gt;cat docker-compose.yml
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;

    &lt;div class="prompt"&gt;&lt;/div&gt;


&lt;div class="output_subarea output_stream output_stdout output_text"&gt;
&lt;pre&gt;# Use postgres/example user/password credentials
version: &amp;#39;3.1&amp;#39;

services:
  db:
    image: postgres:10
    environment:
      POSTGRES_USER: postgres
      POSTGRES_PASSWORD: postgres 
    volumes:
      - pgdata:/var/lib/postgresql/data
    ports:
      - 54320:5432
    networks:
      db_nw:
        aliases:
          - postgres
  pgadmin:
    image: dpage/pgadmin4:latest
    environment:
      POSTGRES_PASSWORD: postgres 
      PGADMIN_DEFAULT_EMAIL: user@domain.com 
      PGADMIN_DEFAULT_PASSWORD: admin
    ports:
      - 8080:80
    networks:
      - db_nw

volumes:
    pgdata: {}

networks:
  db_nw:
    driver: bridge

&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In&amp;nbsp;[22]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="o"&gt;!&lt;/span&gt;docker-compose -p dq_de up -d
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;

    &lt;div class="prompt"&gt;&lt;/div&gt;


&lt;div class="output_subarea output_stream output_stdout output_text"&gt;
&lt;pre&gt;dq_de_db_1 is up-to-date
dq_de_pgadmin_1 is up-to-date
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In&amp;nbsp;[23]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="c1"&gt;# check if postgres docker instance is alive&lt;/span&gt;
&lt;span class="o"&gt;!&lt;/span&gt;docker ps
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;

    &lt;div class="prompt"&gt;&lt;/div&gt;


&lt;div class="output_subarea output_stream output_stdout output_text"&gt;
&lt;pre&gt;CONTAINER ID        IMAGE                                   COMMAND                  CREATED             STATUS              PORTS                           NAMES
58b58e1f97f4        postgres:10                             &amp;#34;docker-entrypoint.s…&amp;#34;   10 days ago         Up 3 hours          0.0.0.0:54320-&amp;gt;5432/tcp         dq_de_db_1
c5b7c0ec8430        dpage/pgadmin4:latest                   &amp;#34;/entrypoint.sh&amp;#34;         10 days ago         Up 3 hours          443/tcp, 0.0.0.0:8080-&amp;gt;80/tcp   dq_de_pgadmin_1
9f18df162b11        rediscommander/redis-commander:latest   &amp;#34;/usr/bin/dumb-init …&amp;#34;   2 weeks ago         Up 3 hours          0.0.0.0:8081-&amp;gt;8081/tcp          redis-commander
e38a793b3b60        postgres:10                             &amp;#34;docker-entrypoint.s…&amp;#34;   2 weeks ago         Up 3 hours          0.0.0.0:51085-&amp;gt;5432/tcp         demo_db_1
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In&amp;nbsp;[29]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="c1"&gt;# retrieve the ip address of the container, seen from the host&lt;/span&gt;
&lt;span class="o"&gt;!&lt;/span&gt;docker inspect dq_de_db_1 &lt;span class="p"&gt;|&lt;/span&gt; grep &lt;span class="s2"&gt;&amp;quot;IPAddress&amp;quot;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;

    &lt;div class="prompt"&gt;&lt;/div&gt;


&lt;div class="output_subarea output_stream output_stdout output_text"&gt;
&lt;pre&gt;            &amp;#34;SecondaryIPAddresses&amp;#34;: null,
            &amp;#34;IPAddress&amp;#34;: &amp;#34;&amp;#34;,
                    &amp;#34;IPAddress&amp;#34;: &amp;#34;192.168.32.3&amp;#34;,
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;Note that we could also refer to our database by the port mapping done in the &lt;code&gt;docker-compose.yml&lt;/code&gt; file. This means that we could reach our database in &lt;code&gt;0.0.0.0:54320&lt;/code&gt;.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;h1 id="Create-users-and-roles"&gt;Create users and roles&lt;a class="anchor-link" href="#Create-users-and-roles"&gt;&amp;#182;&lt;/a&gt;&lt;/h1&gt;&lt;p&gt;The mission instructions state that&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;With a table set up, it's now time to create a user on the Postgres database that can insert, update, and read the data but not delete. This is to make sure that someone who might get a hold of this user does not issue a destructive command. Essentially, this is like creating a "data production" user whose job it is is to always write new and existing data to the table.&lt;/p&gt;
&lt;p&gt;Futhermore, even though it wasn't according to the spec, we know that the IHW team's analysts just run read queries on the data. Also, since the analysts only know SQLite queries, they may not be well-versed in a production database. As such, it might be risky handing out a general production user for them to query their data.&lt;/p&gt;
&lt;p&gt;From what you have learned about security and restricting well meaning users, it might be a good idea to restrict those analysts from some commands. Those commands can be anything from adding new data to the table or changing the values. You should decide what commands should be given to the analyst user.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;In short, what I get from this is&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Connected as a &lt;code&gt;postgres&lt;/code&gt; user, create a user &lt;code&gt;data_prod_user&lt;/code&gt; that can insert, update, and read the data but &lt;strong&gt;not&lt;/strong&gt; delete.&lt;/li&gt;
&lt;li&gt;This is like a "data production" user whose job is to always write new and existing data to the table.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Also,&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Create a role &lt;code&gt;GROUP&lt;/code&gt; for the IHW analyst team that can only read data from tables&lt;/li&gt;
&lt;li&gt;Create a user in this group, called &lt;code&gt;analyst1&lt;/code&gt;. Picking names is &lt;em&gt;hard&lt;/em&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Note that &lt;em&gt;users&lt;/em&gt; and &lt;em&gt;groups&lt;/em&gt; are all part of the same entity in postgres, the &lt;a href="https://severalnines.com/blog/postgresql-privileges-user-management-what-you-should-know"&gt;&lt;em&gt;role&lt;/em&gt;&lt;/a&gt;.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In&amp;nbsp;[1]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;psycopg2&lt;/span&gt;

&lt;span class="n"&gt;conn&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;psycopg2&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;connect&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;
    &lt;span class="n"&gt;dbname&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;postgres&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;user&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;postgres&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;password&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;postgres&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;host&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;192.168.32.3&amp;quot;&lt;/span&gt;
&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="n"&gt;conn&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;autocommit&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="kc"&gt;True&lt;/span&gt;
&lt;span class="n"&gt;cur&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;conn&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;cursor&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;

&lt;span class="n"&gt;DATA_PROD_USER_PWD&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;changeme&amp;quot;&lt;/span&gt;
&lt;span class="n"&gt;DATA_VIEW_USER_PWD&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;changeme&amp;quot;&lt;/span&gt;

&lt;span class="c1"&gt;# create user and detach password from command&lt;/span&gt;
&lt;span class="c1"&gt;# also add an IF NOT EXIST clause as a hack from&lt;/span&gt;
&lt;span class="c1"&gt;# https://stackoverflow.com/questions/8092086/create-postgresql-role-user-if-it-doesnt-exist&lt;/span&gt;
&lt;span class="n"&gt;cur&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;execute&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
&lt;span class="s2"&gt;CREATE USER data_prod_user WITH PASSWORD &amp;#39;&lt;/span&gt;&lt;span class="si"&gt;{DATA_PROD_USER_PWD}&lt;/span&gt;&lt;span class="s2"&gt;&amp;#39;;&lt;/span&gt;
&lt;span class="s2"&gt;CREATE GROUP readonly WITH NOLOGIN;&lt;/span&gt;
&lt;span class="s2"&gt;CREATE USER analyst1 WITH PASSWORD &amp;#39;&lt;/span&gt;&lt;span class="si"&gt;{DATA_VIEW_USER_PWD}&lt;/span&gt;&lt;span class="s2"&gt;&amp;#39; IN GROUP readonly;&lt;/span&gt;
&lt;span class="s2"&gt;&amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="c1"&gt;# create db&lt;/span&gt;
&lt;span class="nb"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;CREATE DATABASE ihw OWNER postgres&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;cur&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;execute&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;CREATE DATABASE ihw OWNER postgres&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="n"&gt;conn&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;commit&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="n"&gt;conn&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;close&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;

    &lt;div class="prompt"&gt;&lt;/div&gt;


&lt;div class="output_subarea output_stream output_stderr output_text"&gt;
&lt;pre&gt;/home/diego/.pyenv/versions/3.6.6/envs/dq-de/lib/python3.6/site-packages/psycopg2/__init__.py:144: UserWarning: The psycopg2 wheel package will be renamed from release 2.8; in order to keep installing from binary please use &amp;#34;pip install psycopg2-binary&amp;#34; instead. For details see: &amp;lt;http://initd.org/psycopg/docs/install.html#binary-install-from-pypi&amp;gt;.
  &amp;#34;&amp;#34;&amp;#34;)
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_area"&gt;

    &lt;div class="prompt"&gt;&lt;/div&gt;


&lt;div class="output_subarea output_stream output_stdout output_text"&gt;
&lt;pre&gt;CREATE DATABASE ihw OWNER postgres
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;If you want to start over, just &lt;code&gt;DROP&lt;/code&gt; everything.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In&amp;nbsp;[26]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="c1"&gt;# revoke all permissions by default. &lt;/span&gt;
&lt;span class="c1"&gt;# Use this to start all over.&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;psycopg2&lt;/span&gt;

&lt;span class="n"&gt;conn&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;psycopg2&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;connect&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;
    &lt;span class="n"&gt;dbname&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;postgres&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;user&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;postgres&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;password&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;postgres&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;host&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;192.168.32.3&amp;quot;&lt;/span&gt;
&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="n"&gt;conn&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;autocommit&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="kc"&gt;True&lt;/span&gt;
&lt;span class="n"&gt;cur&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;conn&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;cursor&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;

&lt;span class="c1"&gt;# drop users&lt;/span&gt;
&lt;span class="n"&gt;cur&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;execute&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
&lt;span class="s2"&gt;DROP USER data_prod_user;&lt;/span&gt;
&lt;span class="s2"&gt;DROP USER analyst1;&lt;/span&gt;
&lt;span class="s2"&gt;DROP GROUP readonly;&lt;/span&gt;
&lt;span class="s2"&gt;&amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="c1"&gt;# drop db&lt;/span&gt;
&lt;span class="nb"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;DROP DATABASE IF EXISTS ihw&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;cur&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;execute&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;DROP DATABASE IF EXISTS ihw&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="n"&gt;conn&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;commit&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="n"&gt;conn&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;close&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;h1 id="Preparing-for-data-insertion"&gt;Preparing for data insertion&lt;a class="anchor-link" href="#Preparing-for-data-insertion"&gt;&amp;#182;&lt;/a&gt;&lt;/h1&gt;&lt;p&gt;Now with our new users, we can start creating our tables. A table is assigned by default to the user that created it, and it will live by default in the database that the connection was assigned to.&lt;/p&gt;
&lt;p&gt;The steps involved in inserting the data are&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Inspect the data: This process is specific to the problem, and it may vary each time. I will be using &lt;code&gt;pandas&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;Infer the data types from the previous analysis that will be used in out SQL table: This refers to the questions of the type &lt;em&gt;"would an integer suffice?", "how long should these strings be", "Can this column be normalized?"&lt;/em&gt;. This will probably require shaping the data analyzed previously.&lt;/li&gt;
&lt;li&gt;Create the table: This is the translation of the previous step into a proper SQL table.&lt;/li&gt;
&lt;li&gt;Populate the table: Fill the new table with data. I will be using postgres' &lt;code&gt;COPY&lt;/code&gt; feature by means of &lt;code&gt;psycopg.copy_expert()&lt;/code&gt;&lt;/li&gt;
&lt;/ol&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;h2 id="Inspection-of-the-data"&gt;Inspection of the data&lt;a class="anchor-link" href="#Inspection-of-the-data"&gt;&amp;#182;&lt;/a&gt;&lt;/h2&gt;&lt;p&gt;Before even knowing how our table will should be created, we should inspect our data. We will be using &lt;code&gt;pandas&lt;/code&gt; for this purpose.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In&amp;nbsp;[1]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="c1"&gt;# load data&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;pandas&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;pd&lt;/span&gt;
&lt;span class="n"&gt;df&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;pd&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;read_csv&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;https://dq-content.s3.amazonaws.com/251/storm_data.csv&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;df&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;head&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;

    &lt;div class="prompt output_prompt"&gt;Out[1]:&lt;/div&gt;



&lt;div class="output_html rendered_html output_subarea output_execute_result"&gt;
&lt;div&gt;
&lt;style scoped&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
&lt;/style&gt;
&lt;table border="1" class="dataframe"&gt;
  &lt;thead&gt;
    &lt;tr style="text-align: right;"&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;FID&lt;/th&gt;
      &lt;th&gt;YEAR&lt;/th&gt;
      &lt;th&gt;MONTH&lt;/th&gt;
      &lt;th&gt;DAY&lt;/th&gt;
      &lt;th&gt;AD_TIME&lt;/th&gt;
      &lt;th&gt;BTID&lt;/th&gt;
      &lt;th&gt;NAME&lt;/th&gt;
      &lt;th&gt;LAT&lt;/th&gt;
      &lt;th&gt;LONG&lt;/th&gt;
      &lt;th&gt;WIND_KTS&lt;/th&gt;
      &lt;th&gt;PRESSURE&lt;/th&gt;
      &lt;th&gt;CAT&lt;/th&gt;
      &lt;th&gt;BASIN&lt;/th&gt;
      &lt;th&gt;Shape_Leng&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;0&lt;/th&gt;
      &lt;td&gt;2001&lt;/td&gt;
      &lt;td&gt;1957&lt;/td&gt;
      &lt;td&gt;8&lt;/td&gt;
      &lt;td&gt;8&lt;/td&gt;
      &lt;td&gt;1800Z&lt;/td&gt;
      &lt;td&gt;63&lt;/td&gt;
      &lt;td&gt;NOTNAMED&lt;/td&gt;
      &lt;td&gt;22.5&lt;/td&gt;
      &lt;td&gt;-140.0&lt;/td&gt;
      &lt;td&gt;50&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;TS&lt;/td&gt;
      &lt;td&gt;Eastern Pacific&lt;/td&gt;
      &lt;td&gt;1.140175&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;1&lt;/th&gt;
      &lt;td&gt;2002&lt;/td&gt;
      &lt;td&gt;1961&lt;/td&gt;
      &lt;td&gt;10&lt;/td&gt;
      &lt;td&gt;3&lt;/td&gt;
      &lt;td&gt;1200Z&lt;/td&gt;
      &lt;td&gt;116&lt;/td&gt;
      &lt;td&gt;PAULINE&lt;/td&gt;
      &lt;td&gt;22.1&lt;/td&gt;
      &lt;td&gt;-140.2&lt;/td&gt;
      &lt;td&gt;45&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;TS&lt;/td&gt;
      &lt;td&gt;Eastern Pacific&lt;/td&gt;
      &lt;td&gt;1.166190&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;2&lt;/th&gt;
      &lt;td&gt;2003&lt;/td&gt;
      &lt;td&gt;1962&lt;/td&gt;
      &lt;td&gt;8&lt;/td&gt;
      &lt;td&gt;29&lt;/td&gt;
      &lt;td&gt;0600Z&lt;/td&gt;
      &lt;td&gt;124&lt;/td&gt;
      &lt;td&gt;C&lt;/td&gt;
      &lt;td&gt;18.0&lt;/td&gt;
      &lt;td&gt;-140.0&lt;/td&gt;
      &lt;td&gt;45&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;TS&lt;/td&gt;
      &lt;td&gt;Eastern Pacific&lt;/td&gt;
      &lt;td&gt;2.102380&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;3&lt;/th&gt;
      &lt;td&gt;2004&lt;/td&gt;
      &lt;td&gt;1967&lt;/td&gt;
      &lt;td&gt;7&lt;/td&gt;
      &lt;td&gt;14&lt;/td&gt;
      &lt;td&gt;0600Z&lt;/td&gt;
      &lt;td&gt;168&lt;/td&gt;
      &lt;td&gt;DENISE&lt;/td&gt;
      &lt;td&gt;16.6&lt;/td&gt;
      &lt;td&gt;-139.5&lt;/td&gt;
      &lt;td&gt;45&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;TS&lt;/td&gt;
      &lt;td&gt;Eastern Pacific&lt;/td&gt;
      &lt;td&gt;2.121320&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;4&lt;/th&gt;
      &lt;td&gt;2005&lt;/td&gt;
      &lt;td&gt;1972&lt;/td&gt;
      &lt;td&gt;8&lt;/td&gt;
      &lt;td&gt;16&lt;/td&gt;
      &lt;td&gt;1200Z&lt;/td&gt;
      &lt;td&gt;251&lt;/td&gt;
      &lt;td&gt;DIANA&lt;/td&gt;
      &lt;td&gt;18.5&lt;/td&gt;
      &lt;td&gt;-139.8&lt;/td&gt;
      &lt;td&gt;70&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;H1&lt;/td&gt;
      &lt;td&gt;Eastern Pacific&lt;/td&gt;
      &lt;td&gt;1.702939&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In&amp;nbsp;[2]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;df&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;info&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;

    &lt;div class="prompt"&gt;&lt;/div&gt;


&lt;div class="output_subarea output_stream output_stdout output_text"&gt;
&lt;pre&gt;&amp;lt;class &amp;#39;pandas.core.frame.DataFrame&amp;#39;&amp;gt;
RangeIndex: 59228 entries, 0 to 59227
Data columns (total 14 columns):
FID           59228 non-null int64
YEAR          59228 non-null int64
MONTH         59228 non-null int64
DAY           59228 non-null int64
AD_TIME       59228 non-null object
BTID          59228 non-null int64
NAME          59228 non-null object
LAT           59228 non-null float64
LONG          59228 non-null float64
WIND_KTS      59228 non-null int64
PRESSURE      59228 non-null int64
CAT           59228 non-null object
BASIN         59228 non-null object
Shape_Leng    59228 non-null float64
dtypes: float64(3), int64(7), object(4)
memory usage: 6.3+ MB
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In&amp;nbsp;[3]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;df&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;describe&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;

    &lt;div class="prompt output_prompt"&gt;Out[3]:&lt;/div&gt;



&lt;div class="output_html rendered_html output_subarea output_execute_result"&gt;
&lt;div&gt;
&lt;style scoped&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
&lt;/style&gt;
&lt;table border="1" class="dataframe"&gt;
  &lt;thead&gt;
    &lt;tr style="text-align: right;"&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;FID&lt;/th&gt;
      &lt;th&gt;YEAR&lt;/th&gt;
      &lt;th&gt;MONTH&lt;/th&gt;
      &lt;th&gt;DAY&lt;/th&gt;
      &lt;th&gt;BTID&lt;/th&gt;
      &lt;th&gt;LAT&lt;/th&gt;
      &lt;th&gt;LONG&lt;/th&gt;
      &lt;th&gt;WIND_KTS&lt;/th&gt;
      &lt;th&gt;PRESSURE&lt;/th&gt;
      &lt;th&gt;Shape_Leng&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;count&lt;/th&gt;
      &lt;td&gt;59228.000000&lt;/td&gt;
      &lt;td&gt;59228.000000&lt;/td&gt;
      &lt;td&gt;59228.000000&lt;/td&gt;
      &lt;td&gt;59228.000000&lt;/td&gt;
      &lt;td&gt;59228.000000&lt;/td&gt;
      &lt;td&gt;59228.000000&lt;/td&gt;
      &lt;td&gt;59228.000000&lt;/td&gt;
      &lt;td&gt;59228.000000&lt;/td&gt;
      &lt;td&gt;59228.000000&lt;/td&gt;
      &lt;td&gt;59228.000000&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;mean&lt;/th&gt;
      &lt;td&gt;29614.500000&lt;/td&gt;
      &lt;td&gt;1957.194874&lt;/td&gt;
      &lt;td&gt;8.540521&lt;/td&gt;
      &lt;td&gt;15.867326&lt;/td&gt;
      &lt;td&gt;648.398899&lt;/td&gt;
      &lt;td&gt;23.526400&lt;/td&gt;
      &lt;td&gt;-83.196863&lt;/td&gt;
      &lt;td&gt;54.726802&lt;/td&gt;
      &lt;td&gt;372.336800&lt;/td&gt;
      &lt;td&gt;1.201987&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;std&lt;/th&gt;
      &lt;td&gt;17097.795209&lt;/td&gt;
      &lt;td&gt;41.665792&lt;/td&gt;
      &lt;td&gt;1.364174&lt;/td&gt;
      &lt;td&gt;8.793432&lt;/td&gt;
      &lt;td&gt;372.376803&lt;/td&gt;
      &lt;td&gt;9.464955&lt;/td&gt;
      &lt;td&gt;37.282152&lt;/td&gt;
      &lt;td&gt;25.133577&lt;/td&gt;
      &lt;td&gt;480.562974&lt;/td&gt;
      &lt;td&gt;0.834497&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;min&lt;/th&gt;
      &lt;td&gt;1.000000&lt;/td&gt;
      &lt;td&gt;1851.000000&lt;/td&gt;
      &lt;td&gt;1.000000&lt;/td&gt;
      &lt;td&gt;1.000000&lt;/td&gt;
      &lt;td&gt;1.000000&lt;/td&gt;
      &lt;td&gt;4.200000&lt;/td&gt;
      &lt;td&gt;-180.000000&lt;/td&gt;
      &lt;td&gt;10.000000&lt;/td&gt;
      &lt;td&gt;0.000000&lt;/td&gt;
      &lt;td&gt;0.000000&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;25%&lt;/th&gt;
      &lt;td&gt;14807.750000&lt;/td&gt;
      &lt;td&gt;1928.000000&lt;/td&gt;
      &lt;td&gt;8.000000&lt;/td&gt;
      &lt;td&gt;8.000000&lt;/td&gt;
      &lt;td&gt;344.000000&lt;/td&gt;
      &lt;td&gt;16.100000&lt;/td&gt;
      &lt;td&gt;-108.500000&lt;/td&gt;
      &lt;td&gt;35.000000&lt;/td&gt;
      &lt;td&gt;0.000000&lt;/td&gt;
      &lt;td&gt;0.707107&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;50%&lt;/th&gt;
      &lt;td&gt;29614.500000&lt;/td&gt;
      &lt;td&gt;1970.000000&lt;/td&gt;
      &lt;td&gt;9.000000&lt;/td&gt;
      &lt;td&gt;16.000000&lt;/td&gt;
      &lt;td&gt;606.000000&lt;/td&gt;
      &lt;td&gt;21.200000&lt;/td&gt;
      &lt;td&gt;-81.200000&lt;/td&gt;
      &lt;td&gt;50.000000&lt;/td&gt;
      &lt;td&gt;0.000000&lt;/td&gt;
      &lt;td&gt;1.029563&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;75%&lt;/th&gt;
      &lt;td&gt;44421.250000&lt;/td&gt;
      &lt;td&gt;1991.000000&lt;/td&gt;
      &lt;td&gt;9.000000&lt;/td&gt;
      &lt;td&gt;23.000000&lt;/td&gt;
      &lt;td&gt;920.000000&lt;/td&gt;
      &lt;td&gt;29.600000&lt;/td&gt;
      &lt;td&gt;-62.200000&lt;/td&gt;
      &lt;td&gt;70.000000&lt;/td&gt;
      &lt;td&gt;990.000000&lt;/td&gt;
      &lt;td&gt;1.431782&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;max&lt;/th&gt;
      &lt;td&gt;59228.000000&lt;/td&gt;
      &lt;td&gt;2008.000000&lt;/td&gt;
      &lt;td&gt;12.000000&lt;/td&gt;
      &lt;td&gt;31.000000&lt;/td&gt;
      &lt;td&gt;1410.000000&lt;/td&gt;
      &lt;td&gt;69.000000&lt;/td&gt;
      &lt;td&gt;180.000000&lt;/td&gt;
      &lt;td&gt;165.000000&lt;/td&gt;
      &lt;td&gt;1024.000000&lt;/td&gt;
      &lt;td&gt;11.180340&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;Fortunately, we have some guidelines from dataquest of how the table should look like:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;fid&lt;/code&gt; is an INT and should be a &lt;code&gt;PRIMARY KEY&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;YEAR, MONTH, DAY&lt;/code&gt; and &lt;code&gt;AD_TIME&lt;/code&gt; should be merged into one single &lt;code&gt;TIMESTAMP&lt;/code&gt;, using &lt;code&gt;TIME ZONE&lt;/code&gt;.&lt;/li&gt;
&lt;li&gt;&lt;code&gt;btid&lt;/code&gt; looks like an &lt;code&gt;INT&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;We have no way of knowing how long a &lt;code&gt;name&lt;/code&gt; can be, thus we will be using a &lt;code&gt;VARCHAR&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;lat&lt;/code&gt; is of type &lt;code&gt;DECIMAL(X,Y)&lt;/code&gt;. We need to figure out &lt;code&gt;X&lt;/code&gt; and &lt;code&gt;Y&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;long&lt;/code&gt; is of type &lt;code&gt;DECIMAL(X,Y)&lt;/code&gt;, We also need to figure out &lt;code&gt;X&lt;/code&gt; and &lt;code&gt;Y&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;wind_kts&lt;/code&gt; looks like an &lt;code&gt;INT&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;pressure&lt;/code&gt; looks like an &lt;code&gt;INT&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;cat&lt;/code&gt; looks like a categorical value, kinda like a &lt;code&gt;VARCHAR(X)&lt;/code&gt;. We need to figure out &lt;code&gt;X&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;basin&lt;/code&gt; is a &lt;code&gt;VARCHAR(X)&lt;/code&gt;. Same as &lt;code&gt;cat&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;shape_length&lt;/code&gt; looks like a &lt;code&gt;DECIMAL(X, Y)&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;The next step is figuring out some variables, like&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;The values of &lt;code&gt;X&lt;/code&gt; and &lt;code&gt;Y&lt;/code&gt; in &lt;code&gt;VARCHAR&lt;/code&gt; and &lt;code&gt;DECIMAL&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;The maximum values of those columns that look like integers. With this we could use even smaller datatypes like &lt;code&gt;SMALLINT&lt;/code&gt; and others.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;We can infer most of these values through inspection of the &lt;code&gt;min&lt;/code&gt; and &lt;code&gt;max&lt;/code&gt; values in &lt;code&gt;df.describe()&lt;/code&gt;. We could then produce a table like this:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;CREATE&lt;/span&gt; &lt;span class="k"&gt;TABLE&lt;/span&gt; &lt;span class="n"&gt;hurricanes&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;
    &lt;span class="n"&gt;fid&lt;/span&gt; &lt;span class="nb"&gt;INT&lt;/span&gt; &lt;span class="k"&gt;PRIMARY&lt;/span&gt; &lt;span class="k"&gt;KEY&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="k"&gt;timestamp&lt;/span&gt; &lt;span class="k"&gt;TIMESTAMP&lt;/span&gt; &lt;span class="k"&gt;WITH&lt;/span&gt; &lt;span class="n"&gt;TIME&lt;/span&gt; &lt;span class="k"&gt;ZONE&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="n"&gt;btid&lt;/span&gt; &lt;span class="nb"&gt;SMALLINT&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="n"&gt;name&lt;/span&gt; &lt;span class="nb"&gt;VARCHAR&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="n"&gt;lat&lt;/span&gt; &lt;span class="nb"&gt;DECIMAL&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;8&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;6&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
    &lt;span class="n"&gt;long&lt;/span&gt; &lt;span class="nb"&gt;DECIMAL&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;9&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;6&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
    &lt;span class="n"&gt;wind_kts&lt;/span&gt; &lt;span class="nb"&gt;SMALLINT&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="n"&gt;pressure&lt;/span&gt; &lt;span class="nb"&gt;SMALLINT&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="n"&gt;cat&lt;/span&gt; &lt;span class="nb"&gt;VARCHAR&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;X&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
    &lt;span class="n"&gt;basin&lt;/span&gt; &lt;span class="nb"&gt;VARCHAR&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;X&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
    &lt;span class="n"&gt;shape_length&lt;/span&gt; &lt;span class="nb"&gt;DECIMAL&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;8&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;6&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;We can infer the values of &lt;code&gt;X&lt;/code&gt; in &lt;code&gt;VARCHAR(X)&lt;/code&gt; by doing something like&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In&amp;nbsp;[6]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;df&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;BASIN&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;str&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;len&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;max&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;

    &lt;div class="prompt output_prompt"&gt;Out[6]:&lt;/div&gt;




&lt;div class="output_text output_subarea output_execute_result"&gt;
&lt;pre&gt;15&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In&amp;nbsp;[7]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;df&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;CAT&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;str&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;len&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;max&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;

    &lt;div class="prompt output_prompt"&gt;Out[7]:&lt;/div&gt;




&lt;div class="output_text output_subarea output_execute_result"&gt;
&lt;pre&gt;2&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;This means that these columns are maximum 15 and 2 characters long. Out table will end looking like&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;CREATE&lt;/span&gt; &lt;span class="k"&gt;TABLE&lt;/span&gt; &lt;span class="n"&gt;hurricanes&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;
    &lt;span class="n"&gt;fid&lt;/span&gt; &lt;span class="nb"&gt;INT&lt;/span&gt; &lt;span class="k"&gt;PRIMARY&lt;/span&gt; &lt;span class="k"&gt;KEY&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="k"&gt;timestamp&lt;/span&gt; &lt;span class="k"&gt;TIMESTAMP&lt;/span&gt; &lt;span class="k"&gt;WITH&lt;/span&gt; &lt;span class="n"&gt;TIME&lt;/span&gt; &lt;span class="k"&gt;ZONE&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="n"&gt;btid&lt;/span&gt; &lt;span class="nb"&gt;SMALLINT&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="n"&gt;name&lt;/span&gt; &lt;span class="nb"&gt;VARCHAR&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="n"&gt;lat&lt;/span&gt; &lt;span class="nb"&gt;DECIMAL&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;8&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;6&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
    &lt;span class="n"&gt;long&lt;/span&gt; &lt;span class="nb"&gt;DECIMAL&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;9&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;6&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
    &lt;span class="n"&gt;wind_kts&lt;/span&gt; &lt;span class="nb"&gt;SMALLINT&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="n"&gt;pressure&lt;/span&gt; &lt;span class="nb"&gt;SMALLINT&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="n"&gt;cat&lt;/span&gt; &lt;span class="nb"&gt;VARCHAR&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
    &lt;span class="n"&gt;basin&lt;/span&gt; &lt;span class="nb"&gt;VARCHAR&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;15&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
    &lt;span class="n"&gt;shape_length&lt;/span&gt; &lt;span class="nb"&gt;DECIMAL&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;8&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;6&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;h2 id="Shaping-data"&gt;Shaping data&lt;a class="anchor-link" href="#Shaping-data"&gt;&amp;#182;&lt;/a&gt;&lt;/h2&gt;&lt;p&gt;From here, we need to&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Clean and check for possible missing values&lt;/li&gt;
&lt;li&gt;Merge &lt;code&gt;year&lt;/code&gt;, &lt;code&gt;month&lt;/code&gt;, &lt;code&gt;day&lt;/code&gt; and &lt;code&gt;ad_time&lt;/code&gt; into one column named &lt;code&gt;timestamp&lt;/code&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;Possible optimizations are&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Using label encoding in categorical columns&lt;/li&gt;
&lt;li&gt;Use better datatypes for specific purposes, like georeferenced values&lt;/li&gt;
&lt;/ol&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;h3 id="Clean-missing-values"&gt;Clean missing values&lt;a class="anchor-link" href="#Clean-missing-values"&gt;&amp;#182;&lt;/a&gt;&lt;/h3&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In&amp;nbsp;[8]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="c1"&gt;# total na numbers&lt;/span&gt;
&lt;span class="n"&gt;df&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;isna&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sum&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;

    &lt;div class="prompt output_prompt"&gt;Out[8]:&lt;/div&gt;




&lt;div class="output_text output_subarea output_execute_result"&gt;
&lt;pre&gt;FID           0
YEAR          0
MONTH         0
DAY           0
AD_TIME       0
BTID          0
NAME          0
LAT           0
LONG          0
WIND_KTS      0
PRESSURE      0
CAT           0
BASIN         0
Shape_Leng    0
dtype: int64&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In&amp;nbsp;[9]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;df&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;isnull&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sum&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;

    &lt;div class="prompt output_prompt"&gt;Out[9]:&lt;/div&gt;




&lt;div class="output_text output_subarea output_execute_result"&gt;
&lt;pre&gt;FID           0
YEAR          0
MONTH         0
DAY           0
AD_TIME       0
BTID          0
NAME          0
LAT           0
LONG          0
WIND_KTS      0
PRESSURE      0
CAT           0
BASIN         0
Shape_Leng    0
dtype: int64&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;Okay, not so much to do here 😌&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;h3 id="Merge-date-columns-into-a-single-one"&gt;Merge date columns into a single one&lt;a class="anchor-link" href="#Merge-date-columns-into-a-single-one"&gt;&amp;#182;&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;We'll be using &lt;code&gt;pd.to_datetime&lt;/code&gt; from &lt;a href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.to_datetime.html"&gt;https://pandas.pydata.org/pandas-docs/stable/generated/pandas.to_datetime.html&lt;/a&gt;&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;We'll need to convert AD_TIME from the current format to a valid datetime&lt;/li&gt;
&lt;/ol&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In&amp;nbsp;[36]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;df&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;AD_TIME&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;head&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;

    &lt;div class="prompt output_prompt"&gt;Out[36]:&lt;/div&gt;




&lt;div class="output_text output_subarea output_execute_result"&gt;
&lt;pre&gt;0    1800Z
1    1200Z
2    0600Z
3    0600Z
4    1200Z
Name: AD_TIME, dtype: object&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;We join everything together in one column, as a dumb string. This is to make the conversion easier afterwards:&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In&amp;nbsp;[37]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;df&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;TIMESTAMP&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;df&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;YEAR&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;astype&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;str&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; \
                  &lt;span class="n"&gt;df&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;MONTH&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;astype&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;str&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;str&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zfill&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; \
                  &lt;span class="n"&gt;df&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;DAY&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;astype&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;str&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;str&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zfill&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; \
                  &lt;span class="n"&gt;df&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;AD_TIME&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In&amp;nbsp;[38]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;df&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;TIMESTAMP&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;head&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;

    &lt;div class="prompt output_prompt"&gt;Out[38]:&lt;/div&gt;




&lt;div class="output_text output_subarea output_execute_result"&gt;
&lt;pre&gt;0    195708081800Z
1    196110031200Z
2    196208290600Z
3    196707140600Z
4    197208161200Z
Name: TIMESTAMP, dtype: object&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;We convert the dumb string column to a valid timestamp object, and we pass a format and we tell pandas that the time is in UTC:&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In&amp;nbsp;[39]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;df&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;TIMESTAMP&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;pd&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;to_datetime&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;df&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;TIMESTAMP&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="nb"&gt;format&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;%Y%m&lt;/span&gt;&lt;span class="si"&gt;%d&lt;/span&gt;&lt;span class="s1"&gt;%H%MZ&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;utc&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kc"&gt;True&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In&amp;nbsp;[40]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;df&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;TIMESTAMP&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;head&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;

    &lt;div class="prompt output_prompt"&gt;Out[40]:&lt;/div&gt;




&lt;div class="output_text output_subarea output_execute_result"&gt;
&lt;pre&gt;0   1957-08-08 18:00:00+00:00
1   1961-10-03 12:00:00+00:00
2   1962-08-29 06:00:00+00:00
3   1967-07-14 06:00:00+00:00
4   1972-08-16 12:00:00+00:00
Name: TIMESTAMP, dtype: datetime64[ns, UTC]&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;We drop the other columns associated with time:&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In&amp;nbsp;[41]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;df&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;df&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;drop&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;YEAR&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;MONTH&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;DAY&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;AD_TIME&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;axis&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In&amp;nbsp;[42]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;df&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;head&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;

    &lt;div class="prompt output_prompt"&gt;Out[42]:&lt;/div&gt;



&lt;div class="output_html rendered_html output_subarea output_execute_result"&gt;
&lt;div&gt;
&lt;style scoped&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
&lt;/style&gt;
&lt;table border="1" class="dataframe"&gt;
  &lt;thead&gt;
    &lt;tr style="text-align: right;"&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;FID&lt;/th&gt;
      &lt;th&gt;BTID&lt;/th&gt;
      &lt;th&gt;NAME&lt;/th&gt;
      &lt;th&gt;LAT&lt;/th&gt;
      &lt;th&gt;LONG&lt;/th&gt;
      &lt;th&gt;WIND_KTS&lt;/th&gt;
      &lt;th&gt;PRESSURE&lt;/th&gt;
      &lt;th&gt;CAT&lt;/th&gt;
      &lt;th&gt;BASIN&lt;/th&gt;
      &lt;th&gt;Shape_Leng&lt;/th&gt;
      &lt;th&gt;TIMESTAMP&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;0&lt;/th&gt;
      &lt;td&gt;2001&lt;/td&gt;
      &lt;td&gt;63&lt;/td&gt;
      &lt;td&gt;NOTNAMED&lt;/td&gt;
      &lt;td&gt;22.5&lt;/td&gt;
      &lt;td&gt;-140.0&lt;/td&gt;
      &lt;td&gt;50&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;TS&lt;/td&gt;
      &lt;td&gt;Eastern Pacific&lt;/td&gt;
      &lt;td&gt;1.140175&lt;/td&gt;
      &lt;td&gt;1957-08-08 18:00:00+00:00&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;1&lt;/th&gt;
      &lt;td&gt;2002&lt;/td&gt;
      &lt;td&gt;116&lt;/td&gt;
      &lt;td&gt;PAULINE&lt;/td&gt;
      &lt;td&gt;22.1&lt;/td&gt;
      &lt;td&gt;-140.2&lt;/td&gt;
      &lt;td&gt;45&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;TS&lt;/td&gt;
      &lt;td&gt;Eastern Pacific&lt;/td&gt;
      &lt;td&gt;1.166190&lt;/td&gt;
      &lt;td&gt;1961-10-03 12:00:00+00:00&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;2&lt;/th&gt;
      &lt;td&gt;2003&lt;/td&gt;
      &lt;td&gt;124&lt;/td&gt;
      &lt;td&gt;C&lt;/td&gt;
      &lt;td&gt;18.0&lt;/td&gt;
      &lt;td&gt;-140.0&lt;/td&gt;
      &lt;td&gt;45&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;TS&lt;/td&gt;
      &lt;td&gt;Eastern Pacific&lt;/td&gt;
      &lt;td&gt;2.102380&lt;/td&gt;
      &lt;td&gt;1962-08-29 06:00:00+00:00&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;3&lt;/th&gt;
      &lt;td&gt;2004&lt;/td&gt;
      &lt;td&gt;168&lt;/td&gt;
      &lt;td&gt;DENISE&lt;/td&gt;
      &lt;td&gt;16.6&lt;/td&gt;
      &lt;td&gt;-139.5&lt;/td&gt;
      &lt;td&gt;45&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;TS&lt;/td&gt;
      &lt;td&gt;Eastern Pacific&lt;/td&gt;
      &lt;td&gt;2.121320&lt;/td&gt;
      &lt;td&gt;1967-07-14 06:00:00+00:00&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;4&lt;/th&gt;
      &lt;td&gt;2005&lt;/td&gt;
      &lt;td&gt;251&lt;/td&gt;
      &lt;td&gt;DIANA&lt;/td&gt;
      &lt;td&gt;18.5&lt;/td&gt;
      &lt;td&gt;-139.8&lt;/td&gt;
      &lt;td&gt;70&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;H1&lt;/td&gt;
      &lt;td&gt;Eastern Pacific&lt;/td&gt;
      &lt;td&gt;1.702939&lt;/td&gt;
      &lt;td&gt;1972-08-16 12:00:00+00:00&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;h3 id="Further-optimizations"&gt;Further optimizations&lt;a class="anchor-link" href="#Further-optimizations"&gt;&amp;#182;&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;These are valid for those columns that are clearly categorical, &lt;code&gt;CAT&lt;/code&gt; and &lt;code&gt;BASIN&lt;/code&gt;. We could encode this columns using &lt;em&gt;label encoding&lt;/em&gt; which would allow us to store integers instead of long strings.&lt;/p&gt;
&lt;p&gt;We could create another table that stores the meanings of the codes, this is more or less called a &lt;em&gt;one to one&lt;/em&gt; relationship and it is discussed in here&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="https://stackoverflow.com/questions/12318870/when-i-should-use-one-to-one-relationship"&gt;https://stackoverflow.com/questions/12318870/when-i-should-use-one-to-one-relationship&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;and here &lt;a href="https://www.postgresql.org/message-id/flat/BB6A4899.9385D%25soft%40bdanube.com"&gt;https://www.postgresql.org/message-id/flat/BB6A4899.9385D%25soft%40bdanube.com&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;The pros and cons of this approach are&lt;/p&gt;
&lt;p&gt;Pros&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;It's more efficient to store and query integer values&lt;/li&gt;
&lt;li&gt;We could create auxiliar tables that map the labels to their meanings, thus allowing for more atomic queries&lt;/li&gt;
&lt;li&gt;This would allow for good normalizations practices that will help in scaling our database (and keeping it sane to maintain)&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Cons&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Integers lose any semantic meaning without a conversion table&lt;/li&gt;
&lt;li&gt;Adding semantic meaning from an auxiliar table requires a &lt;code&gt;JOIN&lt;/code&gt; operation, which is costly&lt;/li&gt;
&lt;li&gt;It requires a bit more of effort&lt;/li&gt;
&lt;li&gt;It could happen that the column is not categorical at all (i.e. more different values for BASIN show up in the future) &lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;We will not use this approach since it beats the purpose of the problem, and for this case is overkill since each category does not have or need a full model by itself, since it would consist of only one attribute. We'll keep it simple.&lt;/p&gt;
&lt;p&gt;&lt;a href="https://dba.stackexchange.com/a/15405"&gt;This Stackoverflow question&lt;/a&gt; deals with normalization on &lt;em&gt;one-to-one&lt;/em&gt; relationships:&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;If it fits within the rules of normalization, then 1:1 relationships can be normalized (by definition!) - In other words, there is nothing about 1:1 relationships that make it impossible for them to obey the normal forms.&lt;/p&gt;
&lt;p&gt;To answer your question about the practicality of 1:1 relationships, there are times when this is a perfectly useful construct, such as when you have subtypes with distinct predicates (columns).&lt;/p&gt;
&lt;p&gt;The reasons you would use 1:1 relationships depend on your point of view. DBAs tend to think of everything as being a performance decision. Data modelers and programmers tend to think of these decisions as being design or model oriented. In fact, there is a lot of overlap between these points of view. It depends on what your perspectives and priorities are. Here are some examples of motivations for 1:1 relationships:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;You have some subset of columns that are very wide and you want to segregate them physically in your storage for performance reasons.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;You have some subset of columns that are not read or updated frequently and you want to keep them apart from the frequently used columns for performance reasons.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;You have some columns that are optional in general but they are mandatory when you know that the record is of a certain type.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;You have some columns that logically belong together for a subtype and you want to model them to fit well with your code's object model.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;You have some columns that can only apply to some subtype(s) of an entity super-type, and you want your schema to enforce the absence of this data for other subtypes.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;You have some columns that belong to an entity but you need to protect these particular columns using more restrictive access rules (e.g. salary on an employee table).&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;So you can see, sometimes the driver is performance, sometimes it is model purity, or just a desire to take full advantage of declarative schema rules.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;We could even push this further and say that the &lt;code&gt;BASIN&lt;/code&gt; column is more of a &lt;em&gt;boolean&lt;/em&gt; value since it has two values max. This allows us to rewrite the column in something like &lt;code&gt;IS_BASIN_EASTERN_PACIFIC&lt;/code&gt;. We could say then that for those values where this is &lt;code&gt;False&lt;/code&gt; then it means the Basin it's &lt;code&gt;North Atlantic&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;But this is &lt;em&gt;never&lt;/em&gt; a good approach since it uses this information implicitly (thus hidden, and we don't want hidden stuff!), plus this will break the second a new category shows up.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In&amp;nbsp;[43]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;df&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;BASIN&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;astype&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;category&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;cat&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;codes&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;unique&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;

    &lt;div class="prompt output_prompt"&gt;Out[43]:&lt;/div&gt;




&lt;div class="output_text output_subarea output_execute_result"&gt;
&lt;pre&gt;array([0, 1])&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In&amp;nbsp;[44]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;df&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;CAT&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;astype&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;category&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;cat&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;codes&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;unique&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;

    &lt;div class="prompt output_prompt"&gt;Out[44]:&lt;/div&gt;




&lt;div class="output_text output_subarea output_execute_result"&gt;
&lt;pre&gt;array([10,  1,  9,  3,  2,  6,  4,  5,  0, 11,  8,  7])&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In&amp;nbsp;[46]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;df&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;columns&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;df&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;columns&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;str&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;upper&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In&amp;nbsp;[47]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;df&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;head&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;

    &lt;div class="prompt output_prompt"&gt;Out[47]:&lt;/div&gt;



&lt;div class="output_html rendered_html output_subarea output_execute_result"&gt;
&lt;div&gt;
&lt;style scoped&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
&lt;/style&gt;
&lt;table border="1" class="dataframe"&gt;
  &lt;thead&gt;
    &lt;tr style="text-align: right;"&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;FID&lt;/th&gt;
      &lt;th&gt;BTID&lt;/th&gt;
      &lt;th&gt;NAME&lt;/th&gt;
      &lt;th&gt;LAT&lt;/th&gt;
      &lt;th&gt;LONG&lt;/th&gt;
      &lt;th&gt;WIND_KTS&lt;/th&gt;
      &lt;th&gt;PRESSURE&lt;/th&gt;
      &lt;th&gt;CAT&lt;/th&gt;
      &lt;th&gt;BASIN&lt;/th&gt;
      &lt;th&gt;SHAPE_LENG&lt;/th&gt;
      &lt;th&gt;TIMESTAMP&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;0&lt;/th&gt;
      &lt;td&gt;2001&lt;/td&gt;
      &lt;td&gt;63&lt;/td&gt;
      &lt;td&gt;NOTNAMED&lt;/td&gt;
      &lt;td&gt;22.5&lt;/td&gt;
      &lt;td&gt;-140.0&lt;/td&gt;
      &lt;td&gt;50&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;TS&lt;/td&gt;
      &lt;td&gt;Eastern Pacific&lt;/td&gt;
      &lt;td&gt;1.140175&lt;/td&gt;
      &lt;td&gt;1957-08-08 18:00:00+00:00&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;1&lt;/th&gt;
      &lt;td&gt;2002&lt;/td&gt;
      &lt;td&gt;116&lt;/td&gt;
      &lt;td&gt;PAULINE&lt;/td&gt;
      &lt;td&gt;22.1&lt;/td&gt;
      &lt;td&gt;-140.2&lt;/td&gt;
      &lt;td&gt;45&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;TS&lt;/td&gt;
      &lt;td&gt;Eastern Pacific&lt;/td&gt;
      &lt;td&gt;1.166190&lt;/td&gt;
      &lt;td&gt;1961-10-03 12:00:00+00:00&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;2&lt;/th&gt;
      &lt;td&gt;2003&lt;/td&gt;
      &lt;td&gt;124&lt;/td&gt;
      &lt;td&gt;C&lt;/td&gt;
      &lt;td&gt;18.0&lt;/td&gt;
      &lt;td&gt;-140.0&lt;/td&gt;
      &lt;td&gt;45&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;TS&lt;/td&gt;
      &lt;td&gt;Eastern Pacific&lt;/td&gt;
      &lt;td&gt;2.102380&lt;/td&gt;
      &lt;td&gt;1962-08-29 06:00:00+00:00&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;3&lt;/th&gt;
      &lt;td&gt;2004&lt;/td&gt;
      &lt;td&gt;168&lt;/td&gt;
      &lt;td&gt;DENISE&lt;/td&gt;
      &lt;td&gt;16.6&lt;/td&gt;
      &lt;td&gt;-139.5&lt;/td&gt;
      &lt;td&gt;45&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;TS&lt;/td&gt;
      &lt;td&gt;Eastern Pacific&lt;/td&gt;
      &lt;td&gt;2.121320&lt;/td&gt;
      &lt;td&gt;1967-07-14 06:00:00+00:00&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;4&lt;/th&gt;
      &lt;td&gt;2005&lt;/td&gt;
      &lt;td&gt;251&lt;/td&gt;
      &lt;td&gt;DIANA&lt;/td&gt;
      &lt;td&gt;18.5&lt;/td&gt;
      &lt;td&gt;-139.8&lt;/td&gt;
      &lt;td&gt;70&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;H1&lt;/td&gt;
      &lt;td&gt;Eastern Pacific&lt;/td&gt;
      &lt;td&gt;1.702939&lt;/td&gt;
      &lt;td&gt;1972-08-16 12:00:00+00:00&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;We look back at our table, and we rearrange the columns in the dataframe to match this table&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;fid&lt;/span&gt; &lt;span class="nb"&gt;INT&lt;/span&gt; &lt;span class="k"&gt;PRIMARY&lt;/span&gt; &lt;span class="k"&gt;KEY&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="k"&gt;timestamp&lt;/span&gt; &lt;span class="k"&gt;TIMESTAMP&lt;/span&gt; &lt;span class="k"&gt;WITH&lt;/span&gt; &lt;span class="n"&gt;TIME&lt;/span&gt; &lt;span class="k"&gt;ZONE&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="n"&gt;btid&lt;/span&gt; &lt;span class="nb"&gt;SMALLINT&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="n"&gt;name&lt;/span&gt; &lt;span class="nb"&gt;VARCHAR&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="n"&gt;lat&lt;/span&gt; &lt;span class="nb"&gt;DECIMAL&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;8&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;6&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
&lt;span class="n"&gt;long&lt;/span&gt; &lt;span class="nb"&gt;DECIMAL&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;9&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;6&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
&lt;span class="n"&gt;wind_kts&lt;/span&gt; &lt;span class="nb"&gt;SMALLINT&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="n"&gt;pressure&lt;/span&gt; &lt;span class="nb"&gt;SMALLINT&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="n"&gt;cat&lt;/span&gt; &lt;span class="nb"&gt;VARCHAR&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
&lt;span class="n"&gt;basin&lt;/span&gt; &lt;span class="nb"&gt;VARCHAR&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;16&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
&lt;span class="n"&gt;shape_length&lt;/span&gt; &lt;span class="nb"&gt;DECIMAL&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;7&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;6&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In&amp;nbsp;[48]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="c1"&gt;# we rearrange our columns and reset the dataframe&amp;#39;s index&lt;/span&gt;
&lt;span class="n"&gt;df_csv&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;df&lt;/span&gt;&lt;span class="p"&gt;[[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;FID&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;TIMESTAMP&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;BTID&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;NAME&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;LAT&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;LONG&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;WIND_KTS&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;PRESSURE&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;CAT&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;BASIN&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;SHAPE_LENG&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;copy&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="n"&gt;df_csv&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;df_csv&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_index&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;FID&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;drop&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kc"&gt;True&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;df_csv&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;head&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;

    &lt;div class="prompt output_prompt"&gt;Out[48]:&lt;/div&gt;



&lt;div class="output_html rendered_html output_subarea output_execute_result"&gt;
&lt;div&gt;
&lt;style scoped&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
&lt;/style&gt;
&lt;table border="1" class="dataframe"&gt;
  &lt;thead&gt;
    &lt;tr style="text-align: right;"&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;TIMESTAMP&lt;/th&gt;
      &lt;th&gt;BTID&lt;/th&gt;
      &lt;th&gt;NAME&lt;/th&gt;
      &lt;th&gt;LAT&lt;/th&gt;
      &lt;th&gt;LONG&lt;/th&gt;
      &lt;th&gt;WIND_KTS&lt;/th&gt;
      &lt;th&gt;PRESSURE&lt;/th&gt;
      &lt;th&gt;CAT&lt;/th&gt;
      &lt;th&gt;BASIN&lt;/th&gt;
      &lt;th&gt;SHAPE_LENG&lt;/th&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;FID&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;2001&lt;/th&gt;
      &lt;td&gt;1957-08-08 18:00:00+00:00&lt;/td&gt;
      &lt;td&gt;63&lt;/td&gt;
      &lt;td&gt;NOTNAMED&lt;/td&gt;
      &lt;td&gt;22.5&lt;/td&gt;
      &lt;td&gt;-140.0&lt;/td&gt;
      &lt;td&gt;50&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;TS&lt;/td&gt;
      &lt;td&gt;Eastern Pacific&lt;/td&gt;
      &lt;td&gt;1.140175&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;2002&lt;/th&gt;
      &lt;td&gt;1961-10-03 12:00:00+00:00&lt;/td&gt;
      &lt;td&gt;116&lt;/td&gt;
      &lt;td&gt;PAULINE&lt;/td&gt;
      &lt;td&gt;22.1&lt;/td&gt;
      &lt;td&gt;-140.2&lt;/td&gt;
      &lt;td&gt;45&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;TS&lt;/td&gt;
      &lt;td&gt;Eastern Pacific&lt;/td&gt;
      &lt;td&gt;1.166190&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;2003&lt;/th&gt;
      &lt;td&gt;1962-08-29 06:00:00+00:00&lt;/td&gt;
      &lt;td&gt;124&lt;/td&gt;
      &lt;td&gt;C&lt;/td&gt;
      &lt;td&gt;18.0&lt;/td&gt;
      &lt;td&gt;-140.0&lt;/td&gt;
      &lt;td&gt;45&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;TS&lt;/td&gt;
      &lt;td&gt;Eastern Pacific&lt;/td&gt;
      &lt;td&gt;2.102380&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;2004&lt;/th&gt;
      &lt;td&gt;1967-07-14 06:00:00+00:00&lt;/td&gt;
      &lt;td&gt;168&lt;/td&gt;
      &lt;td&gt;DENISE&lt;/td&gt;
      &lt;td&gt;16.6&lt;/td&gt;
      &lt;td&gt;-139.5&lt;/td&gt;
      &lt;td&gt;45&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;TS&lt;/td&gt;
      &lt;td&gt;Eastern Pacific&lt;/td&gt;
      &lt;td&gt;2.121320&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;2005&lt;/th&gt;
      &lt;td&gt;1972-08-16 12:00:00+00:00&lt;/td&gt;
      &lt;td&gt;251&lt;/td&gt;
      &lt;td&gt;DIANA&lt;/td&gt;
      &lt;td&gt;18.5&lt;/td&gt;
      &lt;td&gt;-139.8&lt;/td&gt;
      &lt;td&gt;70&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;H1&lt;/td&gt;
      &lt;td&gt;Eastern Pacific&lt;/td&gt;
      &lt;td&gt;1.702939&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;We'll save our ammended csv somewhere else to be used later&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In&amp;nbsp;[49]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;df_csv&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;to_csv&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;path_or_buf&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;data/cleaned_files.csv&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;sep&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;;&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;h2 id="Creating-the-table-with-SQL"&gt;Creating the table with SQL&lt;a class="anchor-link" href="#Creating-the-table-with-SQL"&gt;&amp;#182;&lt;/a&gt;&lt;/h2&gt;&lt;p&gt;Next step is &lt;em&gt;actually&lt;/em&gt; creating the table&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In&amp;nbsp;[3]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;psycopg2&lt;/span&gt;

&lt;span class="n"&gt;conn&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;psycopg2&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;connect&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;
    &lt;span class="n"&gt;dbname&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;ihw&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;user&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;data_prod_user&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;password&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;changeme&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;host&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;192.168.32.3&amp;quot;&lt;/span&gt;
&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="n"&gt;conn&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;autocommit&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="kc"&gt;True&lt;/span&gt;
&lt;span class="n"&gt;cur&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;conn&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;cursor&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;

&lt;span class="c1"&gt;# year, month, day, ad_time will be stored as timestampz&lt;/span&gt;
&lt;span class="nb"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;DROP TABLE IF EXISTS hurricanes&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;cur&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;execute&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;DROP TABLE IF EXISTS hurricanes&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="n"&gt;CREATE_TABLE_SQL&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
&lt;span class="s2"&gt;CREATE TABLE hurricanes (&lt;/span&gt;
&lt;span class="s2"&gt;    fid INT PRIMARY KEY,&lt;/span&gt;
&lt;span class="s2"&gt;    timestamp TIMESTAMP WITH TIME ZONE,&lt;/span&gt;
&lt;span class="s2"&gt;    btid SMALLINT,&lt;/span&gt;
&lt;span class="s2"&gt;    name VARCHAR,&lt;/span&gt;
&lt;span class="s2"&gt;    lat DECIMAL(8,6),&lt;/span&gt;
&lt;span class="s2"&gt;    long DECIMAL(9,6),&lt;/span&gt;
&lt;span class="s2"&gt;    wind_kts SMALLINT,&lt;/span&gt;
&lt;span class="s2"&gt;    pressure SMALLINT,&lt;/span&gt;
&lt;span class="s2"&gt;    cat VARCHAR(2),&lt;/span&gt;
&lt;span class="s2"&gt;    basin VARCHAR(16),&lt;/span&gt;
&lt;span class="s2"&gt;    shape_length DECIMAL(8, 6)&lt;/span&gt;
&lt;span class="s2"&gt;    )&lt;/span&gt;
&lt;span class="s2"&gt;&amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;

&lt;span class="nb"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;CREATE_TABLE_SQL&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="n"&gt;cur&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;execute&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;
    &lt;span class="n"&gt;CREATE_TABLE_SQL&lt;/span&gt;
&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="n"&gt;conn&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;commit&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="nb"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;Done.&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;conn&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;close&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;

    &lt;div class="prompt"&gt;&lt;/div&gt;


&lt;div class="output_subarea output_stream output_stdout output_text"&gt;
&lt;pre&gt;DROP TABLE IF EXISTS hurricanes

CREATE TABLE hurricanes (
    fid INT PRIMARY KEY,
    timestamp TIMESTAMP WITH TIME ZONE,
    btid SMALLINT,
    name VARCHAR,
    lat DECIMAL(8,6),
    long DECIMAL(9,6),
    wind_kts SMALLINT,
    pressure SMALLINT,
    cat VARCHAR(2),
    basin VARCHAR(16),
    shape_length DECIMAL(8, 6)
    )

Done.
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;h2 id="Insert-the-data-in-the-database"&gt;Insert the data in the database&lt;a class="anchor-link" href="#Insert-the-data-in-the-database"&gt;&amp;#182;&lt;/a&gt;&lt;/h2&gt;&lt;p&gt;Assuming we have the CSV available in disk, we can load it onto the table using &lt;code&gt;psycopg&lt;/code&gt;'s &lt;code&gt;copy_expert()&lt;/code&gt;&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In&amp;nbsp;[4]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;psycopg2&lt;/span&gt;

&lt;span class="n"&gt;conn&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;psycopg2&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;connect&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;
    &lt;span class="n"&gt;dbname&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;ihw&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;user&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;data_prod_user&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;password&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;changeme&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;host&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;192.168.32.3&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="n"&gt;conn&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;autocommit&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="kc"&gt;True&lt;/span&gt;
&lt;span class="n"&gt;cur&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;conn&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;cursor&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;

&lt;span class="k"&gt;with&lt;/span&gt; &lt;span class="nb"&gt;open&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;data/cleaned_files.csv&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;r+&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="n"&gt;cur&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;copy_expert&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;COPY hurricanes FROM STDIN WITH CSV HEADER DELIMITER &amp;#39;;&amp;#39;&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    
&lt;span class="n"&gt;conn&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;close&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;h1 id="Grant-specific-privileges-between-users-and-tables"&gt;Grant specific privileges between users and tables&lt;a class="anchor-link" href="#Grant-specific-privileges-between-users-and-tables"&gt;&amp;#182;&lt;/a&gt;&lt;/h1&gt;&lt;p&gt;With our users and our table ready, we need to restrict the privileges some users have. This is so we can avoid unfortunate events like undesired &lt;code&gt;DELETE&lt;/code&gt; or &lt;code&gt;DROP&lt;/code&gt; instructions. Accidents happen.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In&amp;nbsp;[17]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;psycopg2&lt;/span&gt;

&lt;span class="n"&gt;conn&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;psycopg2&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;connect&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;
    &lt;span class="n"&gt;dbname&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;ihw&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;user&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;postgres&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;password&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;postgres&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;host&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;192.168.32.3&amp;quot;&lt;/span&gt;
&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="n"&gt;conn&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;autocommit&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="kc"&gt;True&lt;/span&gt;
&lt;span class="n"&gt;cur&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;conn&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;cursor&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;

&lt;span class="c1"&gt;# revoke all privileges and add back specific ones&lt;/span&gt;
&lt;span class="c1"&gt;# on user data_prod_user&lt;/span&gt;
&lt;span class="n"&gt;cur&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;execute&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;REVOKE ALL ON hurricanes FROM data_prod_user&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;cur&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;execute&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;GRANT SELECT, INSERT, UPDATE ON hurricanes TO data_prod_user&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="c1"&gt;# on group readonly&lt;/span&gt;
&lt;span class="n"&gt;cur&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;execute&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;REVOKE ALL ON hurricanes FROM readonly&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;cur&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;execute&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;GRANT SELECT ON hurricanes TO readonly&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="n"&gt;conn&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;commit&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="nb"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;Done.&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;conn&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;close&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;

    &lt;div class="prompt"&gt;&lt;/div&gt;


&lt;div class="output_subarea output_stream output_stdout output_text"&gt;
&lt;pre&gt;Done.
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;h2 id="Verify-permissions-and-roles"&gt;Verify permissions and roles&lt;a class="anchor-link" href="#Verify-permissions-and-roles"&gt;&amp;#182;&lt;/a&gt;&lt;/h2&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;h3 id="As-postgres-user"&gt;As &lt;code&gt;postgres&lt;/code&gt; user&lt;a class="anchor-link" href="#As-postgres-user"&gt;&amp;#182;&lt;/a&gt;&lt;/h3&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In&amp;nbsp;[6]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;psycopg2&lt;/span&gt;

&lt;span class="n"&gt;conn&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;psycopg2&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;connect&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;
    &lt;span class="n"&gt;dbname&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;ihw&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;user&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;postgres&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;password&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;postgres&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;host&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;192.168.32.3&amp;quot;&lt;/span&gt;
&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="n"&gt;conn&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;autocommit&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="kc"&gt;True&lt;/span&gt;
&lt;span class="n"&gt;cur&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;conn&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;cursor&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="n"&gt;cur&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;execute&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;SELECT * FROM hurricanes LIMIT 1&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="nb"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;cur&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;fetchall&lt;/span&gt;&lt;span class="p"&gt;())&lt;/span&gt;

&lt;span class="n"&gt;conn&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;close&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;

    &lt;div class="prompt"&gt;&lt;/div&gt;


&lt;div class="output_subarea output_stream output_stdout output_text"&gt;
&lt;pre&gt;[(2001, datetime.datetime(1957, 8, 8, 18, 0, tzinfo=psycopg2.tz.FixedOffsetTimezone(offset=0, name=None)), 63, &amp;#39;NOTNAMED&amp;#39;, Decimal(&amp;#39;22.500000&amp;#39;), Decimal(&amp;#39;-140.000000&amp;#39;), 50, 0, &amp;#39;TS&amp;#39;, &amp;#39;Eastern Pacific&amp;#39;, Decimal(&amp;#39;1.140175&amp;#39;))]
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;h3 id="As-data_prod_user"&gt;As &lt;code&gt;data_prod_user&lt;/code&gt;&lt;a class="anchor-link" href="#As-data_prod_user"&gt;&amp;#182;&lt;/a&gt;&lt;/h3&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In&amp;nbsp;[19]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;psycopg2&lt;/span&gt;

&lt;span class="n"&gt;conn&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;psycopg2&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;connect&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;
    &lt;span class="n"&gt;dbname&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;ihw&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;user&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;data_prod_user&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;password&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;changeme&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;host&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;192.168.32.3&amp;quot;&lt;/span&gt;
&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="n"&gt;conn&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;autocommit&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="kc"&gt;True&lt;/span&gt;
&lt;span class="n"&gt;cur&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;conn&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;cursor&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;

&lt;span class="n"&gt;cur&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;execute&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;SELECT * FROM hurricanes LIMIT 1&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;cur&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;fetchall&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;

    &lt;div class="prompt output_prompt"&gt;Out[19]:&lt;/div&gt;




&lt;div class="output_text output_subarea output_execute_result"&gt;
&lt;pre&gt;[(2001,
  datetime.datetime(1957, 8, 8, 18, 0, tzinfo=psycopg2.tz.FixedOffsetTimezone(offset=0, name=None)),
  63,
  &amp;#39;NOTNAMED&amp;#39;,
  Decimal(&amp;#39;22.500000&amp;#39;),
  Decimal(&amp;#39;-140.000000&amp;#39;),
  50,
  0,
  &amp;#39;TS&amp;#39;,
  &amp;#39;Eastern Pacific&amp;#39;,
  Decimal(&amp;#39;1.140175&amp;#39;))]&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In&amp;nbsp;[22]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="c1"&gt;# we should be able to insert data&lt;/span&gt;
&lt;span class="n"&gt;cur&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;execute&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;INSERT INTO hurricanes (fid) values (1000001)&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;conn&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;commit&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In&amp;nbsp;[25]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="c1"&gt;# we can read this new row from the table&lt;/span&gt;
&lt;span class="n"&gt;cur&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;execute&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;SELECT * FROM hurricanes WHERE fid = 1000001&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;cur&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;fetchall&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;

    &lt;div class="prompt output_prompt"&gt;Out[25]:&lt;/div&gt;




&lt;div class="output_text output_subarea output_execute_result"&gt;
&lt;pre&gt;[(1000001, None, None, None, None, None, None, None, None, None, None)]&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In&amp;nbsp;[26]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="c1"&gt;# but we should not be able to delete data&lt;/span&gt;
&lt;span class="n"&gt;cur&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;execute&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;DELETE FROM hurricanes WHERE fid=1000000&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;conn&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;commit&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;

    &lt;div class="prompt"&gt;&lt;/div&gt;


&lt;div class="output_subarea output_text output_error"&gt;
&lt;pre&gt;
&lt;span class="ansi-red-fg"&gt;---------------------------------------------------------------------------&lt;/span&gt;
&lt;span class="ansi-red-fg"&gt;ProgrammingError&lt;/span&gt;                          Traceback (most recent call last)
&lt;span class="ansi-green-fg"&gt;&amp;lt;ipython-input-26-06d32ae504fc&amp;gt;&lt;/span&gt; in &lt;span class="ansi-cyan-fg"&gt;&amp;lt;module&amp;gt;&lt;/span&gt;
&lt;span class="ansi-green-intense-fg ansi-bold"&gt;      1&lt;/span&gt; &lt;span class="ansi-red-fg"&gt;# but we should not be able to delete data&lt;/span&gt;
&lt;span class="ansi-green-fg"&gt;----&amp;gt; 2&lt;/span&gt;&lt;span class="ansi-red-fg"&gt; &lt;/span&gt;cur&lt;span class="ansi-blue-fg"&gt;.&lt;/span&gt;execute&lt;span class="ansi-blue-fg"&gt;(&lt;/span&gt;&lt;span class="ansi-blue-fg"&gt;&amp;#39;DELETE FROM hurricanes WHERE fid=1000000&amp;#39;&lt;/span&gt;&lt;span class="ansi-blue-fg"&gt;)&lt;/span&gt;
&lt;span class="ansi-green-intense-fg ansi-bold"&gt;      3&lt;/span&gt; conn&lt;span class="ansi-blue-fg"&gt;.&lt;/span&gt;commit&lt;span class="ansi-blue-fg"&gt;(&lt;/span&gt;&lt;span class="ansi-blue-fg"&gt;)&lt;/span&gt;

&lt;span class="ansi-red-fg"&gt;ProgrammingError&lt;/span&gt;: permission denied for relation hurricanes
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In&amp;nbsp;[28]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;cur&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;execute&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;UPDATE hurricanes SET name = &amp;#39;fakename&amp;#39; WHERE fid=1000001&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;conn&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;commit&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In&amp;nbsp;[30]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="c1"&gt;# we read the updated changes back&lt;/span&gt;
&lt;span class="n"&gt;cur&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;execute&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;SELECT * FROM hurricanes WHERE fid = 1000001&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;cur&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;fetchall&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;

    &lt;div class="prompt output_prompt"&gt;Out[30]:&lt;/div&gt;




&lt;div class="output_text output_subarea output_execute_result"&gt;
&lt;pre&gt;[(1000001, None, None, &amp;#39;fakename&amp;#39;, None, None, None, None, None, None, None)]&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In&amp;nbsp;[31]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;conn&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;close&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;h3 id="Checking-permissions-as-analyst1"&gt;Checking permissions as &lt;code&gt;analyst1&lt;/code&gt;&lt;a class="anchor-link" href="#Checking-permissions-as-analyst1"&gt;&amp;#182;&lt;/a&gt;&lt;/h3&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In&amp;nbsp;[32]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;psycopg2&lt;/span&gt;

&lt;span class="n"&gt;conn&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;psycopg2&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;connect&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;
    &lt;span class="n"&gt;dbname&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;ihw&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;user&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;analyst1&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;password&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;changeme&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;host&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;192.168.32.3&amp;quot;&lt;/span&gt;
&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="n"&gt;conn&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;autocommit&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="kc"&gt;True&lt;/span&gt;
&lt;span class="n"&gt;cur&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;conn&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;cursor&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;

&lt;span class="n"&gt;cur&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;execute&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;SELECT * FROM hurricanes LIMIT 1&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;cur&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;fetchall&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;

    &lt;div class="prompt output_prompt"&gt;Out[32]:&lt;/div&gt;




&lt;div class="output_text output_subarea output_execute_result"&gt;
&lt;pre&gt;[(2001,
  datetime.datetime(1957, 8, 8, 18, 0, tzinfo=psycopg2.tz.FixedOffsetTimezone(offset=0, name=None)),
  63,
  &amp;#39;NOTNAMED&amp;#39;,
  Decimal(&amp;#39;22.500000&amp;#39;),
  Decimal(&amp;#39;-140.000000&amp;#39;),
  50,
  0,
  &amp;#39;TS&amp;#39;,
  &amp;#39;Eastern Pacific&amp;#39;,
  Decimal(&amp;#39;1.140175&amp;#39;))]&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In&amp;nbsp;[33]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="c1"&gt;# we should be able to insert data&lt;/span&gt;
&lt;span class="n"&gt;cur&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;execute&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;INSERT INTO hurricanes (fid) values (1000001)&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;conn&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;commit&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;

    &lt;div class="prompt"&gt;&lt;/div&gt;


&lt;div class="output_subarea output_text output_error"&gt;
&lt;pre&gt;
&lt;span class="ansi-red-fg"&gt;---------------------------------------------------------------------------&lt;/span&gt;
&lt;span class="ansi-red-fg"&gt;ProgrammingError&lt;/span&gt;                          Traceback (most recent call last)
&lt;span class="ansi-green-fg"&gt;&amp;lt;ipython-input-33-afc5d0bde908&amp;gt;&lt;/span&gt; in &lt;span class="ansi-cyan-fg"&gt;&amp;lt;module&amp;gt;&lt;/span&gt;
&lt;span class="ansi-green-intense-fg ansi-bold"&gt;      1&lt;/span&gt; &lt;span class="ansi-red-fg"&gt;# we should be able to insert data&lt;/span&gt;
&lt;span class="ansi-green-fg"&gt;----&amp;gt; 2&lt;/span&gt;&lt;span class="ansi-red-fg"&gt; &lt;/span&gt;cur&lt;span class="ansi-blue-fg"&gt;.&lt;/span&gt;execute&lt;span class="ansi-blue-fg"&gt;(&lt;/span&gt;&lt;span class="ansi-blue-fg"&gt;&amp;#39;INSERT INTO hurricanes (fid) values (1000001)&amp;#39;&lt;/span&gt;&lt;span class="ansi-blue-fg"&gt;)&lt;/span&gt;
&lt;span class="ansi-green-intense-fg ansi-bold"&gt;      3&lt;/span&gt; conn&lt;span class="ansi-blue-fg"&gt;.&lt;/span&gt;commit&lt;span class="ansi-blue-fg"&gt;(&lt;/span&gt;&lt;span class="ansi-blue-fg"&gt;)&lt;/span&gt;

&lt;span class="ansi-red-fg"&gt;ProgrammingError&lt;/span&gt;: permission denied for relation hurricanes
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In&amp;nbsp;[34]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;cur&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;execute&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;UPDATE hurricanes SET name = &amp;#39;fakename&amp;#39; WHERE fid=1000001&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;conn&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;commit&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;

    &lt;div class="prompt"&gt;&lt;/div&gt;


&lt;div class="output_subarea output_text output_error"&gt;
&lt;pre&gt;
&lt;span class="ansi-red-fg"&gt;---------------------------------------------------------------------------&lt;/span&gt;
&lt;span class="ansi-red-fg"&gt;ProgrammingError&lt;/span&gt;                          Traceback (most recent call last)
&lt;span class="ansi-green-fg"&gt;&amp;lt;ipython-input-34-b52c899b5a8c&amp;gt;&lt;/span&gt; in &lt;span class="ansi-cyan-fg"&gt;&amp;lt;module&amp;gt;&lt;/span&gt;
&lt;span class="ansi-green-fg"&gt;----&amp;gt; 1&lt;/span&gt;&lt;span class="ansi-red-fg"&gt; &lt;/span&gt;cur&lt;span class="ansi-blue-fg"&gt;.&lt;/span&gt;execute&lt;span class="ansi-blue-fg"&gt;(&lt;/span&gt;&lt;span class="ansi-blue-fg"&gt;&amp;#34;UPDATE hurricanes SET name = &amp;#39;fakename&amp;#39; WHERE fid=1000001&amp;#34;&lt;/span&gt;&lt;span class="ansi-blue-fg"&gt;)&lt;/span&gt;
&lt;span class="ansi-green-intense-fg ansi-bold"&gt;      2&lt;/span&gt; conn&lt;span class="ansi-blue-fg"&gt;.&lt;/span&gt;commit&lt;span class="ansi-blue-fg"&gt;(&lt;/span&gt;&lt;span class="ansi-blue-fg"&gt;)&lt;/span&gt;

&lt;span class="ansi-red-fg"&gt;ProgrammingError&lt;/span&gt;: permission denied for relation hurricanes
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In&amp;nbsp;[35]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="c1"&gt;# but we should not be able to delete data&lt;/span&gt;
&lt;span class="n"&gt;cur&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;execute&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;DELETE FROM hurricanes WHERE fid=1000000&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;conn&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;commit&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;

    &lt;div class="prompt"&gt;&lt;/div&gt;


&lt;div class="output_subarea output_text output_error"&gt;
&lt;pre&gt;
&lt;span class="ansi-red-fg"&gt;---------------------------------------------------------------------------&lt;/span&gt;
&lt;span class="ansi-red-fg"&gt;ProgrammingError&lt;/span&gt;                          Traceback (most recent call last)
&lt;span class="ansi-green-fg"&gt;&amp;lt;ipython-input-35-06d32ae504fc&amp;gt;&lt;/span&gt; in &lt;span class="ansi-cyan-fg"&gt;&amp;lt;module&amp;gt;&lt;/span&gt;
&lt;span class="ansi-green-intense-fg ansi-bold"&gt;      1&lt;/span&gt; &lt;span class="ansi-red-fg"&gt;# but we should not be able to delete data&lt;/span&gt;
&lt;span class="ansi-green-fg"&gt;----&amp;gt; 2&lt;/span&gt;&lt;span class="ansi-red-fg"&gt; &lt;/span&gt;cur&lt;span class="ansi-blue-fg"&gt;.&lt;/span&gt;execute&lt;span class="ansi-blue-fg"&gt;(&lt;/span&gt;&lt;span class="ansi-blue-fg"&gt;&amp;#39;DELETE FROM hurricanes WHERE fid=1000000&amp;#39;&lt;/span&gt;&lt;span class="ansi-blue-fg"&gt;)&lt;/span&gt;
&lt;span class="ansi-green-intense-fg ansi-bold"&gt;      3&lt;/span&gt; conn&lt;span class="ansi-blue-fg"&gt;.&lt;/span&gt;commit&lt;span class="ansi-blue-fg"&gt;(&lt;/span&gt;&lt;span class="ansi-blue-fg"&gt;)&lt;/span&gt;

&lt;span class="ansi-red-fg"&gt;ProgrammingError&lt;/span&gt;: permission denied for relation hurricanes
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;h1 id="Final-words"&gt;Final words&lt;a class="anchor-link" href="#Final-words"&gt;&amp;#182;&lt;/a&gt;&lt;/h1&gt;&lt;p&gt;There's not so much we can say on top of what has been shown with code. We can achieve almost anything with the &lt;a href="http://initd.org/psycopg/docs/index.html"&gt;&lt;code&gt;psycopg2&lt;/code&gt; driver&lt;/a&gt;, which is the most used python driver for postgres databases (their words, not mine).&lt;/p&gt;
&lt;h1 id="Moving-forward"&gt;Moving forward&lt;a class="anchor-link" href="#Moving-forward"&gt;&amp;#182;&lt;/a&gt;&lt;/h1&gt;&lt;p&gt;We can add another abstraction layer on top of the driver, namely an ORM or &lt;em&gt;object relational mapper&lt;/em&gt;. I use &lt;a href="https://www.sqlalchemy.org/"&gt;SQLAlchemy&lt;/a&gt; in my daily tasks and it has proven useful in many ways, but that's something for another topic.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
 


&lt;script type="text/javascript"&gt;if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) {
    var mathjaxscript = document.createElement('script');
    mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#';
    mathjaxscript.type = 'text/javascript';
    mathjaxscript.src = '//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML';
    mathjaxscript[(window.opera ? "innerHTML" : "text")] =
        "MathJax.Hub.Config({" +
        "    config: ['MMLorHTML.js']," +
        "    TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } }," +
        "    jax: ['input/TeX','input/MathML','output/HTML-CSS']," +
        "    extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']," +
        "    displayAlign: 'center'," +
        "    displayIndent: '0em'," +
        "    showMathMenu: true," +
        "    tex2jax: { " +
        "        inlineMath: [ ['$','$'] ], " +
        "        displayMath: [ ['$$','$$'] ]," +
        "        processEscapes: true," +
        "        preview: 'TeX'," +
        "    }, " +
        "    'HTML-CSS': { " +
        " linebreaks: { automatic: true, width: '95% container' }, " +
        "        styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'black ! important'} }" +
        "    } " +
        "}); ";
    (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript);
}
&lt;/script&gt;
</summary><category term="python"></category><category term="dataquest"></category><category term="data-engineering"></category><category term="postgres"></category></entry><entry><title>Flask contexts (And how to use them)</title><link href="https://diegoquintanav.github.io/flask-contexts.html" rel="alternate"></link><published>2018-11-24T13:14:00-06:00</published><updated>2018-11-24T13:14:00-06:00</updated><author><name>Diego Quintana</name></author><id>tag:diegoquintanav.github.io,2018-11-24:flask-contexts.html</id><summary type="html">&lt;h1 id="motivation"&gt;Motivation&lt;/h1&gt;
&lt;p&gt;There's this thing going on with the &lt;a href="http://flask.pocoo.org/docs/1.0/appcontext/#creating-an-application-context"&gt;flask context&lt;/a&gt; and the &lt;a href="http://flask.pocoo.org/docs/1.0/reqcontext/"&gt;request context&lt;/a&gt;, that used to confuse me a lot. Before testing these two probably will never be used, but after reading &lt;a href="http://flask.pocoo.org/docs/1.0/testing/"&gt;the documentation&lt;/a&gt; and writing your first tests, it's probable that you run into something like&lt;/p&gt;
&lt;p&gt;&lt;code&gt;plain
Flask.url_for() error: Attempted to generate a URL without the application context being pushed&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;So, what is that went &lt;em&gt;wrong&lt;/em&gt;?&lt;/p&gt;
&lt;p&gt;Someone already wrote an &lt;a href="http://kronosapiens.github.io/blog/2014/08/14/understanding-contexts-in-flask.html"&gt;exhaustive revision&lt;/a&gt; of what are the different approaches, but it actually never closes the issue of &lt;em&gt;how&lt;/em&gt; to test an application properly.&lt;/p&gt;
&lt;p&gt;Others mention it, but it just &lt;em&gt;doesn't stick&lt;/em&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="http://alexmic.net/flask-sqlalchemy-pytest/"&gt;Delightful testing with pytest and Flask-SQLAlchemy - Alex Michael&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://code.luasoftware.com/tutorials/flask/flask-url-for/"&gt;Flask url_for | Lua Software Code&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://www.patricksoftwareblog.com/testing-a-flask-application-using-pytest/"&gt;Testing a Flask Application using pytest – Patrick's Software Blog&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://github.com/pallets/flask/tree/1.0.2/examples/tutorial/tests"&gt;flask/examples/tutorial/tests at 1.0.2 · pallets/flask · GitHub&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;For the sake of completeness and for my own understanding of the issue, here's my view on the topic.&lt;/p&gt;
&lt;h2 id="flask-contexts"&gt;Flask Contexts&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;In the lifecycle of a request, both an &lt;em&gt;Application context&lt;/em&gt; and a &lt;em&gt;Request Context&lt;/em&gt; are created at the beginning, and destroyed at the end (see &lt;a href="https://speakerdeck.com/mitsuhiko/advanced-flask-patterns-1?slide=7"&gt;Advanced Flask Patterns - Speaker Deck, Slide 7&lt;/a&gt;)&lt;/li&gt;
&lt;li&gt;The idea behind having two detached contexts is so an application can exist
  outside of a request, and it's more of a design pattern (That a lot of people seems to &lt;em&gt;hate&lt;/em&gt;) and it was different in previous versions of Flask &lt;a href="https://stackoverflow.com/questions/15083967/when-should-flask-g-be-used"&gt;as discussed in this SO question (Which is also a great discussion about the internals of Flask).&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;In short, &lt;em&gt;context locals&lt;/em&gt; can be summarized as (as shown in &lt;a href="https://speakerdeck.com/mitsuhiko/flask-for-fun-and-profit?slide=27"&gt;Flask for Fun and Profit, Slide 27&lt;/a&gt;)&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;A pushed app context points the current app in use to &lt;code&gt;current_app&lt;/code&gt;, and it gives
  meaning to other proxies that only make sense for some parameters in a &lt;em&gt;live&lt;/em&gt;
  app instance, like &lt;code&gt;url_for&lt;/code&gt; and &lt;code&gt;g&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;A request context is more expensive and maps the &lt;code&gt;request&lt;/code&gt; proxy to the current
  request in process&lt;/li&gt;
&lt;li&gt;&lt;a href="https://github.com/pallets/flask/blob/1949c4a9abc174bf29620f6dd8ceab9ed3ace2eb/flask/ctx.py#L230"&gt;Every request pushes a new application context&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id="flask-contexts-vernacular"&gt;Flask contexts vernacular&lt;/h2&gt;
&lt;p&gt;For a given &lt;code&gt;app&lt;/code&gt; object, there are some design aspects and specific objects
it's good to get familiar with when testing with Flask&lt;/p&gt;
&lt;h3 id="flaskapptest_client"&gt;&lt;code&gt;flask.app.test_client()&lt;/code&gt;&lt;/h3&gt;
&lt;p&gt;Provides a client that can perform requests to our application.&lt;/p&gt;
&lt;h3 id="flaskappapp_context"&gt;&lt;code&gt;flask.app.app_context()&lt;/code&gt;&lt;/h3&gt;
&lt;p&gt;The application context, it gives life to &lt;code&gt;current_app&lt;/code&gt;. Starts and dies with
a request.&lt;/p&gt;
&lt;h3 id="flaskapptest_request_context"&gt;&lt;code&gt;flask.app.test_request_context()&lt;/code&gt;&lt;/h3&gt;
&lt;p&gt;The request context, it gives life to &lt;code&gt;request&lt;/code&gt;. If there's no application context
at the moment, it pushes a new one. Starts and ends with a request.&lt;/p&gt;
&lt;h3 id="g"&gt;&lt;code&gt;g&lt;/code&gt;&lt;/h3&gt;
&lt;p&gt;A proxy that lives within a pushed &lt;strong&gt;application&lt;/strong&gt; context, used to store &lt;em&gt;non sensible&lt;/em&gt;
information about the current application. Its life is bound to that of the request.&lt;/p&gt;
&lt;h3 id="session"&gt;&lt;code&gt;session&lt;/code&gt;&lt;/h3&gt;
&lt;p&gt;A proxy that lives within a pushed &lt;strong&gt;request&lt;/strong&gt; context, used to store &lt;em&gt;sensible&lt;/em&gt;
information &lt;em&gt;through the client&lt;/em&gt;, and encrypted with your &lt;code&gt;SECRET_KEY&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;Using &lt;code&gt;session&lt;/code&gt; to store private information like passwords and credentials is
discouraged. See the caveats in &lt;a href="https://blog.miguelgrinberg.com/post/how-secure-is-the-flask-user-session"&gt;Miguel Grinberg's post about it&lt;/a&gt;.&lt;/p&gt;
&lt;h2 id="practical-differences-in-code"&gt;Practical differences (in code)&lt;/h2&gt;
&lt;p&gt;This &lt;a href="https://stackoverflow.com/a/33382823/5819113"&gt;SO answer&lt;/a&gt; puts it simple, so I will be kinda adding my own comments to it.&lt;/p&gt;
&lt;p&gt;```python
from flask import Flask, g
app = Flask(&lt;strong&gt;name&lt;/strong&gt;)&lt;/p&gt;
&lt;p&gt;with app.app_context():
    print('in app context, before first request context')
    print('setting g.foo to abc')
    g.foo = 'abc'
    print('g.foo should be abc, is: {0}'.format(g.foo))&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;with app.test_request_context():
    # this reuses g from the current context
    print('in first request context')
    print('g.foo should be abc, is: {0}'.format(g.foo))
    print('setting g.foo to xyz')
    # this is the same g, so it will be replaced
    g.foo = 'xyz'
    print('g.foo should be xyz, is: {0}'.format(g.foo))

print('in app context, after first request context')
print('g.foo should be abc, is: {0}'.format(g.foo))

with app.test_request_context():
    print('in second request context')
    print('g.foo should be abc, is: {0}'.format(g.foo))
    print('setting g.foo to pqr')
    g.foo = 'pqr'
    print('g.foo should be pqr, is: {0}'.format(g.foo))

print('in app context, after second request context')
print('g.foo should be abc, is: {0}'.format(g.foo))
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;```&lt;/p&gt;
&lt;p&gt;And here's the output that it gives:&lt;/p&gt;
&lt;p&gt;&lt;code&gt;plain
in app context, before first request context
setting g.foo to abc
g.foo should be abc, is: abc
in first request context
g.foo should be abc, is: abc
setting g.foo to xyz
g.foo should be xyz, is: xyz
in app context, after first request context
g.foo should be abc, is: xyz
in second request context
g.foo should be abc, is: xyz
setting g.foo to pqr
g.foo should be pqr, is: pqr
in app context, after second request context
g.foo should be abc, is: pqr&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;In this first example &lt;code&gt;g&lt;/code&gt; is shared across contexts because it's the same
context in &lt;em&gt;nested contexts&lt;/em&gt;, and it's a &lt;em&gt;caveat&lt;/em&gt; mentioned in the answer (some emphasis is mine)&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;"Every request pushes a new application context". And &lt;a href="http://flask.pocoo.org/docs/0.10/appcontext/"&gt;as the Flask docs say&lt;/a&gt;, the application context "will not be shared between requests". Now, what hasn't been explicitly stated (although I guess it's implied from these statements), and what my testing clearly shows, is that &lt;em&gt;you should &lt;strong&gt;never&lt;/strong&gt; explicitly create multiple request contexts nested inside one application context, because &lt;code&gt;flask.g&lt;/code&gt; (and co) doesn't have any magic whereby it functions in the two different "levels" of context&lt;/em&gt;, with different states existing independently at the application and request levels.&lt;/p&gt;
&lt;p&gt;The reality is that "application context" is potentially quite a misleading name, because &lt;code&gt;app.app_context()&lt;/code&gt; &lt;strong&gt;is&lt;/strong&gt; a per-request context, exactly the same as the "request context". Think of it as a "request context lite", only required in the case where you need some of the variables that normally require a request context, but you don't need access to any request object (e.g. when running batch DB operations in a shell script). If you try and extend the application context to encompass more than one request context, you're asking for trouble. So, rather than my test above, you should instead write code like this with Flask's contexts:&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;```python
from flask import Flask, g
app = Flask(&lt;strong&gt;name&lt;/strong&gt;)&lt;/p&gt;
&lt;p&gt;with app.app_context():
    print('in app context, before first request context')
    print('setting g.foo to abc')
    g.foo = 'abc'
    print('g.foo should be abc, is: {0}'.format(g.foo))&lt;/p&gt;
&lt;p&gt;with app.test_request_context():
    print('in first request context')
    print('g.foo should be None, is: {0}'.format(g.get('foo')))
    print('setting g.foo to xyz')
    g.foo = 'xyz'
    print('g.foo should be xyz, is: {0}'.format(g.foo))&lt;/p&gt;
&lt;p&gt;with app.test_request_context():
    print('in second request context')
    print('g.foo should be None, is: {0}'.format(g.get('foo')))
    print('setting g.foo to pqr')
    g.foo = 'pqr'
    print('g.foo should be pqr, is: {0}'.format(g.foo))
```&lt;/p&gt;
&lt;p&gt;Which will give the expected results:&lt;/p&gt;
&lt;p&gt;&lt;code&gt;plain
in app context, before first request context
setting g.foo to abc
g.foo should be abc, is: abc
in first request context
g.foo should be None, is: None
setting g.foo to xyz
g.foo should be xyz, is: xyz
in second request context
g.foo should be None, is: None
setting g.foo to pqr
g.foo should be pqr, is: pqr&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;In this second example, all three &lt;code&gt;with&lt;/code&gt; blocks are pushing independent contexts. The difference is that
last two are also pushing an application context &lt;em&gt;implicitly&lt;/em&gt;, and the first one is not pushing a request context.&lt;/p&gt;
&lt;h2 id="so-how-do-i-test-my-app"&gt;So, how do I test my app?&lt;/h2&gt;
&lt;p&gt;I will be using &lt;a href="https://docs.pytest.org/en/latest/"&gt;&lt;code&gt;pytest&lt;/code&gt;&lt;/a&gt; because it's good. Just google "&lt;code&gt;unittest versus pytest&lt;/code&gt;" to find out why.&lt;/p&gt;
&lt;p&gt;This &lt;a href="https://stackoverflow.com/a/17377101/5819113"&gt;SO answer&lt;/a&gt; summarizes the differences in the best way I've found so far.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;If you want to make a request to your application, use the &lt;a href="http://flask.pocoo.org/docs/latest/api/#flask.Flask.test_client"&gt;&lt;code&gt;test_client&lt;/code&gt;&lt;/a&gt;.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;c = app.test_client()
response = c.get('/test/url')
# test response
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;If you want to test code which uses an application context (&lt;code&gt;current_app&lt;/code&gt;, &lt;code&gt;g&lt;/code&gt;, &lt;code&gt;url_for&lt;/code&gt;), push an &lt;a href="http://flask.pocoo.org/docs/latest/api/#flask.Flask.app_context"&gt;&lt;code&gt;app_context&lt;/code&gt;&lt;/a&gt;.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;with app.app_context():
    # test your app context code
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;If you want test code which uses a request context (&lt;code&gt;request&lt;/code&gt;, &lt;code&gt;session&lt;/code&gt;), push a &lt;a href="http://flask.pocoo.org/docs/latest/api/#flask.Flask.test_request_context"&gt;&lt;code&gt;test_request_context&lt;/code&gt;&lt;/a&gt;.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;with current_app.test_request_context():
    # test your request context code
&lt;/code&gt;&lt;/pre&gt;
&lt;/blockquote&gt;
&lt;p&gt;It's also important to note that&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Both app and request contexts can also be pushed manually, which is useful when using the interpreter.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&amp;gt;&amp;gt;&amp;gt; ctx = app.app_context()
&amp;gt;&amp;gt;&amp;gt; ctx.push()
&lt;/code&gt;&lt;/pre&gt;
&lt;/blockquote&gt;
&lt;p&gt;So far there are &lt;em&gt;two&lt;/em&gt; approaches:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;push an application context at the beginning inside a fixture, and pop it at the end&lt;/li&gt;
&lt;li&gt;pass an application object from the fixture and produce contexts locally inside
   each test&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;Everything in the middle is prone to produce weird results and drive you crazy, so &lt;em&gt;try&lt;/em&gt; to be consistent!&lt;/p&gt;
&lt;p&gt;&lt;a href="http://lucumr.pocoo.org/about/"&gt;Armin Ronacher&lt;/a&gt; suggests a pytest fixture pattern in &lt;a href="https://youtu.be/1ByQhAM5c1I?t=2285"&gt;this presentation&lt;/a&gt; (&lt;a href="https://speakerdeck.com/mitsuhiko/flask-for-fun-and-profit?slide=52"&gt;slides&lt;/a&gt;), which relies in the first approach. The code is as follows:&lt;/p&gt;
&lt;p&gt;```python
import pytest&lt;/p&gt;
&lt;p&gt;@pytest.fixture(scope="module")
def app(request):&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;# import app factory pattern
from yourapp import create_app
app = create_app()

# pushes an application context manually
ctx = app.app_context()
ctx.push()

# bind the test life with the context through the
request.addfinalizer(ctx.pop)
return app
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;@pytest.fixture()
def test_client(request, app):&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;client = app.test_client()
client.__enter__()

request.addfinalizer(
    lambda: client.__exit__(None, None, None))
return client
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;```&lt;/p&gt;
&lt;p&gt;Note that &lt;code&gt;request&lt;/code&gt; here refers to the &lt;a href="https://docs.pytest.org/en/latest/reference.html#request"&gt;&lt;code&gt;pytest&lt;/code&gt; fixture&lt;/a&gt;&lt;/p&gt;
&lt;h2 id="but-how-do-i-test-really"&gt;But how do I test? really&lt;/h2&gt;
&lt;p&gt;After a lot of churning and with the help of &lt;code&gt;#pocoo&lt;/code&gt; in IRC, I came up with this:&lt;/p&gt;
&lt;p&gt;```python
import pytest&lt;/p&gt;
&lt;p&gt;@pytest.fixture
def runner(app):
    """A test runner for the app's Click commands."""
    return app.test_cli_runner()&lt;/p&gt;
&lt;p&gt;@pytest.fixture(scope='session')
def app(request):
    from yourapp import create_app
    return create_app('testing')&lt;/p&gt;
&lt;p&gt;@pytest.fixture(autouse=True)
def app_context(app):
    """Creates a flask app context"""
    with app.app_context():
        yield app&lt;/p&gt;
&lt;p&gt;@pytest.fixture
def request_context(app_context):
    """Creates a flask request context"""
    with app_context.test_request_context():
        yield&lt;/p&gt;
&lt;p&gt;@pytest.fixture
def client(app_context):
    return app_context.test_client(use_cookies=True)&lt;/p&gt;
&lt;p&gt;@pytest.fixture(scope="model")
def db(app_context):&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;# extensions pattern explained in here https://stackoverflow.com/a/42910185/5819113
from yourapp.extensions import db

db.create_all()

# seed the database
seed_db()

yield db

# teardown database
# https://stackoverflow.com/a/18365654/5819113
db.session.remove()
db.drop_all()
db.get_engine(app_context).dispose()
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;def seed_db():
    # insert default users and roles
    print("Seeding the database or something")
```&lt;/p&gt;
&lt;p&gt;This is working for me. In short&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;If your test requires a living app, import the &lt;code&gt;app_context&lt;/code&gt; fixture&lt;/li&gt;
&lt;li&gt;If your test requires a populated database, import &lt;code&gt;db&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;If your test requires examining a part of the request, import the &lt;code&gt;request_context&lt;/code&gt; fixture&lt;/li&gt;
&lt;li&gt;If your test requires a logged in user, you can use the &lt;code&gt;client&lt;/code&gt; fixture and &lt;code&gt;flask_login&lt;/code&gt; as&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;```python
def login(client, email, password):
    """A helper method that logs in users"""
    return client.post(url_for('auth.login'),
                    data={
                        'email': email,
                        'password': password},
                    follow_redirects=True)&lt;/p&gt;
&lt;p&gt;def test_with_logged_in_user(client):
    """Tests a view that requires authentication"""
    from flask_login import current_user&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;# client is a pytest fixture
with client as c:
    # login is a helper method that issues a POST request
    login(c, "user@test.com", "test")
    assert current_user.email == "user@test.com"
    assert current_user.is_authenticated

    response = c.get(
        '/restricted_view/',
        follow_redirects=True)

    assert response.status_code == 200
    assert b'Stuff that should appear in your view' in response.data
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;```&lt;/p&gt;
&lt;p&gt;That's all I have to say about it.&lt;/p&gt;</summary><category term="flask"></category><category term="python"></category><category term="pytest"></category></entry><entry><title>Sistemas recomendadores, parte 4</title><link href="https://diegoquintanav.github.io/recsys-4-ES.html" rel="alternate"></link><published>2018-12-14T09:03:00-06:00</published><updated>2018-12-14T09:03:00-06:00</updated><author><name>Diego Quintana</name></author><id>tag:diegoquintanav.github.io,2017-11-02:recsys-4-ES.html</id><summary type="html">&lt;!-- Modified: 2010-12-05 19:30 --&gt;

&lt;!-- entry 4, clase al 08.11 --&gt;

&lt;!-- Hoy --&gt;

&lt;!-- *  Evaluación --&gt;

&lt;!-- *  Laboratorio --&gt;

&lt;!-- *  usando *Bag of Words* --&gt;

&lt;!-- *  LDA --&gt;

&lt;!-- *  Usando un software llamado *gensim* --&gt;

&lt;div class="toc"&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="#previously"&gt;Previously&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#sistemas-de-recomendacion-hibridos"&gt;Sistemas de recomendación híbridos&lt;/a&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href="#monolitico"&gt;Monolítico&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#paralelizado"&gt;Paralelizado&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#pipeline"&gt;Pipeline&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;a href="#evaluacion-de-un-recomendador"&gt;Evaluación de un recomendador&lt;/a&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href="#metricas-en-contexto-de-clasificacion"&gt;Métricas en contexto de clasificación&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#metricas-en-el-contexto-de-recomendadores"&gt;Métricas en el contexto de recomendadores&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;a href="#a-continuacion"&gt;A continuación&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;h1 id="previously"&gt;&lt;em&gt;Previously&lt;/em&gt;&lt;/h1&gt;
&lt;p&gt;En la &lt;a href="https://diegoquintanav.github.io/recsys-3-ES.html"&gt;parte 3&lt;/a&gt; se comentaron algunos &lt;em&gt;SR&lt;/em&gt; basados en contenido, quedando para esta parte comentar un poco sobre sistemas &lt;em&gt;híbridos&lt;/em&gt; y sobre métricas usadas en la evaluación de un &lt;em&gt;SR&lt;/em&gt;.&lt;/p&gt;
&lt;h1 id="sistemas-de-recomendacion-hibridos"&gt;Sistemas de recomendación híbridos&lt;/h1&gt;
&lt;p&gt;Se trata de una familia de &lt;em&gt;SR&lt;/em&gt; que combina elementos de las clasificaciones vistas antes, &lt;em&gt;content based&lt;/em&gt; (CB) y &lt;em&gt;collaborative filtering based&lt;/em&gt; (CF). Al respecto en &lt;a href="http://citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.88.8200&amp;amp;rep=rep1&amp;amp;type=pdf"&gt;&lt;em&gt;Burke, 2007&lt;/em&gt;&lt;/a&gt; y en &lt;a href="http://blog.ag-nbi.de/wp-content/uploads/2015/10/adomavicius-recsys.pdf"&gt;&lt;em&gt;Adomavicius, 2005&lt;/em&gt;&lt;/a&gt; se hace una revisión extensa sobre el tema.&lt;/p&gt;
&lt;p&gt;Según Burke existen 7 formas distintas de &lt;em&gt;hibridizar sistemas&lt;/em&gt;,&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;Weighted&lt;/strong&gt; Los puntajes o scores de las recomendaciones provenientes de distintos &lt;em&gt;SR&lt;/em&gt; son combinadas en una sola recomendación&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Switching&lt;/strong&gt; El &lt;em&gt;SR&lt;/em&gt; es intercambiado dependiendo de la situación&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Mixed&lt;/strong&gt; Recomendaciones de distintos &lt;em&gt;SR&lt;/em&gt; se presentan al mismo tiempo&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Feature combination&lt;/strong&gt; Las características de distintos &lt;em&gt;SR&lt;/em&gt; se combinan en un nuevo algoritmo de recomendación.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Cascade&lt;/strong&gt; Un &lt;em&gt;SR&lt;/em&gt; refina las recomendaciones de otro &lt;em&gt;SR&lt;/em&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Feature augmentation&lt;/strong&gt; La recomendación de un &lt;em&gt;SR&lt;/em&gt; es usada como parámetros de entrada para otro &lt;em&gt;SR&lt;/em&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Meta-level&lt;/strong&gt; El modelo aprendido por un &lt;em&gt;SR&lt;/em&gt; es usado como información de entrada para otro &lt;em&gt;SR&lt;/em&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;Estas siguen 3 diseños generales:&lt;/p&gt;
&lt;h2 id="monolitico"&gt;Monolítico&lt;/h2&gt;
&lt;p&gt;Se refiere a la unión de dos o más &lt;em&gt;SR&lt;/em&gt; en uno solo. Ejemplos de esto son aquellos que implementan &lt;em&gt;Feature augmentation y Feature combination&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;&lt;img alt="monolithic" src="https://diegoquintanav.github.io/images/monolithic_hybrid.png" /&gt;&lt;/p&gt;
&lt;h2 id="paralelizado"&gt;Paralelizado&lt;/h2&gt;
&lt;p&gt;Se refiere a la ejecución de diversos &lt;em&gt;SR&lt;/em&gt; en paralelo, cuyas recomendaciones son combinadas en la salida. Algoritmos hibridos tipo &lt;em&gt;Weighted, Switching, Mixed&lt;/em&gt; lo implementan.&lt;/p&gt;
&lt;p&gt;&lt;img alt="parallel" src="https://diegoquintanav.github.io/images/parallel_hybrid.png" /&gt;&lt;/p&gt;
&lt;h2 id="pipeline"&gt;Pipeline&lt;/h2&gt;
&lt;p&gt;Se refieren a los &lt;em&gt;SR&lt;/em&gt; cuya entrada es la salida de otro &lt;em&gt;SR&lt;/em&gt;, siguiendo una ejecución en serie. Ejemplos de implementaciones son &lt;em&gt;Cascade, Meta-Level&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;&lt;img alt="pipeline" src="https://diegoquintanav.github.io/images/pipeline_hybrid.png" /&gt;&lt;/p&gt;
&lt;h1 id="evaluacion-de-un-recomendador"&gt;Evaluación de un recomendador&lt;/h1&gt;
&lt;h2 id="metricas-en-contexto-de-clasificacion"&gt;Métricas en contexto de clasificación&lt;/h2&gt;
&lt;p&gt;El problema de recomendación puede verse como un problema de clasificación, en el sentido que un &lt;em&gt;SR&lt;/em&gt; intenta clasificar elementos como recomendables o no recomendables, dado un usuario cualquiera. En esta tarea de clasificación un &lt;em&gt;SR&lt;/em&gt; puede fallar o acertar, lo que da lugar a dos a distintas métricas que permitan cuantificar la &lt;em&gt;calidad&lt;/em&gt; de un clasificador.&lt;/p&gt;
&lt;p&gt;La primera herramienta que uno debería considerar es la matriz de confusión, la que puede leerse con más detalle en &lt;a href="http://www.dataschool.io/simple-guide-to-confusion-matrix-terminology/"&gt;dataschool&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Una matriz de confusión es una representación de la cantidad de aciertos por clase en una tarea &lt;em&gt;de clasificación&lt;/em&gt;. En este sentido se habla de&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Verdaderos positivos, TP&lt;/li&gt;
&lt;li&gt;Verdaderos negativos, TN&lt;/li&gt;
&lt;li&gt;Falsos positivos, FP&lt;/li&gt;
&lt;li&gt;Falsos negativos, FN&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;En el contexto de &lt;em&gt;SR&lt;/em&gt;, sin embargo, se define un &lt;em&gt;acierto&lt;/em&gt; en un conjunto de recomendaciones como &lt;em&gt;relevante&lt;/em&gt;. La definición de relevancia puede variar dependiendo de cada caso, pudiendo ser&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Un usuario hace click en un link de una lista de links recomendados&lt;/li&gt;
&lt;li&gt;Un usuario compra un libro recomendado&lt;/li&gt;
&lt;li&gt;Un usuario comparte un video sugerido&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Estas nuevas clases dan lugar a una serie de indicadores que ayudan a valorizar un &lt;em&gt;SR&lt;/em&gt;. Si se visualizan estas clases en un diagrama de conjuntos, se tiene&lt;/p&gt;
&lt;p&gt;&lt;img alt="venn1" src="https://diegoquintanav.github.io/images/venn1.png" /&gt;&lt;/p&gt;
&lt;p&gt;De aquí se tiene que la &lt;strong&gt;Precisión&lt;/strong&gt; es la fracción de instancias &lt;em&gt;relevantes&lt;/em&gt; obtenidas en alguna tarea en específico, del resultado de recomendaciones.&lt;/p&gt;
&lt;div class="math"&gt;$$\mbox{precision} = \frac{\mbox{TP}}{\mbox{TP}+\mbox{FP}}$$&lt;/div&gt;
&lt;p&gt;O en el contexto de &lt;em&gt;SR&lt;/em&gt;,&lt;/p&gt;
&lt;div class="math"&gt;$$\mbox{precision} = \frac{|\mbox{recomendados} \cap \mbox{relevantes}|}{|\mbox{recomendados}|}$$&lt;/div&gt;
&lt;p&gt;Para el caso del diagrama, la recomendación o el &lt;em&gt;SR&lt;/em&gt; tiene una precisión de &lt;span class="math"&gt;\(2/5=0.4\)&lt;/span&gt;. La &lt;em&gt;precisión&lt;/em&gt; entonces mide qué tan posible es obtener los elementos relevantes &lt;em&gt;con la menor cantidad&lt;/em&gt; de recomendaciones.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Recall&lt;/strong&gt; o &lt;em&gt;true positive rate&lt;/em&gt; (TPR) se refiere a la fracción de instancias relevantes obtenidas del total de instancias relevantes, o bien&lt;/p&gt;
&lt;div class="math"&gt;$$
\mbox{TPR} = \mbox{recall} = \frac{\mbox{TP}}{\mbox{TP}+\mbox{FN}}
$$&lt;/div&gt;
&lt;p&gt;O en términos de recomendaciones&lt;/p&gt;
&lt;div class="math"&gt;$$
\mbox{recall} = \frac{|\mbox{recomendados} \cap \mbox{relevantes}|}{|\mbox{relevantes}|}$$&lt;/div&gt;
&lt;p&gt;Para el caso del diagrama, el &lt;em&gt;recall&lt;/em&gt; del &lt;em&gt;SR&lt;/em&gt; es de &lt;span class="math"&gt;\(2/10=0.2\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;Ambos, precision y &lt;em&gt;recall&lt;/em&gt; tienen una relación inversa, tal que el &lt;em&gt;recall&lt;/em&gt; disminuye a medida que la precisión aumenta. En este sentido, para un clasificador es posible graficar su desempeño en términos de la curva &lt;em&gt;precision vs recall&lt;/em&gt; o curva PR.&lt;/p&gt;
&lt;p&gt;Esta curva puede transformarse a otro espacio más conocido, llamado &lt;a href="https://en.wikipedia.org/wiki/Receiver_operating_characteristic"&gt;curva ROC&lt;/a&gt; o &lt;em&gt;receiving operating characteristic curve&lt;/em&gt;, en el cual se grafica el &lt;em&gt;recall&lt;/em&gt; como TPR o &lt;em&gt;true positive rate&lt;/em&gt; versus &lt;strong&gt;FPR&lt;/strong&gt; o &lt;em&gt;false positive rate&lt;/em&gt;.&lt;/p&gt;
&lt;p&gt;&lt;a href="http://www.youtube.com/watch?v=OAl6eAyP-yo" title="ROC Curve explained"&gt;&lt;img alt="roc_video" src="http://img.youtube.com/vi/OAl6eAyP-yo/0.jpg" /&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Conviene tener en cuenta que &lt;strong&gt;ambas curvas no son equivalentes&lt;/strong&gt; y la curva PR describe mejor el desempeño de clasificadores en casos donde hay un desbalance importante de clases. Una comparación completa entre ambas curvas puede leerse &lt;a href="http://pages.cs.wisc.edu/~jdavis/davisgoadrichcamera2.pdf"&gt;aquí&lt;/a&gt;&lt;/p&gt;
&lt;div class="math"&gt;$$
\mbox{FPR} = {\frac {\mbox{FP}}{\mbox{N}}}={\frac {\mbox{FP}}{\mbox{FP+TN}}}
$$&lt;/div&gt;
&lt;p&gt;&lt;img alt="roc_vs_pr" src="https://diegoquintanav.github.io/images/roc_vs_pr.png" /&gt;&lt;/p&gt;
&lt;p&gt;Finalmente, algunas notas sobre este tema&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Considerando que hay tipos de &lt;em&gt;SR&lt;/em&gt; distintos que generan resultados distintos, estas métricas resultan útiles para poder comparar los distintos modelos, por ejemplo a través de &lt;em&gt;A/B Testing&lt;/em&gt; o tests de hipótesis.&lt;/li&gt;
&lt;li&gt;Dependiendo del caso, puedo darse la necesidad de usar algoritmos con mayor &lt;em&gt;recall&lt;/em&gt; que precisión i.e. si quiero saber cuándo es el siguiente partido de chile, me importa más usar un &lt;em&gt;SR&lt;/em&gt; que recomiende el &lt;em&gt;resultado correcto&lt;/em&gt;, en vez de un &lt;em&gt;SR&lt;/em&gt; que me recomiende &lt;em&gt;la mejor página con el resultado&lt;/em&gt;. En este caso requiero mayor &lt;em&gt;recall&lt;/em&gt; que &lt;em&gt;precisión&lt;/em&gt;.&lt;/li&gt;
&lt;li&gt;Es bueno recordar que estas métricas evalúan &lt;em&gt;conjuntos de recomendaciones&lt;/em&gt;, no las recomendaciones en sí.&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id="metricas-en-el-contexto-de-recomendadores"&gt;Métricas en el contexto de recomendadores&lt;/h2&gt;
&lt;p&gt;En el contexto de recomendadores existen muchos otros indicadores que ayudan a evaluar un &lt;em&gt;SR&lt;/em&gt;, y por mencionar algunos&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Mean reciprocal rank (MRR)&lt;/li&gt;
&lt;li&gt;Precision at N (P@N)&lt;/li&gt;
&lt;li&gt;Mean Average Precision (MAP)&lt;/li&gt;
&lt;li&gt;DCG y nDCG&lt;/li&gt;
&lt;li&gt;Coverage index&lt;/li&gt;
&lt;li&gt;Diversity index&lt;/li&gt;
&lt;li&gt;Mean Percentage Ranking&lt;/li&gt;
&lt;/ul&gt;
&lt;!-- TODO: sugerir links --&gt;

&lt;!-- # Diversity

Si alguien le gusta el *colo colo*, y le recomiendo sólo noticias del mismo equipo, la diversidad es muy baja. Si en cambio le recomiendo noticias de fútbol, añado diversidad a mi conjunto de recomendaciones. Esto apunta a resolver el problema de *burbujas de información*, algo que se puede hacer de manera programática y controlada. --&gt;

&lt;h1 id="a-continuacion"&gt;A continuación&lt;/h1&gt;
&lt;!-- Esto es todo por ahora. En la [parte 5 y final]({filename}/blog/sysrec-5.md) se verán las _Máquinas de Factorización_. --&gt;

&lt;p&gt;Esto es todo por ahora. En la parte 5 y final se verán las &lt;em&gt;Máquinas de Factorización&lt;/em&gt;.&lt;/p&gt;
&lt;script type="text/javascript"&gt;if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) {
    var align = "center",
        indent = "0em",
        linebreak = "false";

    if (false) {
        align = (screen.width &lt; 768) ? "left" : align;
        indent = (screen.width &lt; 768) ? "0em" : indent;
        linebreak = (screen.width &lt; 768) ? 'true' : linebreak;
    }

    var mathjaxscript = document.createElement('script');
    mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#';
    mathjaxscript.type = 'text/javascript';
    mathjaxscript.src = 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.3/latest.js?config=TeX-AMS-MML_HTMLorMML';
    mathjaxscript[(window.opera ? "innerHTML" : "text")] =
        "MathJax.Hub.Config({" +
        "    config: ['MMLorHTML.js']," +
        "    TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } }," +
        "    jax: ['input/TeX','input/MathML','output/HTML-CSS']," +
        "    extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']," +
        "    displayAlign: '"+ align +"'," +
        "    displayIndent: '"+ indent +"'," +
        "    showMathMenu: true," +
        "    messageStyle: 'normal'," +
        "    tex2jax: { " +
        "        inlineMath: [ ['\\\\(','\\\\)'] ], " +
        "        displayMath: [ ['$$','$$'] ]," +
        "        processEscapes: true," +
        "        preview: 'TeX'," +
        "    }, " +
        "    'HTML-CSS': { " +
        "        styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'inherit ! important'} }," +
        "        linebreaks: { automatic: "+ linebreak +", width: '90% container' }," +
        "    }, " +
        "}); " +
        "if ('default' !== 'default') {" +
            "MathJax.Hub.Register.StartupHook('HTML-CSS Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax['HTML-CSS'].FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
            "MathJax.Hub.Register.StartupHook('SVG Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax.SVG.FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
        "}";
    (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript);
}
&lt;/script&gt;</summary><category term="recsys"></category></entry><entry><title>Sistemas recomendadores, parte 3</title><link href="https://diegoquintanav.github.io/recsys-3-ES.html" rel="alternate"></link><published>2018-12-03T20:48:00-06:00</published><updated>2018-12-03T20:48:00-06:00</updated><author><name>Diego Quintana</name></author><id>tag:diegoquintanav.github.io,2017-11-01:recsys-3-ES.html</id><summary type="html">&lt;div class="toc"&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="#previously"&gt;previously&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#sistemas-recomendadores-basados-en-contenido"&gt;Sistemas recomendadores basados en contenido&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#como-podemos-analizar-el-contenido"&gt;¿Cómo podemos analizar el contenido?&lt;/a&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href="#representacion-vectorial-de-texto"&gt;Representación vectorial de texto&lt;/a&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href="#regularizacion-de-texto"&gt;Regularización de texto&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;a href="#representacion-semantica-del-contenido-y-la-web-semantica"&gt;Representación semántica del contenido y la web semántica&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#metricas-de-similitud"&gt;Métricas de similitud&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#manejo-de-sinonimos"&gt;Manejo de sinónimos&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#tecnicas-de-procesamiento-adicionales"&gt;Técnicas de procesamiento adicionales&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#en-python"&gt;En python&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#a-continuacion"&gt;A continuación&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;h1 id="previously"&gt;&lt;em&gt;previously&lt;/em&gt;&lt;/h1&gt;
&lt;p&gt;En la &lt;a href="https://diegoquintanav.github.io/recsys-2-ES.html"&gt;parte 2&lt;/a&gt; se vieron algunas clasificaciones de &lt;em&gt;SR&lt;/em&gt;, y mencionamos aquellos basados en &lt;em&gt;memoria&lt;/em&gt; y basados en &lt;em&gt;modelos&lt;/em&gt;. &lt;/p&gt;
&lt;p&gt;Otra clasificación que se mencionó se refiere a &lt;em&gt;SR&lt;/em&gt; basados en &lt;strong&gt;contenido&lt;/strong&gt;, o &lt;em&gt;content-based&lt;/em&gt;.&lt;/p&gt;
&lt;h1 id="sistemas-recomendadores-basados-en-contenido"&gt;Sistemas recomendadores basados en contenido&lt;/h1&gt;
&lt;p&gt;Existen elementos que son cuantificables de manera directa, i.e.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Popularidad&lt;/li&gt;
&lt;li&gt;Género&lt;/li&gt;
&lt;li&gt;Director&lt;/li&gt;
&lt;li&gt;Ratings&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;El filtrado colaborativo permite abordar estos elementos de manera directa. Se vio sin embargo que estos &lt;em&gt;SR&lt;/em&gt; sufren de algunos problemas debido a la naturaleza &lt;em&gt;poco densa&lt;/em&gt; de los datos en el contexto de recomendación, así como el &lt;em&gt;new item problem&lt;/em&gt;, entre otros.&lt;/p&gt;
&lt;p&gt;Podemos decir también que hay otros elementos que no son cuantificables directamente y dependen de otras cosas, por ejemplo aquellos elementos relacionados al contexto, tales como:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Título de una película&lt;/li&gt;
&lt;li&gt;Descripción de un evento&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;En teoría, usando análisis de contenido, es posible generar recomendaciones considerando que existen descripciones suficientes. &lt;/p&gt;
&lt;p&gt;Algunos aspectos del análisis de contenido pueden ser&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Análisis de texto&lt;/li&gt;
&lt;li&gt;Análisis del perfil de usuario&lt;/li&gt;
&lt;li&gt;Filtrado de contenido&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;Este tipo de &lt;em&gt;SR&lt;/em&gt; presentan la ventaja de que es más fácil explicar las recomendaciones en función del mismo contenido.&lt;/p&gt;
&lt;p&gt;Sin embargo, dado que las recomendaciones dependen del análisis de contenido de las recomendaciones previas, puede ocurrir lo que se conoce como una burbuja de información o &lt;em&gt;filter bubble&lt;/em&gt;. Esta situación produce que las nuevas recomendaciones terminen siendo muy similares a lo ya consumido. &lt;/p&gt;
&lt;p&gt;Por ejemplo, si me gusta Harry Potter, puede ocurrir que el &lt;em&gt;SR&lt;/em&gt; sólo pueda recomendarme libros de Harry Potter y no de la narrativa fantástica en general, lo que dependiendo del caso, puede ser un resultado indeseado.&lt;/p&gt;
&lt;h1 id="como-podemos-analizar-el-contenido"&gt;¿Cómo podemos analizar el contenido?&lt;/h1&gt;
&lt;p&gt;El aspecto más importante de este tipo de &lt;em&gt;SR&lt;/em&gt; es su dependencia de la ?&lt;em&gt;representación&lt;/em&gt; del contenido. &lt;/p&gt;
&lt;p&gt;De manera más general en otras áreas esto se conoce como &lt;em&gt;information retrieval&lt;/em&gt;, y tiene que ver en cómo se extrae y representa información de los datos.&lt;/p&gt;
&lt;p&gt;En ese sentido, la forma más simple es la de analizar el texto en las descripciones de los ítems que forman parte del dataset.&lt;/p&gt;
&lt;h2 id="representacion-vectorial-de-texto"&gt;Representación vectorial de texto&lt;/h2&gt;
&lt;p&gt;La primera representación que se puede hacer de un texto es a través de lo que se conoce como &lt;a href="https://machinelearningmastery.com/gentle-introduction-bag-words-model/"&gt;&lt;em&gt;bag of words&lt;/em&gt;&lt;/a&gt;, donde las palabras se comparan con un diccionario o &lt;em&gt;corpus&lt;/em&gt;, y se representan como el número de repeticiones que esa palabra aparece en el texto.&lt;/p&gt;
&lt;p&gt;Esto a su vez permite otras representaciones, una es VSM o &lt;em&gt;Vector space model&lt;/em&gt;, el cual se trata de vectorizar términos en función de su aparición en una &lt;strong&gt;familia&lt;/strong&gt; &lt;/p&gt;
&lt;p&gt;Un ejemplo se puede ver en la siguiente imagen, donde la palabra &lt;em&gt;likes&lt;/em&gt; se representa como la frecuencia en la que la palabra aparece en tres documentos distintos:&lt;/p&gt;
&lt;p&gt;&lt;img alt="vsm1" src="https://diegoquintanav.github.io/images/vsm1.png" title="vsm1" /&gt;&lt;/p&gt;
&lt;p&gt;Usando un procedimiento similar, es posible también representar un &lt;strong&gt;documento&lt;/strong&gt; como un vector, donde cada elemento del vector es la frecuencia de cada palabra de un corpus que aparece en el documento.&lt;/p&gt;
&lt;div class="math"&gt;$$
v = [f_{1},f_{2},...,f_{n}]
$$&lt;/div&gt;
&lt;p&gt;donde &lt;span class="math"&gt;\(f_{i}\)&lt;/span&gt; es la frecuencia de cada palabra. Un vector de palabras o diccionario o &lt;em&gt;corpus&lt;/em&gt;, para el caso del castellano por ejemplo, es de aproximadamente 60000 palabras. &lt;/p&gt;
&lt;p&gt;La ventaja de esta representación es que al tratarse de vectores, estos tienen propiedades geométricas que permiten establecer comparaciones entre ellos.&lt;/p&gt;
&lt;h3 id="regularizacion-de-texto"&gt;Regularización de texto&lt;/h3&gt;
&lt;p&gt;La frecuencia de las palabras por sí sola en un documento no ayuda necesariamente a establecer similitudes, por ejemplo es muy posible encontrar muchas veces en un documento las palabras &lt;em&gt;él, ella, qué, etcétera&lt;/em&gt;, lo que no ayudan mucho. Dos documentos no son necesariamente iguales si tienen relativamente la misma cantidad de veces la palabra &lt;em&gt;qué&lt;/em&gt;.&lt;/p&gt;
&lt;p&gt;Es por esto que se desarrollan métodos de regularización, el primero es normalizar la frecuencia de los términos, a través de lo que se conoce como TF o &lt;em&gt;term frequency&lt;/em&gt;. En otras palabras, esto significa:&lt;/p&gt;
&lt;div class="math"&gt;$$
\mbox{TF}(\mbox{palabra},\mbox{documento}) = \frac{\mbox{veces que aparece la palabra en el documento}}{\mbox{cantidad máxima de veces que aparece la palabra en todos los documentos}}
$$&lt;/div&gt;
&lt;p&gt;Además, si se considera nuevamente como ejemplo la palabra &lt;em&gt;qué&lt;/em&gt;, esta no es más importante en un documento si aparece digamos, un 70% de las veces. 
Queremos entonces detectar otras palabras que aparecen con menor frecuencia. Para incorporar esto se usan logaritmos:&lt;/p&gt;
&lt;div class="math"&gt;$$
\left\{
    \begin{aligned}
    &amp;amp; 1+\log_{10} \mbox{TF}_{p,d} &amp;amp; \mbox{TF}_{p,d} \ge 1\\
    &amp;amp; 0 &amp;amp; \mbox{TF}_{p,d} = 0\\
    \end{aligned}
\right.
$$&lt;/div&gt;
&lt;p&gt;Finalmente combinando ambos elementos, es posible obtener una representación estable a través de TF-IDF&lt;/p&gt;
&lt;div class="math"&gt;$$
\mbox{TF-IDF}{p,d} = \mbox{TF}{p,d} \times \log \frac{N}{n_{p}}
$$&lt;/div&gt;
&lt;p&gt;De aquí&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;span class="math"&gt;\(N\)&lt;/span&gt; es la cantidad de documentos del dataset&lt;/li&gt;
&lt;li&gt;&lt;span class="math"&gt;\(n_{p}\)&lt;/span&gt; es la cantidad de documentos donde aparece la palabra&lt;/li&gt;
&lt;li&gt;El valor de &lt;span class="math"&gt;\(\log(N/n_{p})\)&lt;/span&gt; tiende a cero cuando la palabra aparece en muchos documentos (por ejemplo artículos, preposiciones, etc.)&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id="representacion-semantica-del-contenido-y-la-web-semantica"&gt;Representación semántica del contenido y la web semántica&lt;/h2&gt;
&lt;p&gt;El texto representado como &lt;em&gt;bag of words&lt;/em&gt; carece de sentido contextual. El contexto en sí mismo añade una nueva capa al análisis de texto, y entre las formas de incorporarlo se pueden usar &lt;em&gt;ontologías&lt;/em&gt;.&lt;/p&gt;
&lt;p&gt;Al respecto, la idea de una &lt;a href="https://en.wikipedia.org/wiki/Semantic_Web"&gt;web semántica&lt;/a&gt; intenta modelar los contenidos de internet a través de estructuras ontológicas estandarizadas llamadas &lt;a href="https://en.wikipedia.org/wiki/Resource_Description_Framework"&gt;RDF&lt;/a&gt;&lt;/p&gt;
&lt;h2 id="metricas-de-similitud"&gt;Métricas de similitud&lt;/h2&gt;
&lt;p&gt;Como vimos anteriormente, la vectorización de documentos permite operaciones entre vectores, los cuales tienen un sentido geométrico y por lo tanto permiten establecer métricas de distancia entre ellos. &lt;/p&gt;
&lt;p&gt;Las más conocidas ya se han visto y corresponden a:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Distancia euclidiana&lt;/li&gt;
&lt;li&gt;Distancia coseno&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Sin embargo, un &lt;em&gt;corpus&lt;/em&gt; en general es de alta dimensionalidad, (60000 palabras para el castellano, por ejemplo) y aquí &lt;strong&gt;la maldición de la dimensionalidad&lt;/strong&gt; (&lt;em&gt;curse of dimensionality&lt;/em&gt;) se presenta nuevamente como un problema. &lt;/p&gt;
&lt;p&gt;Al respecto, podemos normalizar los vectores y obtener mejores resultados con la distancia coseno, y otras métricas diseñadas para este problema como por ejemplo &lt;a href="https://dl.acm.org/citation.cfm?doid=1639714.1639757"&gt;OKAPI BM25&lt;/a&gt;&lt;/p&gt;
&lt;h2 id="manejo-de-sinonimos"&gt;Manejo de sinónimos&lt;/h2&gt;
&lt;p&gt;Puede ocurrir que dos palabras son iguales pero tienen distintos significados, lo que complica las comparaciones. Al respecto existen técnicas como&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;em&gt;Latent semantic Indexing&lt;/em&gt;&lt;/li&gt;
&lt;li&gt;&lt;em&gt;Latent dirichlet allocation&lt;/em&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id="tecnicas-de-procesamiento-adicionales"&gt;Técnicas de procesamiento adicionales&lt;/h2&gt;
&lt;p&gt;El análisis de texto presenta otro tipo de problemas, pudiendo encontrarse&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;palabras mal escritas&lt;/li&gt;
&lt;li&gt;calidad del texto&lt;/li&gt;
&lt;li&gt;redacción pobre&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Para esto se pueden usar algunas técnicas auxiliares, como por ejemplo&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Normalización: pasar todo a minúsculas o mayúsculas&lt;/li&gt;
&lt;li&gt;Tokenización: Dividir una oración en unidades o &lt;em&gt;tokens&lt;/em&gt;. La tokenización depende de cada implementación.&lt;/li&gt;
&lt;li&gt;&lt;em&gt;Stemming&lt;/em&gt;: Tomar la raíz (&lt;em&gt;stem&lt;/em&gt;) de las palabras que compartan una raíz semántica (por ejemplo &lt;em&gt;auto&lt;/em&gt; en &lt;em&gt;Automovilismo&lt;/em&gt; y &lt;em&gt;Autopista&lt;/em&gt;)&lt;/li&gt;
&lt;li&gt;&lt;em&gt;Porter&lt;/em&gt;: &lt;em&gt;Stem&lt;/em&gt; de las primeras letras que se repiten.&lt;/li&gt;
&lt;li&gt;&lt;em&gt;Krovetz&lt;/em&gt;: &lt;em&gt;Stem&lt;/em&gt;, pero asociada a una palabra existente.&lt;/li&gt;
&lt;li&gt;&lt;em&gt;Lemmatization&lt;/em&gt;: Una variante de &lt;em&gt;stemming&lt;/em&gt; que incorpora el análisis morfológico del texto. Ver más información &lt;a href="https://nlp.stanford.edu/IR-book/html/htmledition/stemming-and-lemmatization-1.html"&gt;aquí&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id="en-python"&gt;En python&lt;/h2&gt;
&lt;p&gt;En python existen dos librerías importantes para esto,&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="www.nltk.org"&gt;NLTK&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://spacy.io"&gt;Spacy&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Aparentemente NLTK tiene más funcionalidades pero su diseño no permite escalar de
la mejor manera. Spacy, al contrario, presenta menos funcionalidades (aunque suficientes) y utiliza &lt;em&gt;defaults&lt;/em&gt; aptos para su uso en la industria.&lt;/p&gt;
&lt;p&gt;En inglés se dice que una librería es &lt;em&gt;opinionated&lt;/em&gt; cuando impone ciertos patrones y procedimientos con base en la experiencia de los creadores de la herramienta. Un ejemplo de esto es &lt;em&gt;ruby on rails&lt;/em&gt; o &lt;em&gt;django&lt;/em&gt; para desarrollo web.&lt;/p&gt;
&lt;p&gt;Esto se podría traducir como un diseño &lt;em&gt;dogmático&lt;/em&gt;, aunque esta traducción no me gusta del todo.&lt;/p&gt;
&lt;h2 id="a-continuacion"&gt;A continuación&lt;/h2&gt;
&lt;p&gt;Esto es todo por esta vez. En la &lt;a href="https://diegoquintanav.github.io/recsys-4-ES.html"&gt;parte 4&lt;/a&gt; se verán&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Sistemas recomendadores híbridos&lt;/li&gt;
&lt;li&gt;Métricas de calidad en sistemas recomendadores&lt;/li&gt;
&lt;/ul&gt;
&lt;script type="text/javascript"&gt;if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) {
    var align = "center",
        indent = "0em",
        linebreak = "false";

    if (false) {
        align = (screen.width &lt; 768) ? "left" : align;
        indent = (screen.width &lt; 768) ? "0em" : indent;
        linebreak = (screen.width &lt; 768) ? 'true' : linebreak;
    }

    var mathjaxscript = document.createElement('script');
    mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#';
    mathjaxscript.type = 'text/javascript';
    mathjaxscript.src = 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.3/latest.js?config=TeX-AMS-MML_HTMLorMML';
    mathjaxscript[(window.opera ? "innerHTML" : "text")] =
        "MathJax.Hub.Config({" +
        "    config: ['MMLorHTML.js']," +
        "    TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } }," +
        "    jax: ['input/TeX','input/MathML','output/HTML-CSS']," +
        "    extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']," +
        "    displayAlign: '"+ align +"'," +
        "    displayIndent: '"+ indent +"'," +
        "    showMathMenu: true," +
        "    messageStyle: 'normal'," +
        "    tex2jax: { " +
        "        inlineMath: [ ['\\\\(','\\\\)'] ], " +
        "        displayMath: [ ['$$','$$'] ]," +
        "        processEscapes: true," +
        "        preview: 'TeX'," +
        "    }, " +
        "    'HTML-CSS': { " +
        "        styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'inherit ! important'} }," +
        "        linebreaks: { automatic: "+ linebreak +", width: '90% container' }," +
        "    }, " +
        "}); " +
        "if ('default' !== 'default') {" +
            "MathJax.Hub.Register.StartupHook('HTML-CSS Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax['HTML-CSS'].FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
            "MathJax.Hub.Register.StartupHook('SVG Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax.SVG.FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
        "}";
    (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript);
}
&lt;/script&gt;</summary><category term="recsys"></category></entry><entry><title>Sistemas recomendadores, parte 2</title><link href="https://diegoquintanav.github.io/recsys-2-ES.html" rel="alternate"></link><published>2018-11-25T19:15:00-06:00</published><updated>2018-11-25T19:15:00-06:00</updated><author><name>Diego Quintana</name></author><id>tag:diegoquintanav.github.io,2017-10-28:recsys-2-ES.html</id><summary type="html">&lt;div class="toc"&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="#previously"&gt;Previously&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#tipos-de-recomendadores"&gt;Tipos de recomendadores&lt;/a&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href="#segun-el-agente-que-controla-el-sr"&gt;Según el agente que controla el SR&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#segun-la-forma-que-los-modelos-aprenden"&gt;Según la forma que los modelos aprenden&lt;/a&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href="#metricas-de-similitud"&gt;Métricas de similitud&lt;/a&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href="#similitud-coseno"&gt;Similitud coseno&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#correlacion-de-pearson"&gt;Correlación de Pearson&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#similitud-coseno-ajustada"&gt;Similitud coseno ajustada&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;a href="#otra-propuesta-de-clasificacion"&gt;Otra propuesta de clasificación&lt;/a&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href="#basados-en-reglas-rule-based"&gt;Basados en reglas (Rule based)&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#basados-en-contenido-content-based"&gt;Basados en contenido (Content based)&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#filtrado-colaborativo-user-based"&gt;Filtrado colaborativo (User based)&lt;/a&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href="#clasificacion-de-recomendadores-basados-en-filtrado-colaborativo"&gt;Clasificación de recomendadores basados en filtrado colaborativo&lt;/a&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href="#user-based-collaborative-filtering-ub-cf"&gt;User Based Collaborative Filtering (UB-CF)&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#item-based-collaborative-filtering-ib-cf"&gt;Item Based collaborative filtering (IB-CF)&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;a href="#sistemas-hibridos"&gt;Sistemas híbridos&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;a href="#a-continuacion"&gt;A continuación&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#anexo-knn-y-la-maldicion-de-la-dimensionalidad"&gt;Anexo: KNN y la maldición de la dimensionalidad&lt;/a&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href="#k-nearest-neighbors-knn"&gt;K Nearest neighbors (KNN)&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;a href="#la-maldicion-de-la-dimensionalidad-o-curse-of-dimensionality"&gt;La maldición de la dimensionalidad (o Curse of dimensionality)&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;h1 id="previously"&gt;&lt;em&gt;Previously&lt;/em&gt;&lt;/h1&gt;
&lt;p&gt;En la &lt;a href="https://diegoquintanav.github.io/recsys-1-ES.html"&gt;parte 1&lt;/a&gt; se vieron varios aspectos elementales
de los sistemas recomendadores. El concepto del error, Un modelo inicial de una
recomendación, y la necesidad que cubren estos sistemas. 
Mencionamos &lt;a href="http://citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.423.5258&amp;amp;rep=rep1&amp;amp;type=pdf"&gt;este paper&lt;/a&gt; 
con deficiones más rigurosas. La idea ahora es introducir algunos conceptos generales
sobre los tipos de sistemas recomendadores.&lt;/p&gt;
&lt;p&gt;Podemos agrupar clasificadores según sus características. &lt;a href="http://citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.702.4429&amp;amp;rep=rep1&amp;amp;type=pdf"&gt;Este paper&lt;/a&gt; presenta algunas directrices, las que serán reflejadas aquí de manera 
menos rigurosa.&lt;/p&gt;
&lt;h1 id="tipos-de-recomendadores"&gt;Tipos de recomendadores&lt;/h1&gt;
&lt;h2 id="segun-el-agente-que-controla-el-sr"&gt;Según el agente que &lt;em&gt;controla&lt;/em&gt; el &lt;em&gt;SR&lt;/em&gt;&lt;/h2&gt;
&lt;p&gt;El agente se refiere aquí a quién &lt;em&gt;entrena&lt;/em&gt; al recomendador. Al respecto se indican&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Sistemas customizados&lt;/li&gt;
&lt;li&gt;Sistemas personalizados&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;El primero es aquel en que &lt;em&gt;el usuario&lt;/em&gt; modifica su perfil manualmente en base a sus preferencias, mientras que en el segundo es la implementación del &lt;em&gt;SR&lt;/em&gt; la 
que crea y actualiza el perfil para cada usuario, con control explícito mínimo del usuario, e incluso nulo en algunas ocasiones.&lt;/p&gt;
&lt;h2 id="segun-la-forma-que-los-modelos-aprenden"&gt;Según la forma que los modelos aprenden&lt;/h2&gt;
&lt;p&gt;Esta clasificación es más primitiva, y da lugar a&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Sistemas &lt;em&gt;basados en memoria&lt;/em&gt;&lt;/li&gt;
&lt;li&gt;Sistemas &lt;em&gt;basados en modelos&lt;/em&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Los primeros son aquellos que &lt;strong&gt;usan datos&lt;/strong&gt; i.e clicks, ratings, votos, etc. y establecen una métrica de similitud entre usuarios o ítems. Estas métricas pueden ser de diversos tipos, entre las cuales conviene mencionar&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Similitud coseno&lt;/li&gt;
&lt;li&gt;Correlación de pearson&lt;/li&gt;
&lt;li&gt;Distancia euclidiana&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Estas recomendaciones permiten establecer distancias entre personas y/o ítems. Si consideramos una matriz &lt;span class="math"&gt;\(M\)&lt;/span&gt; donde los usuarios son filas y los ítems columnas, los &lt;em&gt;SR&lt;/em&gt; basados en memoria establecen similitud entre dos vectores, pudiendo ser&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Entre usuarios (dos o más filas) &lt;/li&gt;
&lt;li&gt;Entre ítems (dos o más columnas)&lt;/li&gt;
&lt;li&gt;Entre un usuario y un ítem&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Este tipo de modelos presentan algunos problemas debido a las características de &lt;span class="math"&gt;\(M\)&lt;/span&gt;, como por ejemplo&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;El tamaño de &lt;span class="math"&gt;\(M\)&lt;/span&gt; es muy grande: Si la cantidad de datos es masiva, algunos algoritmos que operan sobre todo &lt;span class="math"&gt;\(M\)&lt;/span&gt; se vuelven costosos (Como se verá en KNN más adelante)&lt;/li&gt;
&lt;li&gt;Densidad de datos: No todos los items o usuarios tienen información i.e. un usuario por lo general no vota en todas las películas de IMDB, sino que sólo en aquellas que le interesan. Esto genera vectores más dispersos o con más elementos vacíos.&lt;/li&gt;
&lt;li&gt;El problema de la partida en frío o &lt;em&gt;Cold start&lt;/em&gt;. Cuando un recomendador comienza
no tiene información de ratings, por lo que no puede recomendar nada. El problema
implica entonces el cómo se completa inicialmente esta información. Esto también es válido para nuevos usuarios que no han definido sus preferencias o presentan pocos ratings.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;Por el otro lado, los &lt;strong&gt;&lt;em&gt;SR&lt;/em&gt; basados en modelos&lt;/strong&gt; tratan de completar esta matriz con probabilidades de que un usuario valore positivamente un ítem que no había encontrado antes. Para esto se apoyan en algoritmos de aprendizaje automático o &lt;em&gt;machine learning&lt;/em&gt;.&lt;/p&gt;
&lt;h3 id="metricas-de-similitud"&gt;Métricas de similitud&lt;/h3&gt;
&lt;h4 id="similitud-coseno"&gt;Similitud coseno&lt;/h4&gt;
&lt;p&gt;Si se consideran dos vectores de dimensionalidad &lt;span class="math"&gt;\(m\)&lt;/span&gt;, se define la similitud entre ambos a través del cálculo del &lt;em&gt;coseno&lt;/em&gt; del ángulo entre ambos vectores. Formalmente, Si consideramos la matriz &lt;span class="math"&gt;\(M\)&lt;/span&gt; de &lt;span class="math"&gt;\(m\)&lt;/span&gt; usuarios y &lt;span class="math"&gt;\(n\)&lt;/span&gt; items, la similitud entre dos elementos está dada por&lt;/p&gt;
&lt;div class="math"&gt;$$sim(i,j) = \cos (\vec{i},\vec{j}) = \frac{\vec{i} \cdot \vec{j}}{ { \lVert \vec{i} \rVert }_{2} \ast { \lVert \vec{j} \rVert }_{2} }$$&lt;/div&gt;
&lt;h4 id="correlacion-de-pearson"&gt;Correlación de Pearson&lt;/h4&gt;
&lt;p&gt;Una métrica de similitud se obtiene a través de la correlación de Pearson. Esta permite aislar los casos donde ocurra &lt;em&gt;co-validación&lt;/em&gt; i.e. aquellos casos en que el usuario ha validado ítems &lt;span class="math"&gt;\(i\)&lt;/span&gt; y &lt;span class="math"&gt;\(j\)&lt;/span&gt; (ver imagen, obtenida del paper).&lt;/p&gt;
&lt;div class="math"&gt;$$sim(i,j) = \frac{ \sum_{u \in \mathcal{U}}(r_{u,i}-\bar{r}_{i})(r_{u,j}-\bar{r}_{j}) }{ \sqrt{\sum_{u \in \mathcal{U}}(r_{u,i}-\bar{r}_{i})^2} \sqrt{\sum_{u \in \mathcal{U}}(r_{u,i}-\bar{r}_{j})^2} }$$&lt;/div&gt;
&lt;p&gt;Donde &lt;span class="math"&gt;\(r_{u,j}\)&lt;/span&gt; es el rating del usuario &lt;span class="math"&gt;\(u\)&lt;/span&gt; sobre el ítem &lt;span class="math"&gt;\(j\)&lt;/span&gt; y &lt;span class="math"&gt;\(\bar{r}_{j}\)&lt;/span&gt; es el &lt;em&gt;rating&lt;/em&gt; promedio sobre el otro ítem.&lt;/p&gt;
&lt;p&gt;&lt;img alt="IB-CF1" src="https://diegoquintanav.github.io/images/CF-IB_1.png" title="IB-CF" /&gt;&lt;/p&gt;
&lt;h4 id="similitud-coseno-ajustada"&gt;Similitud coseno ajustada&lt;/h4&gt;
&lt;p&gt;Se obtiene incorporando el promedio &lt;span class="math"&gt;\(\bar{r}_{u}\)&lt;/span&gt; de votos de cada usuario en el cálculo de similitud, es decir&lt;/p&gt;
&lt;div class="math"&gt;$$sim(i,j) = \frac{ \sum_{u \in \mathcal{U}}(r_{u,i}-\bar{r}_{u})(r_{u,j}-\bar{r}_{u}) }{ \sqrt{\sum_{u \in \mathcal{U}}(r_{u,i}-\bar{r}_{u})^2} \sqrt{\sum_{u \in \mathcal{U}}(r_{u,i}-\bar{r}_{u})^2} }$$&lt;/div&gt;
&lt;p&gt;De los tres métodos indicados, es esta noción de similitud la que obtiene mejores resultados&lt;/p&gt;
&lt;p&gt;&lt;img alt="IB-CF2" src="https://diegoquintanav.github.io/images/similarities.png" title="Similarities comparison" /&gt;&lt;/p&gt;
&lt;h2 id="otra-propuesta-de-clasificacion"&gt;Otra propuesta de clasificación&lt;/h2&gt;
&lt;p&gt;También es posible dividir los &lt;em&gt;SR&lt;/em&gt; en cuatro grandes grupos, con base en&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;El tipo de datos de entrada que utilizan&lt;/li&gt;
&lt;li&gt;La forma en que construyen perfiles de usuario&lt;/li&gt;
&lt;li&gt;Los métodos algorítmicos usados para producir recomendaciones&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Estos son&lt;/p&gt;
&lt;h3 id="basados-en-reglas-rule-based"&gt;Basados en reglas (&lt;em&gt;Rule based&lt;/em&gt;)&lt;/h3&gt;
&lt;p&gt;Las reglas son definidas manual y explícitamente en función de los objetivos del 
&lt;em&gt;SR&lt;/em&gt;, por lo que tienden a ser más rígidos y a depender más de conocimiento 
experto. Esto ocurre mucho en sitios de &lt;em&gt;e-commerce&lt;/em&gt;, donde los &lt;em&gt;SR&lt;/em&gt; reflejan en 
gran medida los intereses de la compañía.&lt;/p&gt;
&lt;p&gt;La gran desventaja de estos &lt;em&gt;SR&lt;/em&gt; es que dependen de reglas explícitas, y que 
alimentan los perfiles en base a la ingesta manual de intereses del usuario. Todo 
esto incluye un sesgo que entorpece el dinamismo del &lt;em&gt;SR&lt;/em&gt; ante nuevos escenarios.&lt;/p&gt;
&lt;h3 id="basados-en-contenido-content-based"&gt;Basados en contenido (&lt;em&gt;Content based&lt;/em&gt;)&lt;/h3&gt;
&lt;p&gt;La principal característica de este &lt;em&gt;SR&lt;/em&gt; es que sus recomendaciones se basan en los 
ítems que el usuario ha demostrado interés explícito anteriormente (ejemplo &lt;em&gt;"Add 
to my wishlist&lt;/em&gt;"). &lt;/p&gt;
&lt;p&gt;Estos recomendadores usan métricas de similitud a través de algoritmos de clasificación, &lt;em&gt;clustering&lt;/em&gt; o análisis de texto. Un ejemplo es un recomendador que se basa de las descripciones de productos.&lt;/p&gt;
&lt;p&gt;Uno de los contras de estos &lt;em&gt;SR&lt;/em&gt; es que dependen de los hábitos y gustos de un 
usuario para poder recomendar nuevos ítems, lo que produce una burbuja. &lt;/p&gt;
&lt;p&gt;Esto se traduce en los siguientes problemas de recomendación&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;em&gt;¿Cómo puedo recomendar productos nuevos a alguien si no sabe que existen?&lt;/em&gt;&lt;/li&gt;
&lt;li&gt;&lt;em&gt;¿Cómo decido qué nuevos productos presentarle primero?&lt;/em&gt; &lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;En estos casos los ítems más novedosos son la mejor elección.&lt;/p&gt;
&lt;h3 id="filtrado-colaborativo-user-based"&gt;Filtrado colaborativo (&lt;em&gt;User based&lt;/em&gt;)&lt;/h3&gt;
&lt;p&gt;Apuntan a resolver los problemas presentes en los dos &lt;em&gt;SR&lt;/em&gt; anteriores, utilizando 
los datos como clicks y ratings de otros usuarios en la &lt;em&gt;vecindad&lt;/em&gt; del usuario 
usando el &lt;em&gt;SR&lt;/em&gt;.&lt;/p&gt;
&lt;p&gt;Tradicionalmente, estos sistemas se dicen &lt;em&gt;Basados en memoria&lt;/em&gt; (&lt;em&gt;Memory based&lt;/em&gt;, un 
término que se considera a veces obsoleto, y que a veces es reemplazado por &lt;em&gt;User 
based&lt;/em&gt; o &lt;em&gt;Item based&lt;/em&gt;), o dicho de otra forma, necesitan tener la información de 
los intereses de &lt;em&gt;todos&lt;/em&gt; los usuarios para poder emitir una recomendación. Un 
ejemplo de un algoritmo muy usado en &lt;em&gt;clustering&lt;/em&gt; esto es el algoritmo de &lt;span class="math"&gt;\(k\)&lt;/span&gt; 
vecinos cercanos o &lt;strong&gt;KNN&lt;/strong&gt; (&lt;em&gt;K Nearest Neighbors&lt;/em&gt;).&lt;/p&gt;
&lt;p&gt;Un problema que presentan estos &lt;em&gt;SR&lt;/em&gt; es que operan sobre datasets por lo general 
con poca información. Por ejemplo digamos que un usuario puede haberse manifestado 
sobre dos productos en un conjunto de 1000 productos. El vector de ratings para 
este usuario sería de la forma&lt;/p&gt;
&lt;div class="math"&gt;$$x_{i} = {0,...,r_{34},r_{35},...,0}$$&lt;/div&gt;
&lt;p&gt;donde &lt;span class="math"&gt;\(r_{34}\)&lt;/span&gt; y &lt;span class="math"&gt;\(r_{35}\)&lt;/span&gt; serían dos votaciones distintas de cero. Se tiene 
entonces que existen 998 ceros que no aportan información alguna, lo que se 
transforma en recomendaciones de mala calidad al comienzo de la creación de un 
perfil de usuario. Si consideramos que constantemente se agregan nuevos ítems, este 
dataset se diluye cada vez más.&lt;/p&gt;
&lt;p&gt;Otro problema que existen en este tipo de &lt;em&gt;SR&lt;/em&gt; es el &lt;em&gt;new item problem&lt;/em&gt;. Cuando un 
nuevo item es añadido al pool de opciones, no existe en ningún perfil de usuario y 
el &lt;em&gt;SR&lt;/em&gt; no puede recomendárselo a nadie.&lt;/p&gt;
&lt;p&gt;Finalmente, uno de los pincipales problemas que presentan estos algoritmos es que 
no son escalables. Por ejemplo, para el algoritmo KNN, la formación de &lt;em&gt;clusters&lt;/em&gt; obtiene un modelo utilizando todo el conjunto de datos a la vez, lo cual presenta
problemas si pensamos que la generación de nuevos ratings y productos puede ocurrir con mucha frecuencia, incluso a diario.&lt;/p&gt;
&lt;h4 id="clasificacion-de-recomendadores-basados-en-filtrado-colaborativo"&gt;Clasificación de recomendadores basados en filtrado colaborativo&lt;/h4&gt;
&lt;p&gt;El filtrado colaborativo puede dividirse en dos grandes grupos, dependiendo sobre cuál es la entidad usada para establecer patrones o &lt;em&gt;clusters&lt;/em&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;filtrado colaborativo basado en usuarios (UB-CF)&lt;/li&gt;
&lt;li&gt;filtrado colaborativo basado en ítems (IB-CF)&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Si se considera la matriz &lt;span class="math"&gt;\(M\)&lt;/span&gt; indicada anteriormente, donde las filas son usuarios 
y las columnas ítems, entonces una diferencia fundamental entre estos grupos es el 
eje sobre el cual se establece la similitud, siendo las filas para el primer caso y 
las columnas para el segundo.&lt;/p&gt;
&lt;p&gt;La importancia de esto es que cada par en el conjunto a calcular corresponde a 
usuarios distintos. Esto tiene algunas desventajas, como la pérdida de escala entre 
usuarios i.e. no todos los usarios evalúan el mismo ítem de la misma manera, y este 
factor se diluye entre todos los usuarios. Una forma de resolver es con la 
&lt;em&gt;similitud coseno ajustada&lt;/em&gt;.&lt;/p&gt;
&lt;p&gt;Al respecto existen varios tipos de algoritmos basados en el filtrado colaborativo, y dos ejemplos pueden ser&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="https://arxiv.org/abs/cs/0702144"&gt;Slope One&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;FunkSVD, &lt;a href="http://sifter.org/simon/journal/20061211.html"&gt;ganador del premio Netflix&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h5 id="user-based-collaborative-filtering-ub-cf"&gt;User Based Collaborative Filtering (UB-CF)&lt;/h5&gt;
&lt;p&gt;Se puede resumir como&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;La predicción del rating sobre un ítem &lt;span class="math"&gt;\(i\)&lt;/span&gt; mejora mientras más vecinos &lt;span class="math"&gt;\(k\)&lt;/span&gt; de un 
   &lt;em&gt;pool&lt;/em&gt; de &lt;span class="math"&gt;\(n\)&lt;/span&gt; elementos de dimensión &lt;span class="math"&gt;\(d\)&lt;/span&gt; se consideren en el cálculo de similitud.&lt;/li&gt;
&lt;li&gt;La complejidad de calcular la distancia a un ejemplo es de &lt;span class="math"&gt;\(\mathcal{O}(d)\)&lt;/span&gt;&lt;/li&gt;
&lt;li&gt;La complejidad de calcular la distancia a &lt;span class="math"&gt;\(n\)&lt;/span&gt; ejemplos es de &lt;span class="math"&gt;\(\mathcal{O}(dn)\)&lt;/span&gt;&lt;/li&gt;
&lt;li&gt;Una vez calculadas las &lt;span class="math"&gt;\(n\)&lt;/span&gt; distancias, la complejidad de recorrer los &lt;span class="math"&gt;\(k\)&lt;/span&gt; 
   vecinos más cercanos es de &lt;span class="math"&gt;\(\mathcal{O}(nk)\)&lt;/span&gt;&lt;/li&gt;
&lt;li&gt;El tiempo total entonces es de &lt;span class="math"&gt;\(\mathcal{O}(nd+nk)\)&lt;/span&gt;, (o &lt;span class="math"&gt;\(\mathcal{O}(ndk)\)&lt;/span&gt; 
   &lt;a href="https://stats.stackexchange.com/questions/219655/k-nn-computational-complexity"&gt;en función de cómo se recorren los elementos.&lt;/a&gt;) lo cual vuelve a KNN un algoritmo costoso cuando &lt;span class="math"&gt;\(n\)&lt;/span&gt; es lo suficientemente grande.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;Un &lt;em&gt;SR&lt;/em&gt; alternativo al &lt;em&gt;User Based&lt;/em&gt; (UB-CF) es la del filtrado colaborativo basado en &lt;em&gt;ítems&lt;/em&gt;, o &lt;em&gt;Item based collaborative filtering (IB-CF)&lt;/em&gt;&lt;/p&gt;
&lt;h5 id="item-based-collaborative-filtering-ib-cf"&gt;Item Based collaborative filtering (IB-CF)&lt;/h5&gt;
&lt;p&gt;Nacen de la necesidad de generar recomendaciones más rápidas sobre datasets masivos,
para los cuales los algoritmos de tipo UB-CF no escalan bien. &lt;/p&gt;
&lt;p&gt;Estas técnicas analizan primero la matriz de usuarios e ítems &lt;span class="math"&gt;\(M\)&lt;/span&gt; para identificar 
relaciones entre diferentes ítems, y a través de éstas computar calcular de manera 
indirecta nuevas relaciones con los usuarios.&lt;/p&gt;
&lt;p&gt;Dicho de otra forma, estos algoritmos exploran las relaciones entre ítems similares,
en vez de realizarla sobre usuarios similares. De esta manera las recomendaciones 
nuevas se logran encontrando ítems similares a otros que el usuario &lt;span class="math"&gt;\(u\)&lt;/span&gt; ha 
calificado positivamente. Dado que las relaciones entre ítems es &lt;em&gt;relativamente&lt;/em&gt; 
estática (a diferencia de los gustos de los usuarios, que son más dinámicos), estas 
recomendaciones tienden a ser más estables en el tiempo.&lt;/p&gt;
&lt;p&gt;De la misma manera que en el caso de UB-CF, algunas métricas de similitud pueden ser la &lt;em&gt;correlación entre ítems&lt;/em&gt;, o &lt;em&gt;similitud coseno&lt;/em&gt;. &lt;a href="http://files.grouplens.org/papers/www10_sarwar.pdf"&gt;Este paper&lt;/a&gt; hace una revisión de los métodos indicados, y concluye que este tipo de &lt;em&gt;SR&lt;/em&gt; poseen un rendimiento superior, además de proveer mejores recomendaciones que su compañero UB-CF.&lt;/p&gt;
&lt;h3 id="sistemas-hibridos"&gt;Sistemas híbridos&lt;/h3&gt;
&lt;p&gt;Los &lt;em&gt;SR&lt;/em&gt; basados en contenido y en filtrado colaborativo presentan sus propios problemas. Los sistemas híbridos apuntan a resolver estas limitaciones a través de
combinaciones de otros &lt;em&gt;SR&lt;/em&gt;&lt;/p&gt;
&lt;h2 id="a-continuacion"&gt;A continuación&lt;/h2&gt;
&lt;p&gt;En la &lt;a href="https://diegoquintanav.github.io/recsys-3-ES.html"&gt;parte 3&lt;/a&gt; se verán los sistemas de recomendación basados en contenido con mayor detalle.&lt;/p&gt;
&lt;h2 id="anexo-knn-y-la-maldicion-de-la-dimensionalidad"&gt;Anexo: KNN y la maldición de la dimensionalidad&lt;/h2&gt;
&lt;p&gt;(o en inglés, &lt;em&gt;curse of dimensionality&lt;/em&gt;)&lt;/p&gt;
&lt;h3 id="k-nearest-neighbors-knn"&gt;K &lt;em&gt;Nearest neighbors&lt;/em&gt; (KNN)&lt;/h3&gt;
&lt;p&gt;Este algoritmo crea modelos de grupos o &lt;em&gt;clusters&lt;/em&gt; de usuarios o ítem que guardan 
relación entre sí de acuerdo a una métrica preestablecida. La idea de KNN en el 
contexto de recomendación es, en términos simples:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Para un subconjunto de usuarios &lt;span class="math"&gt;\(\mathcal{U} \in U\)&lt;/span&gt;, encuentra los ratings para
un item &lt;span class="math"&gt;\(i \in I\)&lt;/span&gt; sobre los primeros &lt;span class="math"&gt;\(k\)&lt;/span&gt; usuarios (vecinos en este contexto) que 
sean &lt;em&gt;objetivamente&lt;/em&gt; similares a un usuario &lt;span class="math"&gt;\(u \in \mathcal{U}\)&lt;/span&gt;\$.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;¿Pero cómo se logra establecer similitud &lt;em&gt;objetivamente&lt;/em&gt;?. Se mide la distancia 
entre dos objetos y vemos si la distancia es lo suficientemente pequeña. Esto se 
puede conseguir generalmente a través de una distancia euclidiana o coseno. &lt;a href="https://blog.dominodatalab.com/recommender-systems-collaborative-filtering/"&gt;Esta página tiene algunas definiciones sobre esto, y presenta algunos ejemplos usando Python&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Con una definición &lt;em&gt;más rigurosa&lt;/em&gt;, decimos que el &lt;em&gt;rating&lt;/em&gt; de un 
usuario sobre un item a predecir, es la suma ponderada de los &lt;em&gt;ratings&lt;/em&gt; de otros 
&lt;span class="math"&gt;\(k\)&lt;/span&gt; usuarios sobre el mismo ítem que comparten similitud.&lt;/p&gt;
&lt;div class="math"&gt;$$R(u,i) = \bar{r}_u + \alpha \sum_{j=1}^{k} w(u,j)(r_{j,i}-\bar{r}_j)$$&lt;/div&gt;
&lt;p&gt;donde 
- &lt;span class="math"&gt;\(\alpha\)&lt;/span&gt; es un elemento de &lt;em&gt;regularización&lt;/em&gt;
- &lt;span class="math"&gt;\(\bar{r}_u\)&lt;/span&gt; es el promedio de votos del usuario &lt;span class="math"&gt;\(u\)&lt;/span&gt;
- &lt;span class="math"&gt;\((r_{j,i}-\bar{r}_j)\)&lt;/span&gt; es el voto de cada usuario o vecino sobre el ítem &lt;span class="math"&gt;\(i\)&lt;/span&gt; menos el promedio de sus votos
- &lt;span class="math"&gt;\(w(u,j)\)&lt;/span&gt; es una función que asigna un peso a cada una de estas valoraciones.&lt;/p&gt;
&lt;h2 id="la-maldicion-de-la-dimensionalidad-o-curse-of-dimensionality"&gt;La maldición de la dimensionalidad (o &lt;em&gt;Curse of dimensionality&lt;/em&gt;)&lt;/h2&gt;
&lt;p&gt;&lt;img alt="curse-of-dimenzionality" src="https://diegoquintanav.github.io/images/curse-of-dimensionality.png" title="omgsocursed" /&gt;&lt;/p&gt;
&lt;p&gt;(Kudos al &lt;a href="https://erikbern.com/2015/10/20/nearest-neighbors-and-vector-models-epilogue-curse-of-dimensionality.html"&gt;maravilloso ser humano que hizo la imagen.&lt;/a&gt;)&lt;/p&gt;
&lt;p&gt;Básicamente se trata de lo siguiente: Mientras más características tengan los 
vectores usados en la modelación de un ítem o recomendación, la distancia entre dos 
elementos &lt;strong&gt;pierde significancia&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;En términos de un CSV o un &lt;em&gt;dataframe&lt;/em&gt;, el número de &lt;em&gt;columnas&lt;/em&gt; que tiene afecta las medidas entre 
las &lt;em&gt;filas&lt;/em&gt;. &lt;/p&gt;
&lt;p&gt;Suponiendo un conjunto &lt;span class="math"&gt;\(X\)&lt;/span&gt; de datos &lt;span class="math"&gt;\(x_i\)&lt;/span&gt;, cada uno con &lt;span class="math"&gt;\(d\)&lt;/span&gt; dimensiones, se tiene que la &lt;strong&gt;proporción&lt;/strong&gt; entre la distancia de cualquier punto hacia el centroide de &lt;span class="math"&gt;\(X\)&lt;/span&gt; (o donde se concentra la mayor cantidad de puntos) y otro punto dentro del mismo espacio se diluye a &lt;span class="math"&gt;\(0\)&lt;/span&gt; &lt;em&gt;en el infinito&lt;/em&gt;.&lt;/p&gt;
&lt;p&gt;Dicho de otra forma, ambas distancias se vuelven &lt;em&gt;relativamente similares&lt;/em&gt;.&lt;/p&gt;
&lt;p&gt;&lt;em&gt;The curse of dimensionality&lt;/em&gt; es un tema recurrente en los &lt;em&gt;SR&lt;/em&gt;, y me limitaré a recorrer algunas lecturas muy completas sobre el tema:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="https://stats.stackexchange.com/questions/169156/explain-curse-of-dimensionality-to-a-child"&gt;&lt;em&gt;Explain Like I am Five Years Old&lt;/em&gt;&lt;/a&gt; tiene una versión muy simple del problema. En galletas.&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;Imagina que debes elegir qué galletas te gustan de un camión de galletas, en 
base al sabor. Asumiendo que hay cuatro tipos de sabores (dulce, salado, ácido, 
amargo), bastaría con encontrar 4 tipos de galletas diferentes para saber cuál te 
gusta más. Si a esto añadimos además una característica de color y asumiendo que 
sólo hay cuatro colores, entonces tienes que comer 4x4 tipos de galletas 
distintas. Asumiendo que la descripción de galleta se hace cada vez más compleja, y ahora incluye el olor de la galleta. Luego la marca.
A medida que las características de la galleta a considerar aumenta, resulta cada vez más difícil saber qué galletas te gustan, y probablemente sufras 
un dolor de estómago antes de poder decidir.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="https://math.stackexchange.com/questions/346775/confusion-related-to-curse-of-dimensionality-in-k-nearest-neighbor"&gt;Este post&lt;/a&gt; también es una discusión interesante sobre el tema.&lt;/li&gt;
&lt;li&gt;&lt;a href="https://erikbern.com/2015/10/20/nearest-neighbors-and-vector-models-epilogue-curse-of-dimensionality.html"&gt;Este blog&lt;/a&gt; tiene más información aún ~~además de ahorrarme el tiempo de hacer mi propia imagen~~.&lt;/li&gt;
&lt;li&gt;&lt;a href="http://www.visiondummy.com/2014/04/curse-dimensionality-affect-classification/"&gt;Este otro post&lt;/a&gt; presenta una explicación más detallada, &lt;em&gt;que también incluye perritos.&lt;/em&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img alt="curse-of-dimenzinality" src="https://diegoquintanav.github.io/images/3Dproblem_separated.png" title="omgin3D" /&gt;&lt;/p&gt;
&lt;script type="text/javascript"&gt;if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) {
    var align = "center",
        indent = "0em",
        linebreak = "false";

    if (false) {
        align = (screen.width &lt; 768) ? "left" : align;
        indent = (screen.width &lt; 768) ? "0em" : indent;
        linebreak = (screen.width &lt; 768) ? 'true' : linebreak;
    }

    var mathjaxscript = document.createElement('script');
    mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#';
    mathjaxscript.type = 'text/javascript';
    mathjaxscript.src = 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.3/latest.js?config=TeX-AMS-MML_HTMLorMML';
    mathjaxscript[(window.opera ? "innerHTML" : "text")] =
        "MathJax.Hub.Config({" +
        "    config: ['MMLorHTML.js']," +
        "    TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } }," +
        "    jax: ['input/TeX','input/MathML','output/HTML-CSS']," +
        "    extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']," +
        "    displayAlign: '"+ align +"'," +
        "    displayIndent: '"+ indent +"'," +
        "    showMathMenu: true," +
        "    messageStyle: 'normal'," +
        "    tex2jax: { " +
        "        inlineMath: [ ['\\\\(','\\\\)'] ], " +
        "        displayMath: [ ['$$','$$'] ]," +
        "        processEscapes: true," +
        "        preview: 'TeX'," +
        "    }, " +
        "    'HTML-CSS': { " +
        "        styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'inherit ! important'} }," +
        "        linebreaks: { automatic: "+ linebreak +", width: '90% container' }," +
        "    }, " +
        "}); " +
        "if ('default' !== 'default') {" +
            "MathJax.Hub.Register.StartupHook('HTML-CSS Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax['HTML-CSS'].FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
            "MathJax.Hub.Register.StartupHook('SVG Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax.SVG.FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
        "}";
    (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript);
}
&lt;/script&gt;</summary><category term="recsys"></category></entry><entry><title>Sistemas recomendadores, parte 1</title><link href="https://diegoquintanav.github.io/recsys-1-ES.html" rel="alternate"></link><published>2018-11-24T13:10:00-06:00</published><updated>2018-11-24T13:10:00-06:00</updated><author><name>Diego Quintana</name></author><id>tag:diegoquintanav.github.io,2017-10-26:recsys-1-ES.html</id><summary type="html">&lt;div class="toc"&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="#por-que-esta-serie"&gt;Por qué esta serie&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#indice"&gt;Índice&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#sistemas-de-recomendacion"&gt;Sistemas de recomendación&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#modelando-la-confianza"&gt;Modelando la confianza&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#por-que-es-bueno-entender-los-sistemas-de-recomendacion"&gt;¿Por qué es bueno entender los sistemas de recomendación?&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#definicion-formal-del-problema"&gt;Definición formal del problema&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#metricas-de-prediccion"&gt;Métricas de predicción&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#conclusiones"&gt;Conclusiones&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#a-continuacion"&gt;A continuación&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;h1 id="por-que-esta-serie"&gt;Por qué esta serie&lt;/h1&gt;
&lt;p&gt;Me encuentro tomando el módulo de sistemas de recomendación en la PUC
(&lt;a href="https://educacionprofesional.ing.uc.cl/?diplomado=diplomado-big-data"&gt;programa&lt;/a&gt;)
con el profesor &lt;a href="http://dparra.sitios.ing.uc.cl/"&gt;Dennis Parra&lt;/a&gt; y como tarea del
 módulo se solicitó crear un post por clase, a modo de resumen.&lt;/p&gt;
&lt;h1 id="indice"&gt;Índice&lt;/h1&gt;
&lt;p&gt;La serie consiste de cinco posts, los que se resumen de la siguiente manera&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;En la &lt;a href="https://diegoquintanav.github.io/recsys-2-ES.html"&gt;parte 2&lt;/a&gt; se revisan las distintas
  clasificaciones de sistemas recomendadores o &lt;em&gt;SR&lt;/em&gt;, con énfasis en el &lt;em&gt;filtrado colaborativo&lt;/em&gt;&lt;/li&gt;
&lt;li&gt;En la parte 3 continuamos con la clasificación
  de sistemas recomendadores, y revisamos los &lt;em&gt;SR&lt;/em&gt; basados en contenido y el análisis de texto.&lt;/li&gt;
&lt;li&gt;Todos los &lt;em&gt;SR&lt;/em&gt; tienen sus desventajas y debilidades. En la parte 4
  revisamos cómo es posible combinar distintos &lt;em&gt;SR&lt;/em&gt; para sobreponerse a estas
  debilidades. También vemos cómo es posible evaluar un &lt;em&gt;SR&lt;/em&gt; y compararlo con
  otro a través de algunas métricas usadas en clasificación.&lt;/li&gt;
&lt;li&gt;Finalmente en la parte 5 revisamos las máquinas
  de factorización, un tipo de implementación de máquinas de vectores de
  soporte que da excelentes resultados en aplicaciones de recomendación y es extensible a otras áreas.&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id="sistemas-de-recomendacion"&gt;Sistemas de recomendación&lt;/h1&gt;
&lt;p&gt;Las recomendaciones son una parte importante de nuestra sociedad.
Seguimos recomendaciones de nuestros padres, amigos y compañeros. Las
seguimos porque de alguna forma, confiamos en ellos, su experiencia y
dado que (generalmente) tenemos una idea de las preferencias en nuestros
círculos, podemos estimar qué tipo de cosas nos pueden recomendar.&lt;/p&gt;
&lt;p&gt;Hasta cierto punto esto es cierto. Nuestros padres y cercanos no saben
de todo, y a veces tenemos que acudir al pensamiento colectivo que se encuentra.
en internet. Allí es posible encontrar contenidos curados y tratados por
gente que tiene un interés especial sobre algún tema.&lt;/p&gt;
&lt;p&gt;Algunos ejemplos de recomendaciones en internet podrían ser, para Chile y Santiago:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="http://www.paniko.cl/"&gt;Discos, medios en general&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://elpicadista.cl/"&gt;Picadas de comida&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="http://estoy.cl/"&gt;Actividades culturales en Santiago&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Sin embargo, tampoco podemos confiar ciegamente en la opinión de anónimos. Tampoco
resulta práctico leer todas las reseñas en internet. Debe existir algún tipo de
&lt;em&gt;cuantificar&lt;/em&gt; las recomendaciones, y alguna estrategia para &lt;em&gt;validarlas&lt;/em&gt;. 
No todas las recomendaciones son &lt;em&gt;buenas&lt;/em&gt; desde el punto de vista de cada uno.&lt;/p&gt;
&lt;h1 id="modelando-la-confianza"&gt;Modelando la confianza&lt;/h1&gt;
&lt;p&gt;La forma más elemental de validar algo en internet a través de votaciones, &lt;em&gt;ratings&lt;/em&gt;
o &lt;em&gt;likes&lt;/em&gt;. Esto nos permite tratar las opiniones de la gente como números, y permite
además extraer promedios, varianzas, &lt;em&gt;y todas esas cosas&lt;/em&gt;.&lt;/p&gt;
&lt;p&gt;El concepto de rating no es nuevo, y algunas de las aplicaciones que se apoyan en esto
son:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;a href="http://netflix.com/"&gt;Netflix&lt;/a&gt; recomienda películas&lt;/li&gt;
&lt;li&gt;&lt;a href="https://mubi.com/"&gt;Spotify&lt;/a&gt; recomienda música&lt;/li&gt;
&lt;li&gt;Facebook decide &lt;em&gt;qué contenidos y publicidad mostrar en el feed&lt;/em&gt;,
     en base a hábitos de navegación y clicks&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;Los sistemas de recomendación permiten lidiar con el problema de la &lt;strong&gt;sobrecarga de información&lt;/strong&gt;.
Sin estos modelos, lo natural sería que cada uno procesara esta información individualmente.&lt;/p&gt;
&lt;p&gt;Sería algo así como el equivalente de ir a una biblioteca a leer las
contraportadas de libros hasta que alguno parezca valer la pena. Volviendo a los ejemplos
anteriores,&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;En el año 2016, Netflix tenía alrededor de &lt;a href="http://time.com/4272360/the-number-of-movies-on-netflix-is-dropping-fast/"&gt;5500 títulos&lt;/a&gt;
  entre películas y series&lt;/li&gt;
&lt;li&gt;Para el año 2013, Spotify tenía alrededor de &lt;a href="https://www.digitalmusicnews.com/2013/10/11/songsonspotify/"&gt;20 millones&lt;/a&gt; de canciones.
 de ellas, al menos un 20% no había sido reproducida ni siquiera una vez. &lt;a href="https://open.spotify.com/album/0ke5cFySqu1XkaVM4RWUZk"&gt;Quizás algo commo esto&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;En el 2018 Facebook tiene alrededor de &lt;a href="https://www.statista.com/statistics/264810/number-of-monthly-active-facebook-users-worldwide/"&gt;2 billones de usuarios activos&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id="por-que-es-bueno-entender-los-sistemas-de-recomendacion"&gt;¿Por qué es bueno entender los sistemas de recomendación?&lt;/h1&gt;
&lt;p&gt;En general estos servicios son gratuitos. Nadie paga por usar Facebook.
Conocida es la frase &lt;a href="https://www.reddit.com/r/explainlikeimfive/comments/2m3f05/eli5_if_something_is_free_you_are_the_product/"&gt;&lt;em&gt;"If you are not paying, then &lt;strong&gt;you&lt;/strong&gt; are the product"&lt;/em&gt;&lt;/a&gt;,
que se traduce como &lt;em&gt;"Si tú no estás pagando por el producto, es porque tú eres el producto"&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;En lo personal creo que esta frase dice muchas cosas.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Primero, es que un algoritmo de recomendación tiene el poder para dirigir &lt;em&gt;inadvertidamente&lt;/em&gt; a ciertos productos.&lt;/li&gt;
&lt;li&gt;Un algoritmo de recomendación puede &lt;em&gt;manipular&lt;/em&gt; la realidad de manera &lt;a href="https://www.theguardian.com/technology/2014/jun/29/facebook-users-emotions-news-feeds"&gt;imperceptible&lt;/a&gt;. Las consecuencias son de tintes morales y bueno, no es el punto revisarlas aquí.&lt;/li&gt;
&lt;li&gt;Un algoritmo de recomendación puede en algunos casos -incluso no intencionalmente- &lt;a href="https://www.dw.com/en/spotify-how-a-swedish-startup-transformed-the-music-industry/a-43230609"&gt;atrofiar industrias creativas&lt;/a&gt;.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Pero no todo es malo. El filtrado colaborativo permite, entre otras cosas ayudar
 a usuarios a elegir un item (noticia, canción, película, libro) de un conjunto
 masivo de opciones.&lt;/p&gt;
&lt;p&gt;Finalmente, los sistemas de recomendación son una manifestación de
inteligencia colectiva, lo que es bueno: Más gente involucrada en algo es mejor. 
Lo importante es entender cómo funcionan estos modelos y así, eventualmente, poder crear modelos propios.&lt;/p&gt;
&lt;h1 id="definicion-formal-del-problema"&gt;Definición formal del problema&lt;/h1&gt;
&lt;p&gt;Siguiendo la formalización presentada en &lt;a href="http://citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.423.5258&amp;amp;rep=rep1&amp;amp;type=pdf"&gt;este paper&lt;/a&gt;,
para un conjunto de usuarios &lt;span class="math"&gt;\(U\)&lt;/span&gt; y un conjunto de items &lt;span class="math"&gt;\(I\)&lt;/span&gt;, se desea obtener un
 conjunto recomendado de items &lt;span class="math"&gt;\(R\)&lt;/span&gt;, tal que&lt;/p&gt;
&lt;div class="math"&gt;$$R: I \times U \rightarrow R_0$$&lt;/div&gt;
&lt;p&gt;Esta transformación &lt;span class="math"&gt;\(R\)&lt;/span&gt; o &lt;em&gt;función de utilidad&lt;/em&gt;, se define como la medida de
&lt;em&gt;precisión&lt;/em&gt; o &lt;em&gt;propiedad&lt;/em&gt; de recomendar el item &lt;span class="math"&gt;\(i \in I\)&lt;/span&gt; al usuario &lt;span class="math"&gt;\(u \in U\)&lt;/span&gt;,
 y &lt;span class="math"&gt;\(R_0\)&lt;/span&gt; se asume como subconjunto de &lt;span class="math"&gt;\(I \times U\)&lt;/span&gt; en el cual se conoce el valor de &lt;span class="math"&gt;\(R\)&lt;/span&gt;$.&lt;/p&gt;
&lt;p&gt;Es así entonces que se tiene, en el contexto de recomendación, la necesidad de&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;em&gt;Estimar o aproximar la función de utilidad &lt;span class="math"&gt;\(R(i,u)\)&lt;/span&gt; sobre aquellos items
     &lt;span class="math"&gt;\(i\)&lt;/span&gt; sobre los cuales &lt;span class="math"&gt;\(R\)&lt;/span&gt; no se conoce, y&lt;/em&gt;&lt;/li&gt;
&lt;li&gt;&lt;em&gt;Elegir el ítem o el conjunto de ítems tal que maximicen &lt;span class="math"&gt;\(R\)&lt;/span&gt; i.e.&lt;/em&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;div class="math"&gt;$$\forall u \in U, i = \mbox{argmax } R(i,u) \mbox{, }  i \in I$$&lt;/div&gt;
&lt;h1 id="metricas-de-prediccion"&gt;Métricas de predicción&lt;/h1&gt;
&lt;p&gt;Podemos cuantificar el error entre el valor esperado &lt;span class="math"&gt;\(\hat{r}\)&lt;/span&gt; y la predicción &lt;span class="math"&gt;\(r\)&lt;/span&gt;, de las cuales se destacan&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;RMSE, o &lt;em&gt;root mean square error&lt;/em&gt; como&lt;/li&gt;
&lt;/ol&gt;
&lt;div class="math"&gt;$$\sqrt{\frac{\sum_{i=1}^{n}\left(\hat{r}_{ui}-r_{ui}\right)^2}{n}}$$&lt;/div&gt;
&lt;ol&gt;
&lt;li&gt;MSE, o &lt;em&gt;Mean square error&lt;/em&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;div class="math"&gt;$$\frac{\sum_{i=1}^{n}\left(\hat{r}_{ui}-r_{ui}\right)^2}{n}$$&lt;/div&gt;
&lt;ol&gt;
&lt;li&gt;MAE, o &lt;em&gt;Mean absolute error&lt;/em&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;div class="math"&gt;$$\frac{\sum_{i=1}^{n}|\hat{r}_{ui}-r_{ui}|}{n}$$&lt;/div&gt;
&lt;p&gt;Estas métricas basadas en el error son de uso frecuente en distintas áreas como
 la estadística y &lt;em&gt;machine learning&lt;/em&gt;.&lt;/p&gt;
&lt;h1 id="conclusiones"&gt;Conclusiones&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;Los métodos de recomendación buscan lidiar con la sobrecarga de información,
y reducen el espacio de búsqueda en grupos muy grandes de ítems.&lt;/li&gt;
&lt;li&gt;Algunos tipos de recomendaciones van desde películas hasta inversiones en la bolsa.&lt;/li&gt;
&lt;li&gt;Una forma de evaluar un sistema recomendador es a través del error en las
  predicciones realizadas&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id="a-continuacion"&gt;A continuación&lt;/h1&gt;
&lt;p&gt;En la &lt;a href="https://diegoquintanav.github.io/recsys-2-ES.html"&gt;parte 2&lt;/a&gt; se verán otras cosas, entre ellas, &lt;strong&gt;tipos de clasificadores.&lt;/strong&gt;&lt;/p&gt;
&lt;script type="text/javascript"&gt;if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) {
    var align = "center",
        indent = "0em",
        linebreak = "false";

    if (false) {
        align = (screen.width &lt; 768) ? "left" : align;
        indent = (screen.width &lt; 768) ? "0em" : indent;
        linebreak = (screen.width &lt; 768) ? 'true' : linebreak;
    }

    var mathjaxscript = document.createElement('script');
    mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#';
    mathjaxscript.type = 'text/javascript';
    mathjaxscript.src = 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.3/latest.js?config=TeX-AMS-MML_HTMLorMML';
    mathjaxscript[(window.opera ? "innerHTML" : "text")] =
        "MathJax.Hub.Config({" +
        "    config: ['MMLorHTML.js']," +
        "    TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } }," +
        "    jax: ['input/TeX','input/MathML','output/HTML-CSS']," +
        "    extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']," +
        "    displayAlign: '"+ align +"'," +
        "    displayIndent: '"+ indent +"'," +
        "    showMathMenu: true," +
        "    messageStyle: 'normal'," +
        "    tex2jax: { " +
        "        inlineMath: [ ['\\\\(','\\\\)'] ], " +
        "        displayMath: [ ['$$','$$'] ]," +
        "        processEscapes: true," +
        "        preview: 'TeX'," +
        "    }, " +
        "    'HTML-CSS': { " +
        "        styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'inherit ! important'} }," +
        "        linebreaks: { automatic: "+ linebreak +", width: '90% container' }," +
        "    }, " +
        "}); " +
        "if ('default' !== 'default') {" +
            "MathJax.Hub.Register.StartupHook('HTML-CSS Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax['HTML-CSS'].FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
            "MathJax.Hub.Register.StartupHook('SVG Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax.SVG.FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
        "}";
    (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript);
}
&lt;/script&gt;</summary><category term="recsys"></category></entry><entry><title>On getting started with Jekyll</title><link href="https://diegoquintanav.github.io/on-jekyll-EN.html" rel="alternate"></link><published>2017-10-20T18:01:00-06:00</published><updated>2017-10-20T18:01:00-06:00</updated><author><name>Diego Quintana</name></author><id>tag:diegoquintanav.github.io,2017-10-20:on-jekyll-EN.html</id><summary type="html">&lt;!-- Summary:  --&gt;

&lt;!-- Modified: 2010-12-05 19:30 --&gt;

&lt;p&gt;I've decided to start a blog, (again, for the &lt;em&gt;nth&lt;/em&gt; time) and this time I am giving a try on &lt;a href="https://jekyllrb.com/"&gt;jekyll&lt;/a&gt; and the &lt;a href="https://pages.github.com"&gt;github pages&lt;/a&gt;, since they seem to do quite a fine job.&lt;/p&gt;
&lt;p&gt;Setting things up was easy. I'm not going to copy and paste the guides already present in both sites, since it won't add anything. Instead I will try to share a bit of the troubleshooting I had to do during the process.&lt;/p&gt;
&lt;h1 id="first-steps"&gt;First steps&lt;/h1&gt;
&lt;p&gt;Okay, it took me about nothing to have my site showing a humble &lt;em&gt;Hello World&lt;/em&gt; in my &lt;code&gt;index.html&lt;/code&gt; on my site.&lt;/p&gt;
&lt;h2 id="creating-your-personal-page"&gt;Creating your personal page&lt;/h2&gt;
&lt;p&gt;You can create a site for yourself or for some repo you own. I'm dealing with the first case for now: A site for myself.&lt;/p&gt;
&lt;p&gt;Long story short, what I did was:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Have a &lt;a href="https://github.com"&gt;Github&lt;/a&gt; account. &lt;em&gt;Duh&lt;/em&gt;. Then create a repo named &lt;em&gt;[&lt;strong&gt;your username&lt;/strong&gt;].github.io&lt;/em&gt;. In my case, my username is &lt;em&gt;diegoquintanav&lt;/em&gt;. You can change that later, it seems. Let's not care about that &lt;em&gt;for now&lt;/em&gt;.&lt;/li&gt;
&lt;li&gt;Add a file named &lt;code&gt;index.html&lt;/code&gt; in the root folder of the repo, and write &lt;em&gt;Hello World&lt;/em&gt; in it.&lt;/li&gt;
&lt;li&gt;???&lt;/li&gt;
&lt;li&gt;Profit! go to &lt;em&gt;[&lt;strong&gt;your username&lt;/strong&gt;].github.io&lt;/em&gt; and you should be able to see the words too.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;That was a piece of cake. Next thing you can do is to set up &lt;strong&gt;Jekyll&lt;/strong&gt;. This requires a bit more of work, but don't be scared.
Before doing anything, I believe it's a good thing to understand &lt;em&gt;why&lt;/em&gt; should you use &lt;strong&gt;Jekyll&lt;/strong&gt; and not just plain HTML or &lt;strong&gt;Wordpress&lt;/strong&gt; for this matter. Since this is a personal issue and a matter of preference, I can only share my experience and talk about my needs.&lt;/p&gt;
&lt;p&gt;I tried using Wordpress, which has a lot of resources to get up and running right out of the box. It is also free, which is nice. In my case, I wanted to have more control over the stuff I was writing, namely be able to deploy my stuff whenever I want and to be able to change stuff from the very core, so to speak. Plus, this should work as a first experience running a site. Github pages may be too &lt;em&gt;vanilla&lt;/em&gt; for the hardcore developer, but is a very balanced solution for enthusiasts like me.&lt;/p&gt;
&lt;p&gt;Now there are two ways it seems, to get started. The first one implies creating the folder structure manually, and this process is more or less explained in &lt;a href="http://jmcglone.com/guides/github-pages/"&gt;this fine post&lt;/a&gt; which is also referenced by the &lt;strong&gt;Jekyll&lt;/strong&gt; site.&lt;/p&gt;
&lt;p&gt;What I didn't like about the post, though, is that doing things manually usually imply forgetting about things. I prefer to stick with the solution using &lt;strong&gt;Bundle&lt;/strong&gt; and &lt;strong&gt;Jekyll&lt;/strong&gt; from the terminal, which is more or less described &lt;a href="https://jekyllrb.com/docs/installation/"&gt;here&lt;/a&gt; and &lt;a href="https://jekyllrb.com/docs/quickstart/"&gt;here&lt;/a&gt;.&lt;/p&gt;
&lt;h2 id="issues"&gt;Issues&lt;/h2&gt;
&lt;h3 id="new-posts-are-not-being-displayed"&gt;New posts are not being displayed&lt;/h3&gt;
&lt;p&gt;If you deployed &lt;strong&gt;Jekyll&lt;/strong&gt; correctly, it should use the &lt;code&gt;minima&lt;/code&gt; template by default. You should be able to add more posts inside the folder &lt;code&gt;_posts&lt;/code&gt; and see them instantly on your &lt;code&gt;localhost&lt;/code&gt;. That didn't happen in my case. A short way to debug this issue that solved my problem required the &lt;code&gt;--verbose&lt;/code&gt; flag when firing up the service.&lt;/p&gt;
&lt;p&gt;&lt;code&gt;bash
$ sudo bundle exec jekyll serve --verbose
  Logging at level: debug
Configuration file: /home/diego/Documents/diegoquintanav.github.io/_config.yml
  Logging at level: debug
         Requiring: jekyll-feed
         Requiring: kramdown
            Source: /path/to/diegoquintanav.github.io
       Destination: path/to/diegoquintanav.github.io/_site
 Incremental build: disabled. Enable with --incremental
      Generating...
       EntryFilter: excluded /Gemfile
       EntryFilter: excluded /Gemfile.lock
           Reading: _posts/2017-10-27-on-jekyll.md
           Reading: _posts/2017-10-26-welcome-to-jekyll.markdown
          Skipping: _posts/2017-10-27-on-jekyll.md has a future date
        Generating: JekyllFeed::Generator finished in 0.000744857 seconds.
...&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;In line &lt;code&gt;15&lt;/code&gt; you can observe the &lt;code&gt;Skipping: _posts/2017-10-27-on-jekyll.md has a future date&lt;/code&gt;. Changing the date solved the problem. About the &lt;code&gt;sudo&lt;/code&gt; thing, consider it a malpractice. The ruby environment manager &lt;a href="https://github.com/rbenv/rbenv"&gt;&lt;code&gt;rbenv&lt;/code&gt;&lt;/a&gt; fought bravely against the &lt;a href="https://anaconda.org/"&gt;Anaconda's&lt;/a&gt; &lt;code&gt;gcc&lt;/code&gt; dependencies and I just could not manage to have a ruby instance outside of &lt;code&gt;root&lt;/code&gt;. &lt;em&gt;Sorry&lt;/em&gt;.&lt;/p&gt;
&lt;p&gt;Other reasons may involve a bad filename formatting or the presence of colons &lt;code&gt;:&lt;/code&gt; in it. You can read more about this &lt;a href="https://stackoverflow.com/questions/30625044/jekyll-post-not-generated"&gt;here&lt;/a&gt;.&lt;/p&gt;
&lt;h3 id="using-latex-equations"&gt;Using Latex equations&lt;/h3&gt;
&lt;p&gt;This was not trivial for me. If you follow the &lt;a href="https://jekyllrb.com/docs/extras/"&gt;guidelines&lt;/a&gt; inside the documentation, you should end in the tutorial.&lt;/p&gt;
&lt;p&gt;It should be something easy. Copying and pasting the CDN in the &lt;code&gt;&amp;lt;head&amp;gt;&lt;/code&gt; of the document. &lt;em&gt;But where is this file?&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;This was not obvious to me.&lt;/p&gt;
&lt;p&gt;After some &lt;em&gt;google-fu&lt;/em&gt;, nothing was explicit enough to me. &lt;a href="https://github.com/mmistakes/minimal-mistakes/issues/735"&gt;This post&lt;/a&gt; helped a bit, but after realizing that the docs were not good enough, I ended up in &lt;code&gt;#jekyll&lt;/code&gt; on &lt;a href="https://freenode.net/"&gt;freenode&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;With a bit of help of some nice anons, I found out that&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;Themes are either &lt;em&gt;Gem-installed&lt;/em&gt; or locally installed. By default after deploying Jekyll, you should be using &lt;code&gt;Minima&lt;/code&gt; as a &lt;em&gt;Gem Theme&lt;/em&gt;. This means basically that the files that compose your theme live somewhere else. Run &lt;code&gt;bundle show minima&lt;/code&gt;, which  displays the path of the theme. Somewhere inside &lt;code&gt;var&lt;/code&gt; if you are using Ubuntu. If you &lt;code&gt;cd&lt;/code&gt; into that folder you should see some folders, namely &lt;code&gt;_layouts&lt;/code&gt;, which are the templates of the theme and &lt;code&gt;_includes&lt;/code&gt; which I'm not sure yet. Every theme has more or less the same folders with the &lt;em&gt;exact&lt;/em&gt; names, but the way pages are composed by means of templates should differ. Expect that.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Inside the &lt;code&gt;_layouts&lt;/code&gt; folder you should find &lt;code&gt;head.html&lt;/code&gt;. Copy that file inside your own project, in a folder called &lt;code&gt;_layouts&lt;/code&gt; if you don't have it yet. By doing this you are basically overriding the base files inside the &lt;em&gt;Gem theme&lt;/em&gt; with your own.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Now you can edit it. Copy the script node from the extras site on Jekyll and there you go. You should be able to render&lt;span class="math"&gt;\( \LaTeX\)&lt;/span&gt; equations easily.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Please beware that in comparison to the traditional way, &lt;em&gt;inline equations&lt;/em&gt; and almost every equation is rendered using doble dollar signs i.e.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;code&gt;latex
$$\text{A } \LaTeX \text{ equation.}$$&lt;/code&gt;&lt;/p&gt;
&lt;div class="math"&gt;$$\text{A } \LaTeX \text{ equation.}$$&lt;/div&gt;
&lt;p&gt;Other implementation details depend on the Markdown compiler being used, in my case (and odds that yours too if you are starting with jekyll) I'm using &lt;a href="https://kramdown.gettalong.org/syntax.html#math-blocks"&gt;kramdown&lt;/a&gt; which is set by default.&lt;/p&gt;
&lt;h1 id="next-steps"&gt;Next Steps&lt;/h1&gt;
&lt;p&gt;I think there are a lot of other things to play around, which I will document and comment in the future posts. Not yet. This is my &lt;em&gt;MVP&lt;/em&gt; for now. Next iteration should include:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Comments section. Might prove useful somewhere.&lt;/li&gt;
&lt;li&gt;Add more sections, editing the &lt;code&gt;navbar&lt;/code&gt; or something equivalent. Add more endpoints.&lt;/li&gt;
&lt;li&gt;Change the site's domain.&lt;/li&gt;
&lt;li&gt;Add some google analytics sorcery or equivalent.&lt;/li&gt;
&lt;li&gt;Theme editing and/or theme changing&lt;/li&gt;
&lt;li&gt;Add embedded python REPL instances. I saw them somewhere on the internet. I want them.&lt;/li&gt;
&lt;/ul&gt;
&lt;script type="text/javascript"&gt;if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) {
    var align = "center",
        indent = "0em",
        linebreak = "false";

    if (false) {
        align = (screen.width &lt; 768) ? "left" : align;
        indent = (screen.width &lt; 768) ? "0em" : indent;
        linebreak = (screen.width &lt; 768) ? 'true' : linebreak;
    }

    var mathjaxscript = document.createElement('script');
    mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#';
    mathjaxscript.type = 'text/javascript';
    mathjaxscript.src = 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.3/latest.js?config=TeX-AMS-MML_HTMLorMML';
    mathjaxscript[(window.opera ? "innerHTML" : "text")] =
        "MathJax.Hub.Config({" +
        "    config: ['MMLorHTML.js']," +
        "    TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } }," +
        "    jax: ['input/TeX','input/MathML','output/HTML-CSS']," +
        "    extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']," +
        "    displayAlign: '"+ align +"'," +
        "    displayIndent: '"+ indent +"'," +
        "    showMathMenu: true," +
        "    messageStyle: 'normal'," +
        "    tex2jax: { " +
        "        inlineMath: [ ['\\\\(','\\\\)'] ], " +
        "        displayMath: [ ['$$','$$'] ]," +
        "        processEscapes: true," +
        "        preview: 'TeX'," +
        "    }, " +
        "    'HTML-CSS': { " +
        "        styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'inherit ! important'} }," +
        "        linebreaks: { automatic: "+ linebreak +", width: '90% container' }," +
        "    }, " +
        "}); " +
        "if ('default' !== 'default') {" +
            "MathJax.Hub.Register.StartupHook('HTML-CSS Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax['HTML-CSS'].FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
            "MathJax.Hub.Register.StartupHook('SVG Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax.SVG.FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
        "}";
    (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript);
}
&lt;/script&gt;</summary><category term="jekyll"></category><category term="gh-sites"></category><category term="tutorial"></category></entry></feed>